{"id":"scribe-1","title":"Daily Note Navigation Epic","description":"# Daily Note Navigation\n\nEnhance the note header date display with navigation controls that allow users to quickly move between daily notes. This is a cornerstone UX improvement that makes Scribe's daily journaling workflow feel as natural as flipping through a physical calendar.\n\n## Strategic Value\n\n- **Reduces friction**: Currently navigating daily notes requires command palette → search → select. This adds chevron-click and calendar-pick alternatives.\n- **Supports chronological review**: Users reviewing project timelines or past decisions can flip through days naturally.\n- **Progressive disclosure**: Clean default UI with power features revealed on hover.\n\n## Scope\n\n- Update `getDailyDisplayTitle` to show Yesterday/Tomorrow/ordinal dates\n- Create `DateNavigator` component with chevrons and Calendar popover\n- Integrate into NoteHeader with proper accessibility\n- Add comprehensive tests at unit, component, and E2E levels\n\n## Dependencies\n\n- Existing `Calendar` component from design-system\n- Existing `daily:getOrCreate` IPC handler\n- date-fns for date manipulation\n\n## Files Affected\n\n- `renderer/src/templates/daily.ts`\n- `renderer/src/components/NoteHeader/*`\n- `renderer/src/App.tsx`\n- New test files\n\n## Success Criteria\n\n1. User can click chevrons to navigate prev/next daily notes\n2. User can click date to open calendar and jump to any date\n3. Title shows \"Today\", \"Yesterday\", \"Tomorrow\", or formatted date\n4. Keyboard navigation works fully\n5. Screen readers announce navigation correctly\n6. All tests pass","status":"open","priority":1,"issue_type":"epic","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z"}
{"id":"scribe-10","title":"Update App.tsx for error handling and prop rename","description":"# Update App.tsx Integration\n\n## Context\n\nApp.tsx needs updates to:\n1. Rename prop from `onDateClick` to `onNavigateToDaily`\n2. Add try/catch with toast for error handling\n\n## Current Implementation (lines 172-178)\n\n```typescript\nconst handleDateClick = useCallback(\n  async (date: Date) =\u003e {\n    const note = await window.scribe.daily.getOrCreate(date);\n    navigateToNote(note.id);\n  },\n  [navigateToNote]\n);\n```\n\n## Updated Implementation\n\n```typescript\nconst handleNavigateToDaily = useCallback(\n  async (date: Date) =\u003e {\n    try {\n      // Note: The preload layer handles converting Date to ISO string internally\n      const dailyNote = await window.scribe.daily.getOrCreate(date);\n      navigateToNote(dailyNote.id);\n    } catch (error) {\n      showToast('Failed to open daily note', 'error');\n      console.error('Failed to navigate to daily note:', error);\n    }\n  },\n  [navigateToNote, showToast]\n);\n```\n\n## Changes Required\n\n### 1. Rename Handler\nChange `handleDateClick` to `handleNavigateToDaily` for consistency.\n\n### 2. Add Error Handling\nWrap the IPC call in try/catch with toast notification.\n\n### 3. Update NoteHeader Usage\n```typescript\n\u003cNoteHeader\n  note={noteState.currentNote}\n  onTitleChange={(title: string) =\u003e noteState.updateMetadata({ title })}\n  onTagsChange={(tags: string[]) =\u003e noteState.updateMetadata({ tags })}\n  onNavigateToDaily={handleNavigateToDaily}  // Changed from onDateClick\n  translateY={translateY}\n/\u003e\n```\n\n## IPC Type Contract (Verified)\n\nThe preload implementation (`apps/desktop/electron/preload/src/preload.ts:59-64`) accepts `Date` and converts internally:\n```typescript\ngetOrCreate: (date?: Date) =\u003e\n  ipcRenderer.invoke(\n    IPC_CHANNELS.DAILY_GET_OR_CREATE,\n    date ? { date: date.toISOString() } : undefined\n  ),\n```\n\nSo the call in App.tsx should use `Date` directly (not `{ date: string }`).\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/App.tsx`\n\n## Acceptance Criteria\n\n- [ ] Handler renamed to handleNavigateToDaily\n- [ ] Error handling with toast notification\n- [ ] Correct parameter format (Date object)\n- [ ] TypeScript compilation passes\n- [ ] showToast in dependency array\n- [ ] NoteHeader receives renamed prop\n\n## Dependencies\n\n- Depends on scribe-8 (NoteHeader must have the renamed prop)","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:46:00.469557-06:00","dependencies":[{"issue_id":"scribe-10","depends_on_id":"scribe-8","type":"blocks","created_at":"2025-12-21T21:28:17.819549-06:00","created_by":"daemon"},{"issue_id":"scribe-10","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.866624-06:00","created_by":"daemon"}]}
{"id":"scribe-11","title":"Create E2E integration tests for daily navigation","description":"# E2E Integration Tests\n\n## Context\n\nEnd-to-end tests validate the full daily note navigation flow in an actual Electron environment.\n\n## Test File\n\n`apps/desktop/daily-navigation.integration.test.ts`\n\n## Test Framework\n\n- Vitest for test runner\n- Electron testing utilities (check existing integration tests for patterns)\n\n## Test Flows\n\n### Flow 1: Navigate with Chevrons\n\n```typescript\nit('navigates between daily notes using chevrons', async () =\u003e {\n  // 1. Open today's daily note\n  await app.daily.getOrCreate();\n  \n  // 2. Verify title shows \"Today\"\n  await expect(page.locator('[data-testid=\"note-title\"]')).toHaveValue('Today');\n  \n  // 3. Hover over date area\n  await page.locator('[data-testid=\"date-navigator\"]').hover();\n  \n  // 4. Click left chevron\n  await page.locator('[aria-label=\"Navigate to previous day\"]').click();\n  \n  // 5. Verify title shows \"Yesterday\"\n  await expect(page.locator('[data-testid=\"note-title\"]')).toHaveValue('Yesterday');\n  \n  // 6. Click left again\n  await page.locator('[aria-label=\"Navigate to previous day\"]').click();\n  \n  // 7. Verify title shows formatted date\n  await expect(page.locator('[data-testid=\"note-title\"]')).toHaveValue(/Dec \\d+(?:st|nd|rd|th), 2024/);\n});\n```\n\n### Flow 2: Calendar Picker Navigation\n\n```typescript\nit('navigates using calendar picker', async () =\u003e {\n  // 1. Open today's daily note\n  await app.daily.getOrCreate();\n  \n  // 2. Click date to open calendar\n  await page.locator('[data-testid=\"date-button\"]').click();\n  \n  // 3. Verify calendar visible\n  await expect(page.locator('[data-testid=\"calendar\"]')).toBeVisible();\n  \n  // 4. Select date from 2 weeks ago\n  // ... navigate calendar and select\n  \n  // 5. Verify new note opens\n  // ... check title matches selected date\n});\n```\n\n### Flow 3: Note Creation via Navigation\n\n```typescript\nit('creates notes when navigating to dates without notes', async () =\u003e {\n  // 1. Open today's note\n  // 2. Navigate forward 3 days\n  // 3. Verify each note exists in storage\n  // 4. Navigate back - same notes, no duplicates\n});\n```\n\n### Flow 4: Keyboard Navigation\n\n```typescript\nit('supports keyboard navigation', async () =\u003e {\n  // 1. Focus date button\n  // 2. Press ArrowLeft - previous day\n  // 3. Press ArrowRight - next day\n  // 4. Press Enter - calendar opens\n  // 5. Navigate calendar with arrows\n  // 6. Press Enter - select date\n  // 7. Verify focus returns to date button\n});\n```\n\n### Flow 5: Error Handling\n\n```typescript\nit('shows error toast on navigation failure', async () =\u003e {\n  // 1. Mock storage failure\n  // 2. Click chevron\n  // 3. Verify toast appears\n  // 4. Verify current note unchanged\n});\n```\n\n## Test Data Setup\n\nEach test should:\n1. Use a temporary vault directory\n2. Clear any existing daily notes\n3. Create a known starting state\n\n## Files to Create\n\n- `apps/desktop/daily-navigation.integration.test.ts`\n\n## Dependencies\n\n- Check existing integration tests for patterns\n- May need test utilities for Electron interaction\n\n## Acceptance Criteria\n\n- [ ] All 5 test flows implemented\n- [ ] Tests run in CI\n- [ ] No flaky tests\n- [ ] Proper cleanup between tests\n- [ ] Error scenarios covered","status":"open","priority":3,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z","dependencies":[{"issue_id":"scribe-11","depends_on_id":"scribe-10","type":"blocks","created_at":"2025-12-21T21:28:17.864563-06:00","created_by":"daemon"},{"issue_id":"scribe-11","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.911303-06:00","created_by":"daemon"},{"issue_id":"scribe-11","depends_on_id":"scribe-7","type":"blocks","created_at":"2025-12-21T21:36:21.373279-06:00","created_by":"daemon"}]}
{"id":"scribe-12","title":"Add aria-live region for navigation announcements","description":"# Accessibility: Live Region Announcements\n\n## Context\n\nWhen users navigate between daily notes using chevrons or keyboard, screen readers should announce the new note's title.\n\n## Current State\n\n- Toast notifications already use `role=\"alert\"` with `aria-live=\"assertive\"`\n- No specific announcement for navigation success\n\n## Requirements\n\n### Navigation Announcement\n\nWhen navigation completes successfully:\n- Announce the new note's display title\n- Use `aria-live=\"polite\"` (not assertive, to avoid interrupting)\n\n### Implementation Options\n\n#### Option A: Announce via existing Toast system\n\nUse a non-visual \"info\" toast:\n```typescript\nshowToast(`Navigated to ${displayTitle}`, 'info', { visualOnly: false });\n```\n\nThis may require extending the Toast component.\n\n#### Option B: Dedicated live region in DateNavigator\n\n```typescript\n\u003cdiv\n  role=\"status\"\n  aria-live=\"polite\"\n  aria-atomic=\"true\"\n  className={styles.srOnly}\n\u003e\n  {announcementText}\n\u003c/div\u003e\n```\n\n#### Option C: Page-level live region\n\nAdd a hidden live region to App.tsx that can be updated from anywhere.\n\n## Recommended Approach\n\nOption B is self-contained within DateNavigator:\n\n```typescript\nconst [announcement, setAnnouncement] = useState('');\n\n// After navigation completes:\nuseEffect(() =\u003e {\n  // When date prop changes, announce new date\n  const title = getDailyDisplayTitle(createDailyNote(date));\n  setAnnouncement(`Navigated to ${title}`);\n  \n  // Clear after announcement\n  const timer = setTimeout(() =\u003e setAnnouncement(''), 1000);\n  return () =\u003e clearTimeout(timer);\n}, [date]);\n```\n\n## srOnly Style\n\n```typescript\nexport const srOnly = style({\n  position: 'absolute',\n  width: '1px',\n  height: '1px',\n  padding: 0,\n  margin: '-1px',\n  overflow: 'hidden',\n  clip: 'rect(0, 0, 0, 0)',\n  whiteSpace: 'nowrap',\n  border: 0,\n});\n```\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.tsx`\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.css.ts`\n\n## Testing\n\n- Use screen reader (VoiceOver, NVDA) to verify announcements\n- Verify announcement doesn't interrupt other content\n\n## Acceptance Criteria\n\n- [ ] Navigation announces new note title\n- [ ] Uses aria-live=\"polite\"\n- [ ] Visually hidden but screen reader accessible\n- [ ] Announcement clears after being read","status":"closed","priority":3,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:34:54.958848-06:00","closed_at":"2025-12-21T21:34:54.958848-06:00","dependencies":[{"issue_id":"scribe-12","depends_on_id":"scribe-8","type":"blocks","created_at":"2025-12-21T21:28:17.91009-06:00","created_by":"daemon"},{"issue_id":"scribe-12","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.95697-06:00","created_by":"daemon"}]}
{"id":"scribe-13","title":"Verify and update IPC preload type definitions","description":"# Verify IPC Type Definitions\n\n## Context\n\nThe renderer accesses `window.scribe.daily.getOrCreate()`. Need to verify the preload types are correct for the date parameter.\n\n## Current Usage in App.tsx\n\n```typescript\nconst note = await window.scribe.daily.getOrCreate(date);\n```\n\nBut the handler expects:\n```typescript\nipcMain.handle('daily:getOrCreate', async (_, options?: { date?: string }) =\u003e {\n```\n\n## Issue\n\nThe current call passes a `Date` object directly, but the handler expects `{ date?: string }`.\n\n## Required Fix in App.tsx\n\n```typescript\nconst dailyNote = await window.scribe.daily.getOrCreate({ \n  date: date.toISOString() \n});\n```\n\n## Files to Check\n\n1. `apps/desktop/electron/preload/src/api.ts` - Verify preload API definition\n2. `apps/desktop/electron/preload/src/types.ts` - Verify type definitions\n3. `apps/desktop/renderer/src/App.tsx` - Update call site\n\n## Expected Preload Type\n\n```typescript\ninterface ScribeAPI {\n  daily: {\n    getOrCreate: (options?: { date?: string }) =\u003e Promise\u003cNote\u003e;\n    find: (options: { date: string }) =\u003e Promise\u003cNote | null\u003e;\n  };\n  // ...\n}\n```\n\n## Testing\n\n- Verify TypeScript compilation passes\n- Verify runtime behavior matches expected\n\n## Acceptance Criteria\n\n- [ ] Preload types match handler contract\n- [ ] App.tsx uses correct parameter format\n- [ ] TypeScript compilation passes\n- [ ] Runtime works correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:34:56.162149-06:00","closed_at":"2025-12-21T21:34:56.162149-06:00","dependencies":[{"issue_id":"scribe-13","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.001152-06:00","created_by":"daemon"}]}
{"id":"scribe-14","title":"Add data-testid attributes for E2E test selectors","description":"# Add Test Selectors\n\n## Context\n\nE2E tests need reliable selectors. Add `data-testid` attributes to key elements.\n\n## Required Selectors\n\n### DateNavigator\n\n| Element | data-testid |\n|---------|-------------|\n| Container | `date-navigator` |\n| Left chevron | `date-nav-prev` |\n| Date button | `date-nav-button` |\n| Right chevron | `date-nav-next` |\n| Calendar popover | `date-nav-calendar` |\n\n### NoteHeader\n\n| Element | data-testid |\n|---------|-------------|\n| Title input | `note-title` |\n| Metadata row | `note-metadata` |\n\n## Implementation\n\n```typescript\n// DateNavigator.tsx\n\u003cdiv\n  className={styles.dateNavigator}\n  data-testid=\"date-navigator\"\n  // ...\n\u003e\n  \u003cbutton\n    data-testid=\"date-nav-prev\"\n    // ...\n  \u003e\n  \u003cbutton\n    data-testid=\"date-nav-button\"\n    // ...\n  \u003e\n  \u003cbutton\n    data-testid=\"date-nav-next\"\n    // ...\n  \u003e\n  {isCalendarOpen \u0026\u0026 (\n    \u003cdiv data-testid=\"date-nav-calendar\"\u003e\n      \u003cCalendar ... /\u003e\n    \u003c/div\u003e\n  )}\n\u003c/div\u003e\n```\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.tsx`\n- `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.tsx`\n\n## Acceptance Criteria\n\n- [ ] All key elements have data-testid\n- [ ] Test IDs are unique and descriptive\n- [ ] E2E tests can select elements reliably","status":"closed","priority":3,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:34:57.575348-06:00","closed_at":"2025-12-21T21:34:57.575348-06:00","dependencies":[{"issue_id":"scribe-14","depends_on_id":"scribe-4","type":"blocks","created_at":"2025-12-21T21:28:17.955712-06:00","created_by":"daemon"},{"issue_id":"scribe-14","depends_on_id":"scribe-8","type":"blocks","created_at":"2025-12-21T21:28:18.001942-06:00","created_by":"daemon"},{"issue_id":"scribe-14","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.046129-06:00","created_by":"daemon"}]}
{"id":"scribe-15","title":"Document DateNavigator component in storybook or README","description":"# Document DateNavigator Component\n\n## Context\n\nNew components should be documented for future developers.\n\n## Options\n\n### Option A: Storybook (if project uses it)\n\nCreate `DateNavigator.stories.tsx` with:\n- Default state\n- Hovered state\n- Calendar open state\n- Without navigation (non-daily)\n\n### Option B: README in component folder\n\nCreate `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.md`:\n\n```markdown\n# DateNavigator\n\nA date display component with optional navigation controls for daily notes.\n\n## Usage\n\n```tsx\nimport { DateNavigator } from './DateNavigator';\n\n// For daily notes (with navigation)\n\u003cDateNavigator\n  date={new Date()}\n  onNavigate={handleNavigate}\n  showNavigation={true}\n/\u003e\n\n// For other notes (no navigation)\n\u003cDateNavigator\n  date={note.createdAt}\n  onNavigate={handleNavigate}\n  showNavigation={false}\n/\u003e\n```\n\n## Props\n\n| Prop | Type | Default | Description |\n|------|------|---------|-------------|\n| date | Date | required | The date to display |\n| onNavigate | (date: Date) =\u003e void | required | Called when navigating |\n| showNavigation | boolean | true | Show chevrons and calendar |\n\n## Behavior\n\n- Chevrons visible on hover\n- Left/right chevrons navigate prev/next day\n- Date click opens calendar popover\n- Keyboard: arrows navigate, Enter/Space opens calendar\n```\n\n## Acceptance Criteria\n\n- [ ] Component documented\n- [ ] Usage examples provided\n- [ ] Props documented\n- [ ] Behavior explained","status":"closed","priority":3,"issue_type":"chore","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:34:58.792874-06:00","closed_at":"2025-12-21T21:34:58.792874-06:00","dependencies":[{"issue_id":"scribe-15","depends_on_id":"scribe-8","type":"blocks","created_at":"2025-12-21T21:28:18.04852-06:00","created_by":"daemon"},{"issue_id":"scribe-15","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.09057-06:00","created_by":"daemon"}]}
{"id":"scribe-16","title":"Performance: Memoize date formatting in DateNavigator","description":"# Performance Optimization\n\n## Context\n\nDate formatting with `date-fns` is relatively cheap, but memoization can prevent unnecessary recalculations during re-renders.\n\n## Current Code\n\n```typescript\nconst formattedDate = format(date, 'MMM do, yyyy');\n```\n\nThis runs on every render.\n\n## Optimized Code\n\n```typescript\nconst formattedDate = useMemo(\n  () =\u003e format(date, 'MMM do, yyyy'),\n  [date]\n);\n```\n\n## Other Memoization Opportunities\n\n### Callback Memoization\n\nAlready using `useCallback` for handlers - good.\n\n### Component Memoization\n\nIf parent re-renders frequently, consider:\n\n```typescript\nexport const DateNavigator = memo(function DateNavigator({ ... }) {\n  // ...\n});\n```\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.tsx`\n\n## Acceptance Criteria\n\n- [ ] Date formatting memoized\n- [ ] Consider component-level memo\n- [ ] No unnecessary re-renders\n- [ ] Profile to verify improvement","status":"closed","priority":3,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:35:00.206623-06:00","closed_at":"2025-12-21T21:35:00.206623-06:00","dependencies":[{"issue_id":"scribe-16","depends_on_id":"scribe-4","type":"blocks","created_at":"2025-12-21T21:28:18.094703-06:00","created_by":"daemon"},{"issue_id":"scribe-16","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.135137-06:00","created_by":"daemon"}]}
{"id":"scribe-17","title":"Handle timezone edge cases for Today/Yesterday/Tomorrow","description":"# Timezone Edge Cases\n\n## Context\n\nThe spec mentions: \"Today/Yesterday/Tomorrow use user's local timezone (date-fns default)\"\n\nThis is generally fine, but there are edge cases around midnight.\n\n## Edge Cases\n\n### 1. Midnight Transition\n\nIf user has today's note open at 11:59 PM and the clock ticks to 12:00 AM:\n- The note is now \"Yesterday\" but title still shows \"Today\"\n- Expected behavior: Title updates on next navigation or note switch\n\n### 2. Cross-Timezone Travel\n\nIf user creates note in NYC (EST) and opens it in LA (PST):\n- date-fns uses local timezone for comparison\n- Note created at 11 PM EST = 8 PM PST = same day\n- Note created at 1 AM EST = 10 PM PST previous day = different day!\n\n### 3. Daily Note Date Storage\n\nDaily notes store date as `MM-dd-yyyy` string in the title.\n- No timezone info preserved\n- Parsed as local midnight on that date\n\n## Current Behavior (Acceptable)\n\n- `isToday`, `isYesterday`, `isTomorrow` from date-fns compare against local midnight\n- This matches user expectation for a personal note-taking app\n\n## Potential Improvements (Future)\n\n1. Store timezone with daily note creation\n2. Compare in original timezone\n3. Show timezone indicator if different\n\n## For This Task\n\nDocument the behavior and add a test case:\n\n```typescript\nit('uses local timezone for Today/Yesterday/Tomorrow comparisons', () =\u003e {\n  // Create note at 11:59 PM local time\n  // Verify it's still \"Today\" even though midnight is 1 minute away\n  // Note: We don't auto-update title at midnight\n});\n```\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/templates/daily.test.ts` (add test case)\n- Consider adding a comment in `daily.ts` about timezone behavior\n\n## Acceptance Criteria\n\n- [ ] Timezone behavior documented in code comments\n- [ ] Test case for timezone edge case\n- [ ] No changes to actual logic (current behavior is acceptable)","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z","dependencies":[{"issue_id":"scribe-17","depends_on_id":"scribe-2","type":"blocks","created_at":"2025-12-21T21:28:18.141183-06:00","created_by":"daemon"},{"issue_id":"scribe-17","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.180111-06:00","created_by":"daemon"}]}
{"id":"scribe-18","title":"Cleanup: Remove deprecated dateButton style from NoteHeader.css.ts","description":"# Cleanup Deprecated Styles\n\n## Context\n\nAfter DateNavigator is integrated, the `dateButton` style in NoteHeader.css.ts is no longer used. It should be removed to keep the codebase clean.\n\n## Current Location\n\n`apps/desktop/renderer/src/components/NoteHeader/NoteHeader.css.ts` lines 80-102:\n\n```typescript\nexport const dateButton = style({\n  // ... styles\n});\n```\n\n## Action\n\n1. Verify dateButton is not used anywhere else (search codebase)\n2. Remove the style definition\n3. Verify build still passes\n\n## Verification Command\n\n```bash\ngrep -r \"dateButton\" --include=\"*.ts\" --include=\"*.tsx\" apps/desktop/renderer/src/\n```\n\nShould only find:\n- The definition in NoteHeader.css.ts\n- The import/usage that should be removed\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.css.ts`\n\n## Acceptance Criteria\n\n- [ ] Verify style not used elsewhere\n- [ ] Remove dateButton style\n- [ ] Build passes\n- [ ] No TypeScript errors","status":"closed","priority":3,"issue_type":"chore","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:35:01.275263-06:00","closed_at":"2025-12-21T21:35:01.275263-06:00","dependencies":[{"issue_id":"scribe-18","depends_on_id":"scribe-8","type":"blocks","created_at":"2025-12-21T21:28:18.185982-06:00","created_by":"daemon"},{"issue_id":"scribe-18","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.225638-06:00","created_by":"daemon"}]}
{"id":"scribe-19","title":"Manual QA: Test daily navigation on different screen sizes","description":"# Manual QA Testing\n\n## Context\n\nBefore release, manually test the feature on different screen sizes and devices.\n\n## Test Matrix\n\n### Screen Sizes\n\n| Size | Resolution | Priority |\n|------|------------|----------|\n| Desktop large | 1920x1080 | High |\n| Desktop medium | 1440x900 | High |\n| Laptop | 1280x800 | High |\n| Small laptop | 1024x768 | Medium |\n\n### Test Cases\n\n1. **Hover reveals chevrons**\n   - Chevrons fade in smoothly\n   - Chevrons fade out on mouse leave\n\n2. **Chevron navigation**\n   - Click left → previous day\n   - Click right → next day\n   - Title updates correctly\n\n3. **Calendar popover**\n   - Opens on date click\n   - Positioned correctly (not cut off)\n   - Closes on selection\n   - Closes on Escape\n   - Closes on outside click\n\n4. **Keyboard navigation**\n   - Tab reaches date button\n   - Arrow keys navigate days\n   - Enter opens calendar\n   - Escape closes calendar\n   - Focus returns correctly\n\n5. **Title display**\n   - \"Today\" for today\n   - \"Yesterday\" for yesterday\n   - \"Tomorrow\" for tomorrow\n   - Ordinal format for other dates\n\n6. **Error handling**\n   - Toast appears on error\n   - Toast dismisses automatically\n\n### Screen Reader Testing\n\n1. VoiceOver (macOS)\n   - Chevron labels announced\n   - Date button label announced\n   - Calendar dialog announced\n\n2. NVDA (Windows, if available)\n   - Same checks as VoiceOver\n\n## Bug Report Template\n\n```\n**Environment:**\n- OS: \n- Screen size: \n- Screen reader (if applicable):\n\n**Steps to reproduce:**\n1. \n2. \n3. \n\n**Expected behavior:**\n\n**Actual behavior:**\n\n**Screenshots/recordings:**\n```\n\n## Acceptance Criteria\n\n- [ ] All test cases pass on desktop large\n- [ ] All test cases pass on laptop\n- [ ] Screen reader testing complete\n- [ ] Any bugs filed as separate issues","status":"closed","priority":3,"issue_type":"chore","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:35:02.446923-06:00","closed_at":"2025-12-21T21:35:02.446923-06:00","dependencies":[{"issue_id":"scribe-19","depends_on_id":"scribe-11","type":"blocks","created_at":"2025-12-21T21:28:18.230802-06:00","created_by":"daemon"},{"issue_id":"scribe-19","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.270716-06:00","created_by":"daemon"}]}
{"id":"scribe-2","title":"Update getDailyDisplayTitle for Yesterday/Tomorrow/ordinal format","description":"# Update Daily Title Display Logic\n\n## Context\n\nThe current `getDailyDisplayTitle` function in `templates/daily.ts` only handles two cases:\n- \"Today\" for the current date\n- `MM/dd/yyyy` format for all other dates\n\nThis is inadequate for good UX. Users expect:\n- \"Yesterday\" when viewing yesterday's note\n- \"Tomorrow\" when viewing tomorrow's note  \n- Human-friendly ordinal dates like \"Dec 19th, 2024\" for other dates\n\n## Current Implementation (line 49-63)\n\n```typescript\nexport function getDailyDisplayTitle(note: Note): string {\n  const noteDate = parse(note.title, 'MM-dd-yyyy', new Date());\n  if (!isValid(noteDate)) {\n    return note.title;\n  }\n  const today = startOfDay(new Date());\n  if (isSameDay(noteDate, today)) {\n    return 'Today';\n  }\n  return format(noteDate, 'MM/dd/yyyy');\n}\n```\n\n## Required Changes\n\n1. Import `isYesterday` and `isTomorrow` from date-fns\n2. Add Yesterday check after Today\n3. Add Tomorrow check after Yesterday\n4. Change fallback format from `MM/dd/yyyy` to `MMM do, yyyy`\n\n## New Implementation\n\n```typescript\nimport { format, isToday, isYesterday, isTomorrow, parse, isValid } from 'date-fns';\n\nexport function getDailyDisplayTitle(note: Note): string {\n  const noteDate = parse(note.title, 'MM-dd-yyyy', new Date());\n\n  if (!isValid(noteDate)) {\n    return note.title;\n  }\n\n  if (isToday(noteDate)) {\n    return 'Today';\n  }\n  if (isYesterday(noteDate)) {\n    return 'Yesterday';\n  }\n  if (isTomorrow(noteDate)) {\n    return 'Tomorrow';\n  }\n  return format(noteDate, 'MMM do, yyyy');\n}\n```\n\n## Ordinal Format Notes\n\nThe `do` format token in date-fns automatically handles ordinal suffixes:\n- 1st, 2nd, 3rd, 4th...\n- 11th, 12th, 13th (exceptions)\n- 21st, 22nd, 23rd, 24th...\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/templates/daily.ts`\n\n## Acceptance Criteria\n\n- [ ] `isYesterday` and `isTomorrow` imported from date-fns\n- [ ] \"Yesterday\" returned for yesterday's date\n- [ ] \"Tomorrow\" returned for tomorrow's date\n- [ ] Ordinal format (MMM do, yyyy) used for other dates\n- [ ] No breaking changes to existing Today logic\n- [ ] Invalid dates still return original title","status":"open","priority":1,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z","dependencies":[{"issue_id":"scribe-2","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.50739-06:00","created_by":"daemon"}]}
{"id":"scribe-20","title":"Update feature spec status to Complete after all tasks done","description":"# Update Feature Spec Status\n\n## Context\n\nOnce all tasks are complete and the feature is shipped, update the spec status from \"Draft\" to \"Complete\".\n\n## Changes\n\nIn `features/daily-note/spec.md`, change:\n\n```markdown\n**Status**: Draft\n```\n\nTo:\n\n```markdown\n**Status**: Complete\n**Completed**: YYYY-MM-DD\n```\n\n## Additional Updates\n\n1. Add a \"## Implementation Notes\" section with any deviations from spec\n2. Add a \"## Lessons Learned\" section if applicable\n3. Update any outdated information discovered during implementation\n\n## Files to Modify\n\n- `features/daily-note/spec.md`\n\n## Acceptance Criteria\n\n- [ ] Status updated to Complete\n- [ ] Completion date added\n- [ ] Any implementation deviations documented\n- [ ] Spec reflects final implementation","status":"closed","priority":3,"issue_type":"chore","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:35:03.19638-06:00","closed_at":"2025-12-21T21:35:03.19638-06:00","dependencies":[{"issue_id":"scribe-20","depends_on_id":"scribe-19","type":"blocks","created_at":"2025-12-21T21:28:18.274634-06:00","created_by":"daemon"},{"issue_id":"scribe-20","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:25.316312-06:00","created_by":"daemon"}]}
{"id":"scribe-3","title":"Add unit tests for getDailyDisplayTitle Yesterday/Tomorrow/ordinal","description":"# Add Template Unit Tests\n\n## Context\n\nAfter updating `getDailyDisplayTitle` in scribe-2, we need comprehensive unit tests to verify all title display scenarios.\n\n**IMPORTANT**: This task UPDATES existing tests in `daily.test.ts`. The current tests expect the OLD behavior (e.g., `MM/dd/yyyy` for yesterday). These tests must be modified to expect the NEW behavior (`'Yesterday'`, `'Tomorrow'`, ordinal format).\n\n## Test File\n\nUpdate: `apps/desktop/renderer/src/templates/daily.test.ts`\n\n## Current Tests That Need Updating (lines 30-41)\n\nThe existing tests explicitly expect old behavior:\n```typescript\n// CURRENT - expects old format\nit('returns MM/dd/yyyy for yesterday', () =\u003e {\n  expect(getDailyDisplayTitle(note)).toBe(format(yesterday, 'MM/dd/yyyy'));\n});\n\n// NEW - should expect 'Yesterday'\nit('returns \"Yesterday\" for yesterday', () =\u003e {\n  expect(getDailyDisplayTitle(note)).toBe('Yesterday');\n});\n```\n\n## Test Cases Required\n\n### Relative Date Tests\n\n| Test Case | Input Note Date | Expected Output |\n|-----------|----------------|------------------|\n| Today's note | today | \"Today\" |\n| Yesterday's note | yesterday | \"Yesterday\" |\n| Tomorrow's note | tomorrow | \"Tomorrow\" |\n\n### Ordinal Format Tests\n\n| Test Case | Input Note Date | Expected Output |\n|-----------|----------------|------------------|\n| Two days ago | 2 days prior | \"Dec 19th, 2024\" |\n| Week ago | 7 days prior | \"Dec 14th, 2024\" |\n| Historical date | Jul 28, 1990 | \"Jul 28th, 1990\" |\n| Future date (next week) | 7 days ahead | \"Dec 28th, 2024\" |\n\n### Ordinal Suffix Edge Cases\n\n| Test Case | Day | Expected Suffix |\n|-----------|-----|-----------------|\n| 1st | Jan 1 | \"1st\" |\n| 2nd | Jan 2 | \"2nd\" |\n| 3rd | Jan 3 | \"3rd\" |\n| 4th | Jan 4 | \"4th\" |\n| 11th exception | Jan 11 | \"11th\" (not 11st) |\n| 12th exception | Jan 12 | \"12th\" (not 12nd) |\n| 13th exception | Jan 13 | \"13th\" (not 13rd) |\n| 21st | Jan 21 | \"21st\" |\n| 22nd | Jan 22 | \"22nd\" |\n| 23rd | Jan 23 | \"23rd\" |\n\n### Error Handling Tests\n\n| Test Case | Input | Expected Output |\n|-----------|-------|------------------|\n| Invalid date string | \"invalid\" | \"invalid\" (returns original) |\n| Malformed date | \"13-45-2024\" | \"13-45-2024\" (returns original) |\n\n## Implementation Notes\n\n- Use `vitest` as the test runner\n- Mock `new Date()` for deterministic tests\n- Create helper to generate Note objects with specific dates\n\n## Sample Test Structure\n\n```typescript\nimport { describe, it, expect, vi, beforeEach, afterEach } from 'vitest';\nimport { getDailyDisplayTitle } from './daily';\nimport type { Note } from '@scribe/shared';\n\nfunction createDailyNote(dateStr: string): Note {\n  return {\n    id: 'test-id',\n    title: dateStr, // MM-dd-yyyy format\n    type: 'daily',\n    tags: ['daily'],\n    content: { root: { children: [] } },\n    createdAt: Date.now(),\n    updatedAt: Date.now(),\n  } as Note;\n}\n\ndescribe('getDailyDisplayTitle', () =\u003e {\n  beforeEach(() =\u003e {\n    vi.useFakeTimers();\n    vi.setSystemTime(new Date('2024-12-21T12:00:00'));\n  });\n\n  afterEach(() =\u003e {\n    vi.useRealTimers();\n  });\n\n  it('returns \"Today\" for today\\'s date', () =\u003e {\n    const note = createDailyNote('12-21-2024');\n    expect(getDailyDisplayTitle(note)).toBe('Today');\n  });\n\n  // ... more tests\n});\n```\n\n## Acceptance Criteria\n\n- [ ] Existing tests updated to expect new behavior\n- [ ] All test cases from tables above are implemented\n- [ ] Tests use mocked system time for determinism\n- [ ] Tests pass in CI\n- [ ] No flaky tests due to timezone issues\n\n## Dependencies\n\n- scribe-2 must be completed first (updates the function being tested)","status":"open","priority":1,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:44:57.73962-06:00","dependencies":[{"issue_id":"scribe-3","depends_on_id":"scribe-2","type":"blocks","created_at":"2025-12-21T21:25:35.672443-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-3","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.553683-06:00","created_by":"daemon"}]}
{"id":"scribe-4","title":"Create DateNavigator component skeleton","description":"# Create DateNavigator Component\n\n## Context\n\nThe DateNavigator is the core new UI component for this feature. It wraps the date display with optional navigation chevrons and a calendar popover.\n\n## Component Location\n\n`apps/desktop/renderer/src/components/NoteHeader/DateNavigator.tsx`\n\n## Props Interface\n\n**IMPORTANT**: Export the interface so it can be re-exported from index.ts:\n\n```typescript\nexport interface DateNavigatorProps {\n  /** The date to display and navigate from */\n  date: Date;\n  /** Called when navigating to a different date's daily note */\n  onNavigate: (date: Date) =\u003e void;\n  /** Whether to show chevron navigation (true for daily notes) */\n  showNavigation?: boolean;\n}\n```\n\n## Component Structure\n\n```\nDateNavigator\n├── ChevronButton (left) — only when showNavigation=true\n├── DateButton (trigger for Calendar popover)\n│   └── Calendar popover (only when showNavigation=true; uses @floating-ui/react)\n└── ChevronButton (right) — only when showNavigation=true\n└── aria-live region for announcements\n```\n\n## State Management\n\n```typescript\nconst [isHovered, setIsHovered] = useState(false);\nconst [isCalendarOpen, setIsCalendarOpen] = useState(false);\nconst [announcement, setAnnouncement] = useState('');\nconst dateButtonRef = useRef\u003cHTMLButtonElement\u003e(null);\nconst navigateTimeoutRef = useRef\u003cReturnType\u003ctypeof setTimeout\u003e\u003e();\nconst hoverTimeoutRef = useRef\u003cReturnType\u003ctypeof setTimeout\u003e\u003e();\n```\n\n## Key Behaviors\n\n### Hover State\n- When mouse enters container, clear any pending hide timeout, set `isHovered = true`\n- When mouse leaves, debounce 100ms then set `isHovered = false`\n- Chevrons visible when `isHovered || isCalendarOpen`\n\n### Navigation Debounce\n- Rapid chevron clicks should debounce (200ms)\n- Prevents excessive note creation from quick clicking\n\n### Calendar Popover\n- Only shown when `showNavigation=true`\n- Opens on date button click\n- Closes on: date selection, Escape, outside click\n- Uses existing Calendar component from design-system\n\n## Consolidated Requirements (from scribe-12, scribe-14, scribe-16)\n\n### Accessibility: aria-live region\nWhen navigation completes successfully, announce the new note's title:\n```typescript\n\u003cdiv\n  role=\"status\"\n  aria-live=\"polite\"\n  aria-atomic=\"true\"\n  className={styles.srOnly}\n\u003e\n  {announcement}\n\u003c/div\u003e\n```\n\n### Test Selectors (data-testid)\nAdd from the start:\n| Element | data-testid |\n|---------|-------------|\n| Container | `date-navigator` |\n| Left chevron | `date-nav-prev` |\n| Date button | `date-nav-button` |\n| Right chevron | `date-nav-next` |\n| Calendar popover | `date-nav-calendar` |\n\n### Accessibility: aria-expanded and aria-haspopup\n```typescript\n\u003cbutton\n  ref={dateButtonRef}\n  data-testid=\"date-nav-button\"\n  aria-label={showNavigation ? \"Open calendar to select date\" : \"Go to daily note for this date\"}\n  aria-expanded={isCalendarOpen}\n  aria-haspopup=\"dialog\"\n  onClick={handleDateClick}\n\u003e\n  {formattedDate}\n\u003c/button\u003e\n```\n\n### Performance: Memoization\n```typescript\nconst formattedDate = useMemo(\n  () =\u003e format(date, 'MMM do, yyyy'),\n  [date]\n);\n```\n\nConsider `memo()` wrapper if parent re-renders frequently.\n\n## Cleanup on Unmount\n\n```typescript\nuseEffect(() =\u003e {\n  return () =\u003e {\n    if (navigateTimeoutRef.current) clearTimeout(navigateTimeoutRef.current);\n    if (hoverTimeoutRef.current) clearTimeout(hoverTimeoutRef.current);\n  };\n}, []);\n```\n\n## Files to Create/Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.tsx`\n\n## Acceptance Criteria\n\n- [ ] Interface is exported with `export interface DateNavigatorProps`\n- [ ] Component renders with proper structure\n- [ ] Hover reveals/hides chevrons with smooth transition\n- [ ] Navigation debounced at 200ms\n- [ ] Hover leave debounced at 100ms\n- [ ] Calendar opens on date click (only when showNavigation=true)\n- [ ] All data-testid attributes present\n- [ ] aria-live region for announcements\n- [ ] aria-expanded and aria-haspopup on date button\n- [ ] Date formatting memoized\n- [ ] Keyboard navigation works (arrows, Enter, Escape)\n- [ ] Cleanup on unmount for all timeouts\n\n## Parallel With\n\nCan be implemented in parallel with scribe-2 and scribe-5","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:45:25.143939-06:00","dependencies":[{"issue_id":"scribe-4","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.59871-06:00","created_by":"daemon"}]}
{"id":"scribe-5","title":"Create DateNavigator Vanilla Extract styles","description":"# Create DateNavigator Styles\n\n## Context\n\nThe DateNavigator component needs Vanilla Extract styles that match the existing NoteHeader styling and use design system tokens.\n\n## File Location\n\n`apps/desktop/renderer/src/components/NoteHeader/DateNavigator.css.ts`\n\n## Design Token Mapping\n\n| Spec Token | Design System Token |\n|------------|--------------------|\n| Text muted | `vars.color.foregroundMuted` |\n| Text primary | `vars.color.foreground` |\n| Background hover | `vars.color.surface` |\n| Border radius | `vars.radius.sm` / `vars.radius.lg` |\n| Transition | `vars.animation.duration.fast` + `vars.animation.easing.default` |\n| Popover z-index | `vars.zIndex.popover` |\n| Popover shadow | `vars.shadow.lg` |\n\n## Style Definitions\n\n### Container\n\n```typescript\nimport { style } from '@vanilla-extract/css';\nimport { vars } from '@scribe/design-system';\n\nexport const dateNavigator = style({\n  display: 'inline-flex',\n  alignItems: 'center',\n  gap: vars.spacing['1'],\n  position: 'relative',\n});\n```\n\n### Chevron Button\n\nKey behaviors:\n- Hidden by default (opacity: 0)\n- Visible on container hover or when calendar open\n- 24x24px click target with 14x14px icon\n- Smooth opacity transition\n\n```typescript\nexport const chevronButton = style({\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  width: '24px',\n  height: '24px',\n  padding: 0,\n  border: 'none',\n  background: 'transparent',\n  borderRadius: vars.radius.sm,\n  cursor: 'pointer',\n  opacity: 0,\n  transition: `opacity ${vars.animation.duration.fast} ${vars.animation.easing.default}, background-color ${vars.animation.duration.fast} ${vars.animation.easing.default}`,\n  color: vars.color.foregroundMuted,\n  ':hover': {\n    color: vars.color.foreground,\n    backgroundColor: vars.color.surface,\n  },\n  ':focus': {\n    outline: 'none',\n  },\n  ':focus-visible': {\n    outline: `2px solid ${vars.color.accent}`,\n    outlineOffset: '2px',\n    opacity: 1,\n  },\n});\n\nexport const chevronVisible = style({\n  opacity: 1,\n});\n```\n\n### Date Button\n\nShould match existing `dateButton` style in NoteHeader.css.ts but may have slight modifications for the navigation context.\n\n```typescript\nexport const dateButton = style({\n  padding: `${vars.spacing['0']} ${vars.spacing['2']}`,\n  border: 'none',\n  background: 'transparent',\n  borderRadius: vars.radius.sm,\n  cursor: 'pointer',\n  fontSize: vars.typography.size.sm,\n  color: vars.color.foreground,\n  fontFamily: vars.typography.fontFamily.ui,\n  transition: `all ${vars.animation.duration.fast} ${vars.animation.easing.default}`,\n  ':hover': {\n    color: vars.color.accent,\n  },\n  ':focus': {\n    outline: 'none',\n  },\n  ':focus-visible': {\n    outline: `2px solid ${vars.color.accent}`,\n    outlineOffset: '2px',\n  },\n});\n```\n\n### Calendar Popover\n\nPositioned below the date button:\n\n```typescript\nexport const calendarPopover = style({\n  position: 'absolute',\n  top: '100%',\n  left: '50%',\n  transform: 'translateX(-50%)',\n  marginTop: vars.spacing['2'],\n  zIndex: vars.zIndex.popover,\n  backgroundColor: vars.color.background,\n  border: `1px solid ${vars.color.border}`,\n  borderRadius: vars.radius.lg,\n  boxShadow: vars.shadow.lg,\n  // Consider adding animation classes later\n});\n```\n\n## Animation Considerations\n\nThe spec calls for:\n- Chevrons: 150ms fade in/out\n- Calendar: Scale 0.95→1.0, opacity 0→1, 150ms\n\nFor MVP, simple opacity transitions are sufficient. Animation can be enhanced later.\n\n## Files to Create\n\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.css.ts`\n\n## Acceptance Criteria\n\n- [ ] All styles use design system tokens\n- [ ] Chevrons hidden by default, visible on hover\n- [ ] Focus-visible states for accessibility\n- [ ] Calendar popover positioned correctly\n- [ ] Smooth transitions on all interactive elements\n- [ ] Matches existing NoteHeader aesthetic","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z","dependencies":[{"issue_id":"scribe-5","depends_on_id":"scribe-4","type":"blocks","created_at":"2025-12-21T21:25:45.946096-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-5","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.642844-06:00","created_by":"daemon"}]}
{"id":"scribe-6","title":"Implement calendar popover positioning and outside click","description":"# Calendar Popover Positioning \u0026 Interactions\n\n## Context\n\nThe calendar popover needs proper positioning logic and outside-click-to-close behavior.\n\n## Prerequisites\n\n**IMPORTANT**: First install the dependency:\n```bash\ncd apps/desktop \u0026\u0026 bun add @floating-ui/react\n```\n\n## Requirements\n\n### Positioning\n\n1. Default: Below date button, centered\n2. If insufficient space below: Flip to above\n3. If insufficient space left/right: Adjust horizontal position\n\n### Close Triggers\n\n1. Date selection (handled in DateNavigator)\n2. Escape key (handled in DateNavigator)\n3. Click outside popover\n\n### Implementation: Floating UI\n\nUse `@floating-ui/react` for robust positioning:\n\n```typescript\nimport { \n  useFloating, \n  offset, \n  flip, \n  shift, \n  autoUpdate,\n  useClick,\n  useDismiss,\n  useInteractions,\n  FloatingFocusManager\n} from '@floating-ui/react';\n\nconst { refs, floatingStyles, context } = useFloating({\n  open: isCalendarOpen,\n  onOpenChange: setIsCalendarOpen,\n  placement: 'bottom',\n  middleware: [offset(8), flip(), shift({ padding: 8 })],\n  whileElementsMounted: autoUpdate,\n});\n\nconst click = useClick(context);\nconst dismiss = useDismiss(context, { escapeKey: true, outsidePress: true });\nconst { getReferenceProps, getFloatingProps } = useInteractions([click, dismiss]);\n```\n\n### Focus Management\n\nUse FloatingFocusManager for proper focus trapping:\n\n```typescript\n{isCalendarOpen \u0026\u0026 (\n  \u003cFloatingFocusManager context={context} modal={false}\u003e\n    \u003cdiv\n      ref={refs.setFloating}\n      style={floatingStyles}\n      className={styles.calendarPopover}\n      data-testid=\"date-nav-calendar\"\n      {...getFloatingProps()}\n    \u003e\n      \u003cCalendar\n        mode=\"single\"\n        selected={date}\n        onSelect={handleDateSelect}\n        defaultMonth={date}\n      /\u003e\n    \u003c/div\u003e\n  \u003c/FloatingFocusManager\u003e\n)}\n```\n\n### Outside Click Handling\n\nThe `useDismiss` hook from floating-ui handles this automatically when `outsidePress: true`.\n\n## Files to Modify\n\n- `apps/desktop/package.json` (add dependency)\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.tsx`\n\n## Acceptance Criteria\n\n- [ ] @floating-ui/react installed\n- [ ] Calendar positions correctly below button\n- [ ] Calendar flips above when near bottom edge\n- [ ] Calendar shifts horizontally when near edges\n- [ ] Clicking outside closes calendar\n- [ ] Escape key closes calendar\n- [ ] Focus trapped in calendar while open\n- [ ] Focus returns to date button on close\n\n## Dependencies\n\n- Depends on scribe-4 (DateNavigator skeleton must exist first)","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:45:43.164207-06:00","dependencies":[{"issue_id":"scribe-6","depends_on_id":"scribe-4","type":"blocks","created_at":"2025-12-21T21:25:56.233989-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-6","depends_on_id":"scribe-5","type":"blocks","created_at":"2025-12-21T21:26:06.520084-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-6","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.687314-06:00","created_by":"daemon"}]}
{"id":"scribe-7","title":"Add DateNavigator unit tests","description":"# DateNavigator Unit Tests\n\n## Context\n\nComprehensive unit tests for the DateNavigator component to verify all interaction behaviors.\n\n## Test File\n\n`apps/desktop/renderer/src/components/NoteHeader/DateNavigator.test.tsx`\n\n## Test Framework\n\n- Vitest for test runner\n- React Testing Library for component testing\n- @testing-library/user-event for interaction simulation\n\n## Test Categories\n\n### Rendering Tests\n\n| Test | Condition | Expected |\n|------|-----------|----------|\n| Renders date | Date = Dec 21, 2024 | Shows \"Dec 21st, 2024\" |\n| Renders chevrons when showNavigation=true | Default props | Left/right chevrons present |\n| Hides chevrons when showNavigation=false | showNavigation=false | No chevron buttons |\n\n### Hover Behavior Tests\n\n| Test | Action | Expected |\n|------|--------|----------|\n| Chevrons hidden initially | Mount component | Chevrons have opacity: 0 |\n| Chevrons visible on hover | Mouse enter container | Chevrons have opacity: 1 |\n| Chevrons hidden after hover | Mouse leave, wait 100ms | Chevrons have opacity: 0 |\n| Chevrons stay visible during calendar | Open calendar | Chevrons remain visible |\n\n### Navigation Tests\n\n| Test | Action | Expected |\n|------|--------|----------|\n| Previous day click | Click left chevron | onNavigate(Dec 20) |\n| Next day click | Click right chevron | onNavigate(Dec 22) |\n| Debounce rapid clicks | Click 3x in 100ms | Only 1 onNavigate call |\n\n### Calendar Tests\n\n| Test | Action | Expected |\n|------|--------|----------|\n| Opens on date click | Click date button | Calendar visible |\n| Closes on selection | Select date in calendar | Calendar hidden, onNavigate called |\n| Closes on Escape | Press Escape | Calendar hidden, no navigation |\n| Closes on outside click | Click outside | Calendar hidden, no navigation |\n| Focus returns on close | Close calendar | Date button focused |\n\n### Keyboard Navigation Tests\n\n| Test | Action | Expected |\n|------|--------|----------|\n| Left arrow navigates | Press ArrowLeft | onNavigate(prev day) |\n| Right arrow navigates | Press ArrowRight | onNavigate(next day) |\n| Enter opens calendar | Focus date, press Enter | Calendar opens |\n| Space opens calendar | Focus date, press Space | Calendar opens |\n\n### Props Tests\n\n| Test | Props | Expected |\n|------|-------|----------|\n| No navigation when disabled | showNavigation=false | No chevrons, no calendar |\n| Custom date displayed | date = Jan 1, 2025 | Shows \"Jan 1st, 2025\" |\n\n## Sample Test Implementation\n\n```typescript\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport userEvent from '@testing-library/user-event';\nimport { describe, it, expect, vi, beforeEach } from 'vitest';\nimport { DateNavigator } from './DateNavigator';\n\ndescribe('DateNavigator', () =\u003e {\n  const mockOnNavigate = vi.fn();\n  const defaultDate = new Date('2024-12-21T12:00:00');\n\n  beforeEach(() =\u003e {\n    vi.clearAllMocks();\n  });\n\n  it('renders the formatted date', () =\u003e {\n    render(\u003cDateNavigator date={defaultDate} onNavigate={mockOnNavigate} /\u003e);\n    expect(screen.getByText('Dec 21st, 2024')).toBeInTheDocument();\n  });\n\n  it('shows chevrons on hover', async () =\u003e {\n    const user = userEvent.setup();\n    render(\u003cDateNavigator date={defaultDate} onNavigate={mockOnNavigate} /\u003e);\n    \n    const container = screen.getByRole('button', { name: /previous/i }).parentElement!;\n    await user.hover(container);\n    \n    const leftChevron = screen.getByLabelText('Navigate to previous day');\n    expect(leftChevron).toHaveStyle({ opacity: '1' });\n  });\n\n  it('navigates to previous day on left chevron click', async () =\u003e {\n    const user = userEvent.setup();\n    render(\u003cDateNavigator date={defaultDate} onNavigate={mockOnNavigate} /\u003e);\n    \n    await user.click(screen.getByLabelText('Navigate to previous day'));\n    \n    await waitFor(() =\u003e {\n      expect(mockOnNavigate).toHaveBeenCalledWith(\n        expect.objectContaining({ getDate: expect.any(Function) })\n      );\n    });\n    // Verify it's Dec 20\n    const calledDate = mockOnNavigate.mock.calls[0][0];\n    expect(calledDate.getDate()).toBe(20);\n  });\n\n  // ... more tests\n});\n```\n\n## Files to Create\n\n- `apps/desktop/renderer/src/components/NoteHeader/DateNavigator.test.tsx`\n\n## Acceptance Criteria\n\n- [ ] All test cases from tables implemented\n- [ ] Tests use proper async/await patterns\n- [ ] No flaky tests\n- [ ] Good coverage of edge cases\n- [ ] Tests pass in CI","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z","dependencies":[{"issue_id":"scribe-7","depends_on_id":"scribe-4","type":"blocks","created_at":"2025-12-21T21:26:16.809073-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-7","depends_on_id":"scribe-5","type":"blocks","created_at":"2025-12-21T21:26:27.097027-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-7","depends_on_id":"scribe-6","type":"blocks","created_at":"2025-12-21T21:26:37.385474-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-7","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.732515-06:00","created_by":"daemon"}]}
{"id":"scribe-8","title":"Integrate DateNavigator into NoteHeader","description":"# Integrate DateNavigator into NoteHeader\n\n## Context\n\nReplace the existing date button in NoteHeader with the new DateNavigator component.\n\n## Current Implementation (NoteHeader.tsx)\n\nLines 227-240 contain the current date button that will be replaced.\n\n## Required Changes\n\n### 1. Update Props Interface\n\n```typescript\ninterface NoteHeaderProps {\n  note: Note;\n  onTitleChange: (title: string) =\u003e void;\n  onTagsChange: (tags: string[]) =\u003e void;\n  /** Called when navigating to a daily note for a date */\n  onNavigateToDaily: (date: Date) =\u003e void; // Renamed from onDateClick\n  translateY?: number;\n}\n```\n\n### 2. Import DateNavigator\n\n```typescript\nimport { DateNavigator } from './DateNavigator';\n```\n\n### 3. Replace Date Button\n\n```typescript\n\u003cdiv className={styles.metadataItem}\u003e\n  {(() =\u003e {\n    const displayDate = getDisplayDate(note);\n    const isDailyNote = note.type === 'daily';\n    return (\n      \u003cDateNavigator\n        date={displayDate.date}\n        onNavigate={onNavigateToDaily}\n        showNavigation={isDailyNote}\n      /\u003e\n    );\n  })()}\n\u003c/div\u003e\n```\n\n### 4. Update Index Export\n\n`apps/desktop/renderer/src/components/NoteHeader/index.ts`:\n\n```typescript\nexport { NoteHeader } from './NoteHeader';\nexport { DateNavigator } from './DateNavigator';\nexport type { DateNavigatorProps } from './DateNavigator';\n```\n\n### 5. Cleanup: Remove Deprecated Styles (from scribe-18)\n\nAfter integration, remove the unused `dateButton` style from NoteHeader.css.ts (lines 80-102):\n\n```bash\n# Verify not used elsewhere first\ngrep -r \"dateButton\" --include=\"*.ts\" --include=\"*.tsx\" apps/desktop/renderer/src/\n```\n\nThen remove the style definition.\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.tsx`\n- `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.css.ts` (cleanup)\n- `apps/desktop/renderer/src/components/NoteHeader/index.ts`\n\n## Acceptance Criteria\n\n- [ ] DateNavigator renders in place of old date button\n- [ ] Daily notes show navigation controls\n- [ ] Non-daily notes hide navigation controls\n- [ ] Prop renamed from onDateClick to onNavigateToDaily\n- [ ] Old dateButton style removed from CSS\n- [ ] Build passes with no TypeScript errors\n- [ ] Index exports updated","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2025-12-21T21:35:50.081511-06:00","dependencies":[{"issue_id":"scribe-8","depends_on_id":"scribe-4","type":"blocks","created_at":"2025-12-21T21:26:47.569447-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-8","depends_on_id":"scribe-5","type":"blocks","created_at":"2025-12-21T21:26:57.848458-06:00","created_by":"erikjohansson"},{"issue_id":"scribe-8","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.777143-06:00","created_by":"daemon"}]}
{"id":"scribe-9","title":"Update NoteHeader tests for DateNavigator integration","description":"# Update NoteHeader Tests\n\n## Context\n\nAfter integrating DateNavigator, NoteHeader tests need updates to:\n1. Test the new prop name (`onNavigateToDaily`)\n2. Test that DateNavigator is rendered correctly\n3. Test title display logic (Today/Yesterday/Tomorrow)\n\n## Test File\n\n`apps/desktop/renderer/src/components/NoteHeader/NoteHeader.test.tsx`\n\n## New Test Cases\n\n### Component Integration Tests\n\n| Test | Condition | Expected |\n|------|-----------|----------|\n| Daily note shows navigation | note.type = 'daily' | DateNavigator with showNavigation=true |\n| Non-daily hides navigation | note.type = 'note' | DateNavigator with showNavigation=false |\n| Meeting note hides navigation | note.type = 'meeting' | DateNavigator with showNavigation=false |\n\n### Title Display Tests\n\n| Test | Note Date | Expected Title |\n|------|-----------|---------------|\n| Today's daily | Today | \"Today\" |\n| Yesterday's daily | Yesterday | \"Yesterday\" |\n| Tomorrow's daily | Tomorrow | \"Tomorrow\" |\n| Other date daily | 2 days ago | \"Dec 19th, 2024\" |\n| Historical daily | Jul 28, 1990 | \"Jul 28th, 1990\" |\n\n### Prop Rename Tests\n\n| Test | Action | Expected |\n|------|--------|----------|\n| onNavigateToDaily called | Navigate via DateNavigator | Prop function called with Date |\n\n## Sample Tests\n\n```typescript\nimport { render, screen } from '@testing-library/react';\nimport { describe, it, expect, vi, beforeEach, afterEach } from 'vitest';\nimport { NoteHeader } from './NoteHeader';\nimport type { Note } from '@scribe/shared';\n\nfunction createNote(overrides: Partial\u003cNote\u003e = {}): Note {\n  return {\n    id: 'test-id',\n    title: '12-21-2024',\n    type: 'daily',\n    tags: ['daily'],\n    content: { root: { children: [] } },\n    createdAt: Date.now(),\n    updatedAt: Date.now(),\n    ...overrides,\n  } as Note;\n}\n\ndescribe('NoteHeader', () =\u003e {\n  beforeEach(() =\u003e {\n    vi.useFakeTimers();\n    vi.setSystemTime(new Date('2024-12-21T12:00:00'));\n  });\n\n  afterEach(() =\u003e {\n    vi.useRealTimers();\n  });\n\n  describe('title display for daily notes', () =\u003e {\n    it('shows \"Today\" for today\\'s daily note', () =\u003e {\n      const note = createNote({ title: '12-21-2024' });\n      render(\n        \u003cNoteHeader\n          note={note}\n          onTitleChange={() =\u003e {}}\n          onTagsChange={() =\u003e {}}\n          onNavigateToDaily={() =\u003e {}}\n        /\u003e\n      );\n      // The title input should show \"Today\"\n      expect(screen.getByDisplayValue('Today')).toBeInTheDocument();\n    });\n\n    it('shows \"Yesterday\" for yesterday\\'s daily note', () =\u003e {\n      const note = createNote({ title: '12-20-2024' });\n      render(\n        \u003cNoteHeader\n          note={note}\n          onTitleChange={() =\u003e {}}\n          onTagsChange={() =\u003e {}}\n          onNavigateToDaily={() =\u003e {}}\n        /\u003e\n      );\n      expect(screen.getByDisplayValue('Yesterday')).toBeInTheDocument();\n    });\n\n    it('shows \"Tomorrow\" for tomorrow\\'s daily note', () =\u003e {\n      const note = createNote({ title: '12-22-2024' });\n      render(\n        \u003cNoteHeader\n          note={note}\n          onTitleChange={() =\u003e {}}\n          onTagsChange={() =\u003e {}}\n          onNavigateToDaily={() =\u003e {}}\n        /\u003e\n      );\n      expect(screen.getByDisplayValue('Tomorrow')).toBeInTheDocument();\n    });\n  });\n\n  describe('DateNavigator integration', () =\u003e {\n    it('shows navigation for daily notes', () =\u003e {\n      const note = createNote({ type: 'daily' });\n      render(\n        \u003cNoteHeader\n          note={note}\n          onTitleChange={() =\u003e {}}\n          onTagsChange={() =\u003e {}}\n          onNavigateToDaily={() =\u003e {}}\n        /\u003e\n      );\n      expect(screen.getByLabelText('Navigate to previous day')).toBeInTheDocument();\n      expect(screen.getByLabelText('Navigate to next day')).toBeInTheDocument();\n    });\n\n    it('hides navigation for non-daily notes', () =\u003e {\n      const note = createNote({ type: 'note', title: 'Regular Note' });\n      render(\n        \u003cNoteHeader\n          note={note}\n          onTitleChange={() =\u003e {}}\n          onTagsChange={() =\u003e {}}\n          onNavigateToDaily={() =\u003e {}}\n        /\u003e\n      );\n      expect(screen.queryByLabelText('Navigate to previous day')).not.toBeInTheDocument();\n    });\n  });\n});\n```\n\n## Files to Modify\n\n- `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.test.tsx`\n\n## Acceptance Criteria\n\n- [ ] Tests updated for `onNavigateToDaily` prop\n- [ ] Title display tests for Today/Yesterday/Tomorrow\n- [ ] DateNavigator integration tests\n- [ ] All existing tests still pass\n- [ ] No flaky tests","status":"open","priority":2,"issue_type":"task","created_at":"2024-12-21T12:00:00Z","updated_at":"2024-12-21T12:00:00Z","dependencies":[{"issue_id":"scribe-9","depends_on_id":"scribe-3","type":"blocks","created_at":"2025-12-21T21:28:17.723739-06:00","created_by":"daemon"},{"issue_id":"scribe-9","depends_on_id":"scribe-8","type":"blocks","created_at":"2025-12-21T21:28:17.77382-06:00","created_by":"daemon"},{"issue_id":"scribe-9","depends_on_id":"scribe-1","type":"parent-child","created_at":"2025-12-21T21:28:24.822356-06:00","created_by":"daemon"}]}
