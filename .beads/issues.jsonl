{"id":"scribe-g6j","title":"Tech Debt Remediation Q1 2025","description":"Comprehensive tech debt remediation epic based on thorough codebase analysis. Covers:\n- Large file refactoring (10+ files over 400 lines)\n- Code duplication elimination (9 major duplication patterns)\n- Dead code removal (~40 unused exports)\n- Test coverage improvements (design-system at 17%, missing unit tests)\n- Documentation gaps (5 modules lacking docs)\n- Legacy patterns cleanup (any usage, inconsistent handler patterns)\n\nPriority areas identified:\n1. content-extractor.ts (1031 lines) - highest impact refactor\n2. Duplicate content creation functions (6+ locations)\n3. Design system primitive tests (17% coverage)\n4. CLI utilities missing tests (cli-installer.ts, input.ts)\n5. Error system consolidation (2 separate ErrorCode enums)","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-23T13:26:29.700381-06:00","updated_at":"2025-12-23T13:26:29.700381-06:00"}
{"id":"scribe-g6j.1","title":"Refactor content-extractor.ts (1031 lines) into modular components","description":"The largest file in the codebase at 1031 lines. Converts Scribe notes (Lexical editor format) to Markdown format.\n\nCurrent responsibilities (too many):\n- Markdown escaping logic (~150 lines)\n- Block-level node conversion (headings, paragraphs, lists, tables, code)\n- Inline content extraction (text, links, mentions)\n- YAML frontmatter generation\n- Context tracking during conversion\n\nProposed refactor:\n1. Create markdown-escaper.ts - All escapeMarkdownText logic\n2. Create block-converters.ts - Block-level node conversion\n3. Create inline-converters.ts - Inline content extraction\n4. Create frontmatter.ts - YAML frontmatter generation\n5. Keep content-extractor.ts as orchestrator (public API only)\n\nThe escapeMarkdownText function (lines 247-402) is particularly complex with 155 lines of intricate pattern matching logic.\n\nFiles: packages/shared/src/content-extractor.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:29.775576-06:00","updated_at":"2025-12-23T13:26:42.304538-06:00","dependencies":[{"issue_id":"scribe-g6j.1","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:29.77592-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.10","title":"Standardize createEmptyContent across packages","description":"Three different createEmptyContent implementations with structural differences:\n\nShared (packages/shared/src/content.ts, lines 17-36):\n- Returns root with empty paragraph with format, indent, direction, version properties\n\nCLI (apps/cli/src/node-builder.ts, lines 149-159):\n- Returns root with empty children array (no paragraph)\n\nTest-utils (packages/test-utils/src/note-factory.ts, lines 113-120):\n- Returns root with empty children array\n\nThe CLI version should import from @scribe/shared. Standardize on one structure (shared's version with empty paragraph is more correct for the editor).\n\nFiles: packages/shared/src/content.ts, apps/cli/src/node-builder.ts, packages/test-utils/src/note-factory.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.497212-06:00","updated_at":"2025-12-23T13:27:21.871567-06:00","dependencies":[{"issue_id":"scribe-g6j.10","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.497714-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.11","title":"Consolidate desktop logger to extend shared logger","description":"Two separate logger systems with different APIs:\n\nShared (packages/shared/src/logger.ts, 265 lines):\n- Full-featured with child loggers and structured context\n- Uses LOG_LEVEL environment variable\n- API: log.debug('message', { key: value })\n\nDesktop (apps/desktop/electron/main/src/logger.ts, 125 lines):\n- Simpler logger with pre-configured contexts\n- Different API: log.debug('message', value1, value2)\n- Different output format\n\nSolution: Desktop logger should extend or use the shared logger for consistency. This ensures logging behavior is uniform across CLI and desktop.\n\nFiles: apps/desktop/electron/main/src/logger.ts, packages/shared/src/logger.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.580902-06:00","updated_at":"2025-12-23T13:27:25.822179-06:00","dependencies":[{"issue_id":"scribe-g6j.11","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.581249-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.12","title":"Migrate test helpers to @scribe/test-utils package","description":"Test helper code duplicated between desktop and test-utils:\n\nDesktop (apps/desktop/test-helpers.ts):\n- setupTestContext, cleanupTestContext (lines 54-94)\n- createNoteContent, createNoteWithTitle, createAndIndexNote (lines 163-396)\n\nTest-utils (packages/test-utils/):\n- vault-factory.ts: createTestVault, cleanupTestVault (lines 76-182)\n- note-factory.ts: createTestNote, createMockNote, createGraphTestNote (lines 343-576)\n\nThe CLI's tests/helpers.ts shows the correct pattern - re-exporting from @scribe/test-utils.\n\nSolution: Migrate desktop's test-helpers.ts content into @scribe/test-utils where possible, then import.\n\nFiles: apps/desktop/test-helpers.ts, packages/test-utils/src/vault-factory.ts, packages/test-utils/src/note-factory.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.660177-06:00","updated_at":"2025-12-23T13:27:30.983778-06:00","dependencies":[{"issue_id":"scribe-g6j.12","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.660589-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.13","title":"Remove unused error type exports (SyncConflictError, MigrationError, etc)","description":"Unused error type exports in packages/shared/src/errors.ts:\n\nNever imported outside test files or exports:\n- SyncConflictError, isSyncConflictError (lines 362-370, 437-439)\n- MigrationError, isMigrationError (lines 375-383, 444-446)\n- TaskNotFoundError, isTaskNotFoundError (lines 352-357, 430-432)\n- isFileSystemError (lines 395-397) - only test file\n- isNoteError (lines 402-404) - only test file\n- isVaultError (lines 409-411) - never imported\n- isEngineError (lines 416-418) - never imported\n- isValidationError (lines 423-425) - only test file\n- getErrorMessageWithContext (lines 506-513) - only test file\n- FileSystemError, NoteError, VaultError, EngineError classes - never imported from package\n\nOptions:\n1. Remove unused exports from barrel\n2. Mark as internal-only\n3. Document as future API\n\nFiles: packages/shared/src/errors.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.743631-06:00","updated_at":"2025-12-23T13:27:36.881693-06:00","dependencies":[{"issue_id":"scribe-g6j.13","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.744032-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.14","title":"Remove unused date utility exports (formatDateMMDDYYYY, startOfDay, etc)","description":"Unused date utility exports in packages/shared/src/date-utils.ts:\n\nNever imported anywhere:\n- formatDateMMDDYYYY (lines 108-117)\n- parseDateMMDDYYYY (lines 271-285)\n- startOfDay (lines 409-418)\n- endOfDay (lines 429-438)\n- getDaysBetween (lines 379-394)\n\nThese may be useful future APIs but are currently dead code.\n\nOptions:\n1. Remove from barrel export, keep in file for future use\n2. Remove entirely if not planned\n3. Document as available utilities\n\nFiles: packages/shared/src/date-utils.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.829382-06:00","updated_at":"2025-12-23T13:27:40.725419-06:00","dependencies":[{"issue_id":"scribe-g6j.14","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.829781-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.15","title":"Remove unused note type guards (isRegularNote, isProjectNote, etc)","description":"Unused note type guards in packages/shared/src/types/note-types.ts:\n\nNever imported outside the file:\n- isRegularNote (lines 472-474)\n- isProjectNote (lines 516-518)\n- isTemplateNote (lines 538-540)\n- isSystemNote (lines 561-563)\n\nThese type guards are exported but never used in the codebase.\n\nOptions:\n1. Remove from exports if truly unused\n2. Keep if planned for future discriminated union handling\n3. Document intended usage\n\nFiles: packages/shared/src/types/note-types.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.916949-06:00","updated_at":"2025-12-23T13:27:43.733533-06:00","dependencies":[{"issue_id":"scribe-g6j.15","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.917414-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.16","title":"Remove deprecated LexicalState and LexicalNode type aliases","description":"Deprecated type aliases still in codebase (packages/shared/src/types/editor-types.ts):\n\n- LexicalState (line 97) - @deprecated, use EditorContent\n- LexicalNode (line 102) - @deprecated, use EditorNode\n\nThese are marked deprecated but still exported. No imports found outside exports.\n\nSolution:\n1. Search for any remaining usages\n2. Remove the deprecated aliases\n3. Update any remaining code to use EditorContent/EditorNode\n\nFiles: packages/shared/src/types/editor-types.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.00205-06:00","updated_at":"2025-12-23T13:27:47.436972-06:00","dependencies":[{"issue_id":"scribe-g6j.16","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.002415-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.17","title":"Clean up storage-fs internal exports (NoteValidator, AtomicFileWriter, etc)","description":"Internal utilities exported publicly from storage-fs (packages/storage-fs/src/index.ts):\n\nExported but only used internally or in tests:\n- NoteValidator, INoteValidator, ValidationResult (lines 10-14)\n- AtomicFileWriter, IAtomicFileWriter, AtomicWriteOptions (lines 16-20)\n- NoteMigrator, INoteMigrator, NOTE_FORMAT_VERSION (lines 22-26)\n- QuarantineManager, createQuarantineManager, IQuarantineManager (lines 27-31)\n\nThese are implementation details, not public API. QuarantineManager is accessed via vault method.\n\nSolution: Make these internal-only, remove from barrel export. If external testing needs access, expose via test-utils package instead.\n\nFiles: packages/storage-fs/src/index.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:31.093468-06:00","updated_at":"2025-12-23T13:27:52.111041-06:00","dependencies":[{"issue_id":"scribe-g6j.17","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.093871-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.18","title":"Add unit tests for design-system Button primitive","description":"Design system Button primitive has no unit tests.\n\nFile: packages/design-system/src/primitives/Button/Button.tsx\n\nCurrent coverage: 0%\nPackage coverage: 17% overall\n\nTests needed:\n- Render with different variants\n- Click handler invocation\n- Disabled state\n- Loading state (if applicable)\n- Accessibility attributes\n\nFiles: packages/design-system/src/primitives/Button/Button.tsx","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.181248-06:00","updated_at":"2025-12-23T13:27:55.129956-06:00","dependencies":[{"issue_id":"scribe-g6j.18","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.181637-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.19","title":"Add unit tests for design-system Calendar primitive","description":"Design system Calendar primitive has no unit tests.\n\nFile: packages/design-system/src/primitives/Calendar/Calendar.tsx\n\nCurrent coverage: 0%\nPackage coverage: 17% overall\n\nTests needed:\n- Date selection\n- Month navigation\n- Disabled dates\n- Date range handling\n- Keyboard navigation\n- Accessibility\n\nFiles: packages/design-system/src/primitives/Calendar/Calendar.tsx","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.268078-06:00","updated_at":"2025-12-23T13:27:57.354695-06:00","dependencies":[{"issue_id":"scribe-g6j.19","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.268425-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.2","title":"Consolidate duplicate note-factory.ts patterns (619 lines)","description":"The note-factory.ts file has 619 lines with significant code duplication between factory functions.\n\nDuplication pattern: createTestNote, createMockNote, createGraphTestNote, and createContentTestNote all have nearly identical switch statements for handling note types.\n\nContent helpers (lines 109-291) should be in separate content-factory.ts.\n\nProposed solution:\n1. Create a single base factory function with builder pattern\n2. Extract content helpers to content-factory.ts\n3. Reduce 4 factory functions to 1 configurable factory\n4. Consolidate switch statement logic into shared helper\n\nFiles: packages/test-utils/src/note-factory.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:29.851436-06:00","updated_at":"2025-12-23T13:26:46.61879-06:00","dependencies":[{"issue_id":"scribe-g6j.2","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:29.851808-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.20","title":"Add unit tests for design-system FloatingMenu primitive","description":"Design system FloatingMenu primitive has no unit tests.\n\nFile: packages/design-system/src/primitives/FloatingMenu/FloatingMenu.tsx (307 lines)\n\nCurrent coverage: 0%\nPackage coverage: 17% overall\n\nThis is one of the larger primitives. Tests needed:\n- Positioning calculations\n- Show/hide behavior\n- Keyboard navigation\n- Click outside handling\n- Anchor element tracking\n\nFiles: packages/design-system/src/primitives/FloatingMenu/FloatingMenu.tsx","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.354317-06:00","updated_at":"2025-12-23T13:27:59.497153-06:00","dependencies":[{"issue_id":"scribe-g6j.20","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.354648-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.21","title":"Add unit tests for cli-installer.ts (312 lines, complex symlink logic)","description":"cli-installer.ts is 312 lines with complex symlink management and NO tests.\n\nFile: apps/desktop/electron/main/src/cli-installer.ts\n\nComplex logic includes:\n- Symlink creation and verification\n- PATH configuration detection (bash, zsh, fish)\n- Existing file handling\n- Error recovery scenarios\n- Multiple file system operations\n\nTests needed:\n- Test symlink creation success/failure\n- Test PATH detection for different shells\n- Test existing file handling (overwrite, skip)\n- Mock filesystem operations\n- Error scenario coverage\n\nThis is HIGH PRIORITY - complex logic with file system side effects.\n\nFiles: apps/desktop/electron/main/src/cli-installer.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:31.439187-06:00","updated_at":"2025-12-23T13:28:03.915548-06:00","dependencies":[{"issue_id":"scribe-g6j.21","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.439552-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.22","title":"Add unit tests for CLI input.ts (stdin/file reading)","description":"CLI input.ts (155 lines) has no tests for stdin/file reading logic.\n\nFile: apps/cli/src/input.ts\n\nComplex logic includes:\n- stdin reading with size limits\n- File input handling\n- Escape sequence processing\n- Error handling for edge cases\n\nTests needed:\n- Test stdin reading\n- Test file reading\n- Test escape sequence processing\n- Test size limit enforcement\n- Test error handling\n\nThis is HIGH PRIORITY - input handling is critical for CLI reliability.\n\nFiles: apps/cli/src/input.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:31.516639-06:00","updated_at":"2025-12-23T13:28:06.581912-06:00","dependencies":[{"issue_id":"scribe-g6j.22","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.517013-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.23","title":"Add unit tests for CLI config.ts","description":"CLI config.ts (51 lines) has no tests.\n\nFile: apps/cli/src/config.ts\n\nLogic includes:\n- Configuration file loading\n- JSON parsing error handling\n- Missing config file handling\n\nTests needed:\n- Test config loading success\n- Test malformed JSON handling\n- Test missing config file behavior\n- Test default values\n\nFiles: apps/cli/src/config.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.596928-06:00","updated_at":"2025-12-23T13:28:08.494319-06:00","dependencies":[{"issue_id":"scribe-g6j.23","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.597351-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.24","title":"Add unit tests for PersonMentionNode.ts","description":"PersonMentionNode.ts (183 lines) is a Lexical decorator node with no tests.\n\nFile: apps/desktop/renderer/src/components/Editor/plugins/PersonMentionNode.ts\n\nComplex logic includes:\n- Serialization/deserialization\n- Clone operation\n- DOM creation\n- Click handling and navigation\n\nTests needed:\n- Test serialization to JSON\n- Test deserialization from JSON\n- Test clone produces correct copy\n- Test DOM output structure\n- Test click handler navigation\n\nFiles: apps/desktop/renderer/src/components/Editor/plugins/PersonMentionNode.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.673279-06:00","updated_at":"2025-12-23T13:28:11.999729-06:00","dependencies":[{"issue_id":"scribe-g6j.24","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.67363-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.25","title":"Add unit tests for InlineLinkNode.ts","description":"InlineLinkNode.ts has no tests.\n\nFile: apps/desktop/renderer/src/components/Editor/plugins/InlineLinkNode.ts\n\nHandles external link rendering and URL validation.\n\nTests needed:\n- Test URL validation\n- Test rendering output\n- Test serialization/deserialization\n- Test link click behavior\n\nFiles: apps/desktop/renderer/src/components/Editor/plugins/InlineLinkNode.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.746966-06:00","updated_at":"2025-12-23T13:28:14.052637-06:00","dependencies":[{"issue_id":"scribe-g6j.25","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.750781-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.26","title":"Add unit tests for tasksHandlers.ts toggleChecklistNode logic","description":"tasksHandlers.ts has integration tests but lacks unit tests for the toggleChecklistNode logic.\n\nFile: apps/desktop/electron/main/src/handlers/tasksHandlers.ts\n\nThe toggleChecklistNode function has complex fallback logic for finding and toggling task nodes in the editor state. This deserves isolated unit testing.\n\nTests needed:\n- Test finding checklist node by various identifiers\n- Test toggle behavior (checked -\u003e unchecked, unchecked -\u003e checked)\n- Test fallback logic when node not found\n- Test error handling\n\nFiles: apps/desktop/electron/main/src/handlers/tasksHandlers.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.824093-06:00","updated_at":"2025-12-23T13:28:17.730881-06:00","dependencies":[{"issue_id":"scribe-g6j.26","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.824476-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.27","title":"Fix skipped rollback tests in useNoteState.test.ts","description":"Two tests are skipped in useNoteState.test.ts indicating incomplete rollback functionality.\n\nFile: apps/desktop/renderer/src/hooks/useNoteState.test.ts\n\nSkipped tests (lines 473-527):\n1. 'rolls back on save failure (success: false)' (line 475)\n2. 'rolls back on save exception' (line 501)\n\nComment: \"TODO: Fix rollback tests - they have timing issues with hook's ref-based rollback mechanism\"\n\nThis indicates:\n- Rollback functionality may not work correctly\n- Tests have timing issues with ref-based mechanism\n- Technical debt in both implementation and tests\n\nSolution: Fix the underlying rollback implementation, then unskip tests.\n\nFiles: apps/desktop/renderer/src/hooks/useNoteState.test.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.901162-06:00","updated_at":"2025-12-23T13:28:22.823772-06:00","dependencies":[{"issue_id":"scribe-g6j.27","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.901532-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.28","title":"Document escapeMarkdownText algorithm in content-extractor.ts","description":"The escapeMarkdownText function in content-extractor.ts (lines 247-402) is 155 lines of complex pattern matching without algorithmic documentation.\n\nCurrent state: No high-level comment explaining the algorithm approach, the state machine used for tracking line starts, emphasis characters, etc.\n\nThe function handles:\n- Detecting emphasis patterns\n- Tracking line state\n- Complex character escaping rules\n\nNeeded: Block comment at function start explaining:\n1. Overall algorithm approach\n2. State machine design\n3. Key decision points\n4. Edge cases handled\n\nFiles: packages/shared/src/content-extractor.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.984868-06:00","updated_at":"2025-12-23T13:28:26.998288-06:00","dependencies":[{"issue_id":"scribe-g6j.28","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.985293-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.29","title":"Add JSDoc to createCLI function in cli.ts","description":"The createCLI function in cli.ts lacks JSDoc documentation.\n\nFile: apps/cli/src/cli.ts\n\nMissing documentation for:\n- Function purpose\n- Return value (Command object)\n- Available global options\n- Subcommand organization\n- How to extend the CLI\n\nExample JSDoc needed:\n```typescript\n/**\n * Creates and configures the Scribe CLI application.\n * \n * @returns Configured Commander.js Command instance\n * \n * @example\n * const cli = createCLI();\n * cli.parseAsync(process.argv);\n */\n```\n\nFiles: apps/cli/src/cli.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.067917-06:00","updated_at":"2025-12-23T13:28:30.954352-06:00","dependencies":[{"issue_id":"scribe-g6j.29","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.068288-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.3","title":"Split TableKeyboardPlugin.tsx into table utility modules","description":"TableKeyboardPlugin.tsx is 515 lines with ~15 internal helper functions for table manipulation.\n\nCurrent structure: All helper functions are internal but could be extracted:\n- tableSelectionUtils.ts - Selection-related helpers ($isSelectionInTable, $getTableCellFromSelection, etc.)\n- tableNavigationUtils.ts - Navigation helpers ($isFirstCellInTable, $isLastCellInTable, $exitTableBefore/After)\n- TableKeyboardPlugin.tsx - Just the React component registering commands\n\nBenefits: Reduces cognitive load when debugging table issues, enables reuse of table utilities.\n\nFiles: apps/desktop/renderer/src/components/Editor/plugins/TableKeyboardPlugin.tsx","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:29.926283-06:00","updated_at":"2025-12-23T13:26:51.292675-06:00","dependencies":[{"issue_id":"scribe-g6j.3","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:29.926671-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.30","title":"Add JSDoc to createWindow function in main.ts","description":"The createWindow function in main.ts (lines 107-192) is 85 lines with no JSDoc.\n\nFile: apps/desktop/electron/main/src/main.ts\n\nComplex configuration includes:\n- Window dimensions and bounds\n- Preload script path\n- Web preferences (security settings)\n- Context menu setup\n- State restoration\n\nMissing documentation for:\n- Security settings rationale\n- Window configuration choices\n- Context menu behavior\n- State persistence\n\nFiles: apps/desktop/electron/main/src/main.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.149659-06:00","updated_at":"2025-12-23T13:28:33.716907-06:00","dependencies":[{"issue_id":"scribe-g6j.30","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.149997-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.31","title":"Document magic numbers in fuzzy-search.ts and hash-utils.ts","description":"Magic numbers in fuzzy-search.ts and hash-utils.ts lack rationale documentation.\n\nfuzzy-search.ts:\n- FUZZY_MATCH_THRESHOLD = 0.3 (why 0.3?)\n- SUBSTRING_MATCH_BASE = 0.9 (why 0.9?)\n- ALL_WORDS_MATCH_SCORE = 0.85 (why 0.85?)\n\nhash-utils.ts:\n- DJB2_HASH_INITIAL = 5381 (why 5381?)\n- DJB2_HASH_MULTIPLIER = 33 (why 33?)\n- TEXT_HASH_LENGTH = 16 (why 16?)\n\nAdd inline comments explaining:\n- Why these specific values were chosen\n- What user testing/research informed the fuzzy search thresholds\n- That 5381 is a prime for good hash distribution\n- That 33 is traditional in DJB2 algorithm\n\nFiles: packages/shared/src/fuzzy-search.ts, packages/shared/src/hash-utils.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.232644-06:00","updated_at":"2025-12-23T13:28:39.153381-06:00","dependencies":[{"issue_id":"scribe-g6j.31","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.233034-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.32","title":"Create test utilities to eliminate as any casts in integration tests","description":"Integration tests use 'as any' casts to bypass TypeScript, indicating missing test utilities.\n\nHigh-priority files with any casts:\n- templates.integration.test.ts (lines 372, 509-510, 522) - child nodes\n- linked-notes.integration.test.ts (lines 145, 333, 648, 688, 789, 860) - paragraph content\n- date-based-mentions.integration.test.ts (lines 226-227, 593-594, 682-683) - timestamp overrides\n- delete-note.integration.test.ts (lines 420, 471) - test data\n- meeting.test.ts (lines 9, 17-18, 26-31, 42) - content types\n\nExample hack (date-based-mentions, lines 226-227):\n```typescript\n// Manually override timestamps for testing\n(savedNote as any).createdAt = timestamp;\n(savedNote as any).updatedAt = timestamp;\n```\n\nSolution: Create test utilities:\n```typescript\nfunction createTestNote(overrides: Partial\u003cNote\u003e): Note\nfunction withTimestamp\u003cT\u003e(obj: T, timestamp: number): T\n```\n\nFiles: apps/desktop/test-helpers.ts, packages/test-utils/src/note-factory.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:32.311068-06:00","updated_at":"2025-12-23T13:28:46.22583-06:00","dependencies":[{"issue_id":"scribe-g6j.32","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.311422-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.33","title":"Refactor handlers to use EngineOrchestrator consistently","description":"IPC handlers use inconsistent patterns for accessing engines.\n\nPattern A - Direct vault access (read-only):\n```typescript\nipcMain.handle('notes:list', async () =\u003e {\n  const vault = requireVault(deps);\n  return vault.list();\n});\n```\n\nPattern B - Using withEngines helper (write operations):\n```typescript\nipcMain.handle('notes:save', withEngines(deps, async (engines, note) =\u003e {...}));\n```\n\nThe EngineOrchestrator (apps/desktop/electron/main/src/EngineOrchestrator.ts) exists but isn't used consistently in all handlers.\n\nSolution:\n1. Document the intentional difference between patterns in code comments\n2. Refactor write operations to use EngineOrchestrator consistently\n3. Add CONTRIBUTING.md documentation for when to use each pattern\n\nFiles: apps/desktop/electron/main/src/handlers/notesHandlers.ts, apps/desktop/electron/main/src/EngineOrchestrator.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:32.38807-06:00","updated_at":"2025-12-23T13:28:51.369531-06:00","dependencies":[{"issue_id":"scribe-g6j.33","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.388416-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.34","title":"Convert remaining Promise .then()/.catch() to async/await","description":"Legacy Promise .then()/.catch() patterns should be converted to async/await.\n\nLocations:\n1. packages/engine-core/src/task-index.ts line 206:\n   this.persist().catch((err) =\u003e {...})\n\n2. packages/test-utils/src/vault-factory.ts lines 98, 179:\n   .catch(() =\u003e {}) for cleanup\n\n3. apps/cli/src/index.ts line 16:\n   cli.parseAsync(process.argv).catch(...)\n\n4. apps/desktop/electron/main/src/main.ts line 194:\n   app.whenReady().then(async () =\u003e {...})\n\nThe app.whenReady().then() is borderline acceptable for entry point code, but the others should use try/catch with async/await for consistency.\n\nFiles: packages/engine-core/src/task-index.ts, apps/desktop/electron/main/src/main.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.461623-06:00","updated_at":"2025-12-23T13:28:56.455984-06:00","dependencies":[{"issue_id":"scribe-g6j.34","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.461959-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.4","title":"Extract autocomplete hooks into separate files","description":"useTriggerableAutocomplete.ts is 498 lines with three hooks in one file:\n1. useTriggerableAutocomplete - Main hook for wiki-links [[  and mentions @\n2. useAutocompleteKeyboardNavigation - Keyboard navigation\n3. useClickOutside - Generic click outside detection\n\nProposed split:\n- useTriggerableAutocomplete.ts - Main hook only\n- useAutocompleteKeyboard.ts - Keyboard navigation hook\n- useClickOutside.ts - Generic reusable click outside hook\n\nThe useClickOutside hook is generic and could be reused elsewhere in the codebase.\n\nFiles: apps/desktop/renderer/src/components/Editor/hooks/useTriggerableAutocomplete.ts","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.000154-06:00","updated_at":"2025-12-23T13:26:55.353433-06:00","dependencies":[{"issue_id":"scribe-g6j.4","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.000698-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.5","title":"Merge CLI ErrorCode enum into shared package","description":"Two separate ErrorCode enums exist with overlapping codes:\n\nCLI (apps/cli/src/errors.ts):\n- NOTE_NOT_FOUND (line 4)\n- VAULT_NOT_FOUND (line 3)\n- PERMISSION_DENIED\n\nShared (packages/shared/src/errors.ts):\n- NOTE_NOT_FOUND (line 43)\n- VAULT_NOT_INITIALIZED (line 48)\n- 77 total error codes\n\nSolution:\n1. Add CLI-specific codes to shared ErrorCode enum\n2. Have CLI import from @scribe/shared\n3. CLIError can extend ScribeError or use shared codes\n4. Remove duplicate enum from CLI\n\nFiles: apps/cli/src/errors.ts, packages/shared/src/errors.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:30.076838-06:00","updated_at":"2025-12-23T13:26:59.929994-06:00","dependencies":[{"issue_id":"scribe-g6j.5","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.077178-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.6","title":"Consolidate wrapError function into shared handler utilities","description":"Identical wrapError function duplicated in two handler files:\n\nnotesHandlers.ts (lines 52-59):\n```typescript\nfunction wrapError(error: unknown): never {\n  if (error instanceof ScribeError) {\n    const userError = new Error(error.getUserMessage());\n    userError.name = error.code;\n    throw userError;\n  }\n  throw error;\n}\n```\n\npeopleHandlers.ts (lines 43-50): Identical implementation\n\nSolution: Move wrapError to handlers/types.ts alongside other shared handler utilities (requireVault, withEngines, etc.)\n\nFiles: apps/desktop/electron/main/src/handlers/notesHandlers.ts, apps/desktop/electron/main/src/handlers/peopleHandlers.ts, apps/desktop/electron/main/src/handlers/types.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.15794-06:00","updated_at":"2025-12-23T13:27:04.734418-06:00","dependencies":[{"issue_id":"scribe-g6j.6","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.158313-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.7","title":"Consolidate createDailyContent into single source of truth","description":"createDailyContent function duplicated in 6+ locations:\n\n1. apps/desktop/renderer/src/templates/daily.ts (lines 10-40) - Canonical source\n2. apps/desktop/electron/main/src/handlers/dailyHandlers.ts (lines 51-81)\n3. apps/desktop/daily-handlers.integration.test.ts (lines 31-68)\n4. apps/desktop/meeting-handlers.integration.test.ts (lines 34-67)\n5. apps/desktop/date-based-meeting.integration.test.ts (lines 30-63)\n6. apps/desktop/templates.integration.test.ts (lines 37-72)\n\nSolution:\n1. Export canonical createDailyContent from renderer/src/templates/daily.ts (already exported)\n2. Import in dailyHandlers.ts instead of duplicating\n3. Move test helper versions to use shared import or @scribe/test-utils\n\nFiles: apps/desktop/renderer/src/templates/daily.ts, apps/desktop/electron/main/src/handlers/dailyHandlers.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:30.239801-06:00","updated_at":"2025-12-23T13:27:09.97685-06:00","dependencies":[{"issue_id":"scribe-g6j.7","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.24019-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.8","title":"Consolidate createMeetingContent into single source of truth","description":"createMeetingContent function duplicated in 5+ locations:\n\n1. apps/desktop/renderer/src/templates/meeting.ts (lines 52-70) - Canonical source\n2. apps/desktop/electron/main/src/handlers/meetingHandlers.ts (lines 54-104)\n3. apps/desktop/meeting-handlers.integration.test.ts (lines 69-103)\n4. apps/desktop/date-based-meeting.integration.test.ts (lines 65-100)\n5. apps/desktop/templates.integration.test.ts (lines 73-108)\n\nSolution: Same as createDailyContent - import from canonical source, share via test utilities.\n\nFiles: apps/desktop/renderer/src/templates/meeting.ts, apps/desktop/electron/main/src/handlers/meetingHandlers.ts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:30.325653-06:00","updated_at":"2025-12-23T13:27:13.293666-06:00","dependencies":[{"issue_id":"scribe-g6j.8","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.326044-06:00","created_by":"daemon"}]}
{"id":"scribe-g6j.9","title":"Consolidate createPersonContent into single source of truth","description":"createPersonContent function duplicated in 3 locations:\n\n1. apps/desktop/test-helpers.ts (lines 237-255)\n2. apps/desktop/electron/main/src/handlers/peopleHandlers.ts (lines 63-92)\n3. apps/desktop/people-handlers.integration.test.ts (as createPersonContentInternal, lines 34-56)\n\nSolution: Create canonical source in templates similar to daily/meeting, then import everywhere else.\n\nFiles: apps/desktop/electron/main/src/handlers/peopleHandlers.ts, apps/desktop/test-helpers.ts","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.409757-06:00","updated_at":"2025-12-23T13:27:16.408803-06:00","dependencies":[{"issue_id":"scribe-g6j.9","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.410158-06:00","created_by":"daemon"}]}
