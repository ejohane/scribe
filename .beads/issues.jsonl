{"id":"scribe-g6j","title":"Tech Debt Remediation Q1 2025","description":"Comprehensive tech debt remediation epic based on thorough codebase analysis. Covers:\n- Large file refactoring (10+ files over 400 lines)\n- Code duplication elimination (9 major duplication patterns)\n- Dead code removal (~40 unused exports)\n- Test coverage improvements (CLI utilities, Lexical nodes)\n- Documentation gaps (5 modules lacking docs)\n- Legacy patterns cleanup (any usage, inconsistent handler patterns)\n\n## Priority Areas\n1. content-extractor.ts (1031 lines) - highest impact refactor\n2. Duplicate content creation functions (6+ locations)\n3. CLI utilities missing tests (cli-installer.ts, input.ts)\n4. Error system consolidation (2 separate ErrorCode enums)\n\n## Refined Dependency Graph\n\n### Wave 1: Fully Parallel (No blockers - start immediately)\nThese 22 tasks can run in parallel with no dependencies:\n\n**P1 (Critical Path):**\n- g6j.1: Refactor content-extractor.ts → UNBLOCKS g6j.28\n- g6j.5: Merge CLI ErrorCode enum into shared package\n- g6j.21: Add unit tests for cli-installer.ts\n- g6j.22: Add unit tests for CLI input.ts\n\n**P1 Content Consolidation (parallel with each other):**\n- g6j.7: Consolidate createDailyContent → UNBLOCKS g6j.12, g6j.2\n- g6j.8: Consolidate createMeetingContent → UNBLOCKS g6j.12, g6j.2\n- g6j.9: Consolidate createPersonContent → UNBLOCKS g6j.12, g6j.2\n\n**P2 Independent:**\n- g6j.3: Split TableKeyboardPlugin.tsx into modules\n- g6j.6: Consolidate wrapError function\n- g6j.10: Standardize createEmptyContent\n- g6j.16: Remove deprecated LexicalState/LexicalNode\n- g6j.23-26: Unit tests (config.ts, PersonMentionNode, InlineLinkNode, tasksHandlers)\n- g6j.27: Fix skipped rollback tests\n- g6j.33: Refactor handlers to use EngineOrchestrator\n\n**P3 Dead Code Removal (fully parallel):**\n- g6j.13: Remove unused error exports\n- g6j.14: Remove unused date utility exports\n- g6j.15: Remove unused note type guards\n- g6j.17: Clean up storage-fs internal exports\n\n**P3 Documentation (fully parallel):**\n- g6j.29: JSDoc for createCLI\n- g6j.30: JSDoc for createWindow\n- g6j.31: Document magic numbers\n- g6j.34: Convert Promise .then() to async/await\n\n**P3 Hooks Refactoring:**\n- g6j.4: Extract autocomplete hooks\n- g6j.11: Consolidate desktop logger\n\n### Wave 2: After Content Consolidation (g6j.7, g6j.8, g6j.9)\n- g6j.2: Consolidate note-factory.ts patterns (needs content functions)\n- g6j.12: Migrate test helpers to @scribe/test-utils\n\n### Wave 3: After g6j.1\n- g6j.28: Document escapeMarkdownText algorithm (after refactor)\n\n### Wave 4: After g6j.12 + g6j.2\n- g6j.32: Create test utilities to eliminate `as any` casts\n\n## Closed as Already Done\n- g6j.18, g6j.19, g6j.20 (design-system primitive tests already exist)\n\n## Recommended Execution Order\n1. Start Wave 1 tasks in parallel (max parallelism)\n2. As g6j.7, g6j.8, g6j.9 complete → start g6j.2, g6j.12\n3. As g6j.1 completes → start g6j.28\n4. As g6j.12 + g6j.2 complete → start g6j.32","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-23T13:26:29.700381-06:00","updated_at":"2025-12-23T14:37:57.01957-06:00","closed_at":"2025-12-23T14:37:57.01957-06:00"}
{"id":"scribe-g6j.1","title":"Refactor content-extractor.ts (1031 lines) into modular components","description":"Refactor content-extractor.ts (1031 lines) into modular components.\n\nThe largest file in the codebase. Converts Scribe notes (Lexical editor format) to Markdown format.\n\n**Current responsibilities (too many):**\n- Markdown escaping logic (~156 lines, lines 247-402 - `escapeMarkdownText`)\n- Block-level node conversion (headings, paragraphs, lists, tables, code)\n- Inline content extraction (text, links, mentions)\n- YAML frontmatter generation\n- Context tracking during conversion\n\n**Proposed refactor - create new files in packages/shared/src/:**\n1. `markdown-escaper.ts` - All escapeMarkdownText logic (~156 lines)\n2. `block-converters.ts` - Block-level node conversion\n3. `inline-converters.ts` - Inline content extraction\n4. `frontmatter.ts` - YAML frontmatter generation\n5. Keep `content-extractor.ts` as orchestrator (public API only, ~100 lines)\n\n**Implementation Steps:**\n1. Extract escapeMarkdownText to markdown-escaper.ts first (most isolated, lines 247-402)\n2. Extract frontmatter generation to frontmatter.ts\n3. Extract block converters (maintains internal helper functions)\n4. Extract inline converters\n5. Update content-extractor.ts to import and orchestrate\n6. Ensure all tests pass: `bun test packages/shared`\n7. Update package exports in packages/shared/src/index.ts if needed\n\n**Key files:**\n- packages/shared/src/content-extractor.ts (source)\n- packages/shared/src/content-extractor.test.ts (verify with existing tests)\n\n**Parallel safe:** No dependencies on other tasks.\n\n**UNBLOCKS:** scribe-g6j.28 (documentation of escapeMarkdownText algorithm)\n\nFiles: packages/shared/src/content-extractor.ts, packages/shared/src/markdown-escaper.ts (NEW), packages/shared/src/block-converters.ts (NEW), packages/shared/src/inline-converters.ts (NEW), packages/shared/src/frontmatter.ts (NEW)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:29.775576-06:00","updated_at":"2025-12-23T14:02:26.403019-06:00","closed_at":"2025-12-23T14:02:26.403019-06:00","dependencies":[{"issue_id":"scribe-g6j.1","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:29.77592-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.10","title":"Standardize createEmptyContent across packages","description":"Standardize createEmptyContent across packages.\n\nThree different createEmptyContent implementations with structural differences:\n\n**Shared (packages/shared/src/content.ts, lines 17-36):** ✓ CANONICAL\n- Returns root with empty paragraph including format, indent, direction, version properties\n- Already exported from @scribe/shared\n\n**CLI (apps/cli/src/node-builder.ts, lines 149-159):** DIFFERENT STRUCTURE\n- Returns root with empty children array (no paragraph)\n- Inconsistent with shared package\n\n**Test-utils (packages/test-utils/src/note-factory.ts, lines 113-120):**\n- Returns root with empty children array\n- Re-exports from @scribe/shared in index.ts\n\n**Implementation Steps:**\n1. Verify shared createEmptyContent is the correct structure (with empty paragraph)\n2. Update CLI `apps/cli/src/node-builder.ts` to import from @scribe/shared instead of defining locally\n3. Remove local createEmptyContent from node-builder.ts\n4. Verify test-utils already re-exports from shared (it does in index.ts, but has local copy in note-factory.ts)\n5. Remove duplicate from note-factory.ts, use import from shared\n6. Run `bun test apps/cli` and `bun test packages/test-utils` to verify\n\n**Parallel safe:** No dependencies on other tasks. Can run in parallel with g6j.7, g6j.8, g6j.9.\n\nFiles: packages/shared/src/content.ts, apps/cli/src/node-builder.ts, packages/test-utils/src/note-factory.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.497212-06:00","updated_at":"2025-12-23T14:02:09.321195-06:00","closed_at":"2025-12-23T14:02:09.321195-06:00","dependencies":[{"issue_id":"scribe-g6j.10","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.497714-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.11","title":"Consolidate desktop logger to extend shared logger","description":"Two separate logger systems with different APIs:\n\nShared (packages/shared/src/logger.ts, 265 lines):\n- Full-featured with child loggers and structured context\n- Uses LOG_LEVEL environment variable\n- API: log.debug('message', { key: value })\n\nDesktop (apps/desktop/electron/main/src/logger.ts, 125 lines):\n- Simpler logger with pre-configured contexts\n- Different API: log.debug('message', value1, value2)\n- Different output format\n\nSolution: Desktop logger should extend or use the shared logger for consistency. This ensures logging behavior is uniform across CLI and desktop.\n\nFiles: apps/desktop/electron/main/src/logger.ts, packages/shared/src/logger.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.580902-06:00","updated_at":"2025-12-23T14:33:38.69032-06:00","closed_at":"2025-12-23T14:33:38.69032-06:00","dependencies":[{"issue_id":"scribe-g6j.11","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.581249-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.12","title":"Migrate test helpers to @scribe/test-utils package","description":"Migrate test helper code from desktop to @scribe/test-utils package.\n\n**BLOCKED BY:** scribe-g6j.7, scribe-g6j.8, scribe-g6j.9 (content function consolidation must complete first)\n\nDesktop (apps/desktop/test-helpers.ts):\n- setupTestContext, cleanupTestContext (lines 54-94)\n- createNoteContent, createNoteWithTitle, createAndIndexNote (lines 163-396)\n- createPersonContent, createDailyContent, createMeetingContent re-exports\n\nTest-utils (packages/test-utils/):\n- vault-factory.ts: createTestVault, cleanupTestVault (lines 76-182)\n- note-factory.ts: createTestNote, createMockNote, createGraphTestNote (lines 343-576)\n\n**Implementation Steps:**\n1. Wait for content function consolidation (g6j.7, g6j.8, g6j.9) to complete\n2. Import consolidated content functions into test-utils from @scribe/shared or templates\n3. Move desktop test helpers that create content to use shared imports\n4. Migrate commonly-used helpers from desktop/test-helpers.ts to @scribe/test-utils\n5. Update desktop integration tests to use @scribe/test-utils\n6. Run all integration tests to verify migration: `bun test apps/desktop`\n\n**UNBLOCKS:** scribe-g6j.32 (test utilities for `as any` elimination)\n\nFiles: apps/desktop/test-helpers.ts, packages/test-utils/src/vault-factory.ts, packages/test-utils/src/note-factory.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.660177-06:00","updated_at":"2025-12-23T14:18:49.872744-06:00","closed_at":"2025-12-23T14:18:49.872744-06:00","dependencies":[{"issue_id":"scribe-g6j.12","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.660589-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.12","depends_on_id":"scribe-g6j.7","type":"blocks","created_at":"2025-12-23T13:33:09.820129-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.12","depends_on_id":"scribe-g6j.8","type":"blocks","created_at":"2025-12-23T13:33:10.759456-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.12","depends_on_id":"scribe-g6j.9","type":"blocks","created_at":"2025-12-23T13:33:11.571243-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.13","title":"Remove unused error type exports (SyncConflictError, MigrationError, etc)","description":"Unused error type exports in packages/shared/src/errors.ts:\n\nNever imported outside test files or exports:\n- SyncConflictError, isSyncConflictError (lines 362-370, 437-439)\n- MigrationError, isMigrationError (lines 375-383, 444-446)\n- TaskNotFoundError, isTaskNotFoundError (lines 352-357, 430-432)\n- isFileSystemError (lines 395-397) - only test file\n- isNoteError (lines 402-404) - only test file\n- isVaultError (lines 409-411) - never imported\n- isEngineError (lines 416-418) - never imported\n- isValidationError (lines 423-425) - only test file\n- getErrorMessageWithContext (lines 506-513) - only test file\n- FileSystemError, NoteError, VaultError, EngineError classes - never imported from package\n\nOptions:\n1. Remove unused exports from barrel\n2. Mark as internal-only\n3. Document as future API\n\nFiles: packages/shared/src/errors.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.743631-06:00","updated_at":"2025-12-23T14:18:13.383099-06:00","closed_at":"2025-12-23T14:18:13.383099-06:00","dependencies":[{"issue_id":"scribe-g6j.13","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.744032-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.14","title":"Remove unused date utility exports (formatDateMMDDYYYY, startOfDay, etc)","description":"Unused date utility exports in packages/shared/src/date-utils.ts:\n\nNever imported anywhere:\n- formatDateMMDDYYYY (lines 108-117)\n- parseDateMMDDYYYY (lines 271-285)\n- startOfDay (lines 409-418)\n- endOfDay (lines 429-438)\n- getDaysBetween (lines 379-394)\n\nThese may be useful future APIs but are currently dead code.\n\nOptions:\n1. Remove from barrel export, keep in file for future use\n2. Remove entirely if not planned\n3. Document as available utilities\n\nFiles: packages/shared/src/date-utils.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.829382-06:00","updated_at":"2025-12-23T14:20:27.944773-06:00","closed_at":"2025-12-23T14:20:27.944773-06:00","dependencies":[{"issue_id":"scribe-g6j.14","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.829781-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.15","title":"Remove unused note type guards (isRegularNote, isProjectNote, etc)","description":"Unused note type guards in packages/shared/src/types/note-types.ts:\n\nNever imported outside the file:\n- isRegularNote (lines 472-474)\n- isProjectNote (lines 516-518)\n- isTemplateNote (lines 538-540)\n- isSystemNote (lines 561-563)\n\nThese type guards are exported but never used in the codebase.\n\nOptions:\n1. Remove from exports if truly unused\n2. Keep if planned for future discriminated union handling\n3. Document intended usage\n\nFiles: packages/shared/src/types/note-types.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.916949-06:00","updated_at":"2025-12-23T14:18:52.980651-06:00","closed_at":"2025-12-23T14:18:52.980651-06:00","dependencies":[{"issue_id":"scribe-g6j.15","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.917414-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.16","title":"Remove deprecated LexicalState and LexicalNode type aliases","description":"Deprecated type aliases still in codebase (packages/shared/src/types/editor-types.ts):\n\n- LexicalState (line 97) - @deprecated, use EditorContent\n- LexicalNode (line 102) - @deprecated, use EditorNode\n\nThese are marked deprecated but still exported. No imports found outside exports.\n\nSolution:\n1. Search for any remaining usages\n2. Remove the deprecated aliases\n3. Update any remaining code to use EditorContent/EditorNode\n\nFiles: packages/shared/src/types/editor-types.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.00205-06:00","updated_at":"2025-12-23T14:09:35.758767-06:00","closed_at":"2025-12-23T14:09:35.758767-06:00","dependencies":[{"issue_id":"scribe-g6j.16","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.002415-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.17","title":"Clean up storage-fs internal exports (NoteValidator, AtomicFileWriter, etc)","description":"Internal utilities exported publicly from storage-fs (packages/storage-fs/src/index.ts):\n\nExported but only used internally or in tests:\n- NoteValidator, INoteValidator, ValidationResult (lines 10-14)\n- AtomicFileWriter, IAtomicFileWriter, AtomicWriteOptions (lines 16-20)\n- NoteMigrator, INoteMigrator, NOTE_FORMAT_VERSION (lines 22-26)\n- QuarantineManager, createQuarantineManager, IQuarantineManager (lines 27-31)\n\nThese are implementation details, not public API. QuarantineManager is accessed via vault method.\n\nSolution: Make these internal-only, remove from barrel export. If external testing needs access, expose via test-utils package instead.\n\nFiles: packages/storage-fs/src/index.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:31.093468-06:00","updated_at":"2025-12-23T14:21:29.36849-06:00","closed_at":"2025-12-23T14:21:29.36849-06:00","dependencies":[{"issue_id":"scribe-g6j.17","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.093871-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.18","title":"Add unit tests for design-system Button primitive","description":"Design system Button primitive has no unit tests.\n\nFile: packages/design-system/src/primitives/Button/Button.tsx\n\nCurrent coverage: 0%\nPackage coverage: 17% overall\n\nTests needed:\n- Render with different variants\n- Click handler invocation\n- Disabled state\n- Loading state (if applicable)\n- Accessibility attributes\n\nFiles: packages/design-system/src/primitives/Button/Button.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.181248-06:00","updated_at":"2025-12-23T13:33:01.52612-06:00","closed_at":"2025-12-23T13:33:01.52612-06:00","dependencies":[{"issue_id":"scribe-g6j.18","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.181637-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.19","title":"Add unit tests for design-system Calendar primitive","description":"Design system Calendar primitive has no unit tests.\n\nFile: packages/design-system/src/primitives/Calendar/Calendar.tsx\n\nCurrent coverage: 0%\nPackage coverage: 17% overall\n\nTests needed:\n- Date selection\n- Month navigation\n- Disabled dates\n- Date range handling\n- Keyboard navigation\n- Accessibility\n\nFiles: packages/design-system/src/primitives/Calendar/Calendar.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.268078-06:00","updated_at":"2025-12-23T13:33:03.131318-06:00","closed_at":"2025-12-23T13:33:03.131318-06:00","dependencies":[{"issue_id":"scribe-g6j.19","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.268425-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.2","title":"Consolidate duplicate note-factory.ts patterns (619 lines)","description":"Consolidate duplicate note-factory.ts patterns (619 lines).\n\nThe note-factory.ts file has 619 lines with significant code duplication between factory functions.\n\n**Duplication pattern:** createTestNote, createMockNote, createGraphTestNote, and createContentTestNote all have nearly identical switch statements for handling note types (daily, meeting, person, etc.).\n\n**Content helpers (lines 109-291):** Should move to separate content-factory.ts or use imports from consolidated content functions (g6j.7, g6j.8, g6j.9).\n\n**BLOCKED BY:** Should wait for g6j.7, g6j.8, g6j.9 to complete so content functions are consolidated first.\n\n**Implementation Steps:**\n1. Wait for content consolidation tasks (g6j.7, g6j.8, g6j.9) to complete\n2. Import createDailyContent, createMeetingContent, createPersonContent from canonical sources\n3. Remove duplicate content creation logic from note-factory.ts\n4. Create a single base factory function with builder pattern\n5. Reduce 4 factory functions to 1 configurable factory OR keep named exports but share implementation\n6. Run `bun test packages/test-utils` to verify\n\n**UNBLOCKS:** scribe-g6j.32 (test utilities for `as any` elimination)\n\nFiles: packages/test-utils/src/note-factory.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:29.851436-06:00","updated_at":"2025-12-23T14:26:53.292548-06:00","closed_at":"2025-12-23T14:26:53.292548-06:00","dependencies":[{"issue_id":"scribe-g6j.2","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:29.851808-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.2","depends_on_id":"scribe-g6j.7","type":"blocks","created_at":"2025-12-23T13:39:06.20779-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.2","depends_on_id":"scribe-g6j.8","type":"blocks","created_at":"2025-12-23T13:39:06.254808-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.2","depends_on_id":"scribe-g6j.9","type":"blocks","created_at":"2025-12-23T13:39:06.299885-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.20","title":"Add unit tests for design-system FloatingMenu primitive","description":"Design system FloatingMenu primitive has no unit tests.\n\nFile: packages/design-system/src/primitives/FloatingMenu/FloatingMenu.tsx (307 lines)\n\nCurrent coverage: 0%\nPackage coverage: 17% overall\n\nThis is one of the larger primitives. Tests needed:\n- Positioning calculations\n- Show/hide behavior\n- Keyboard navigation\n- Click outside handling\n- Anchor element tracking\n\nFiles: packages/design-system/src/primitives/FloatingMenu/FloatingMenu.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.354317-06:00","updated_at":"2025-12-23T13:33:04.669834-06:00","closed_at":"2025-12-23T13:33:04.669834-06:00","dependencies":[{"issue_id":"scribe-g6j.20","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.354648-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.21","title":"Add unit tests for cli-installer.ts (312 lines, complex symlink logic)","description":"Add unit tests for cli-installer.ts (311 lines, complex symlink logic).\n\nFile: apps/desktop/electron/main/src/cli-installer.ts\n\nComplex logic includes:\n- Symlink creation and verification\n- PATH configuration detection (bash, zsh, fish)\n- Existing file handling (overwrite, skip)\n- Error recovery scenarios\n- Multiple file system operations\n- Cross-platform considerations (Darwin)\n\n**Tests needed:**\n- Test symlink creation success/failure\n- Test PATH detection for different shells (~/.zshrc, ~/.bashrc, ~/.config/fish/config.fish)\n- Test existing file handling (overwrite, skip, backup)\n- Mock filesystem operations for isolation\n- Error scenario coverage (permission denied, file exists, etc.)\n- Test uninstall/cleanup logic\n\n**Implementation approach:**\n1. Create `apps/desktop/electron/main/src/cli-installer.test.ts`\n2. Mock `fs` module for file system operations\n3. Mock `child_process` for shell detection\n4. Test each public function in isolation\n5. Test integration scenarios\n\nThis is HIGH PRIORITY - complex logic with file system side effects.\n\n**Parallel safe:** No dependencies on other tasks.\n\nFiles: apps/desktop/electron/main/src/cli-installer.ts, apps/desktop/electron/main/src/cli-installer.test.ts (NEW)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:31.439187-06:00","updated_at":"2025-12-23T14:10:10.331267-06:00","closed_at":"2025-12-23T14:10:10.331267-06:00","dependencies":[{"issue_id":"scribe-g6j.21","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.439552-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.22","title":"Add unit tests for CLI input.ts (stdin/file reading)","description":"CLI input.ts (154 lines) has no tests for stdin/file reading logic.\n\nFile: apps/cli/src/input.ts\n\nComplex logic includes:\n- stdin reading with size limits\n- File input handling\n- Escape sequence processing\n- Error handling for edge cases\n\nTests needed:\n- Test stdin reading\n- Test file reading\n- Test escape sequence processing\n- Test size limit enforcement\n- Test error handling\n\nThis is HIGH PRIORITY - input handling is critical for CLI reliability.\n\n**Parallel safe:** No dependencies on other tasks.\n\nFiles: apps/cli/src/input.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:31.516639-06:00","updated_at":"2025-12-23T14:07:38.7699-06:00","closed_at":"2025-12-23T14:07:38.7699-06:00","dependencies":[{"issue_id":"scribe-g6j.22","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.517013-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.23","title":"Add unit tests for CLI config.ts","description":"CLI config.ts (50 lines) has no tests.\n\nFile: apps/cli/src/config.ts\n\nLogic includes:\n- Configuration file loading\n- JSON parsing error handling\n- Missing config file handling\n\nTests needed:\n- Test config loading success\n- Test malformed JSON handling\n- Test missing config file behavior\n- Test default values\n\n**Parallel safe:** No dependencies on other tasks.\n\nFiles: apps/cli/src/config.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.596928-06:00","updated_at":"2025-12-23T14:10:09.147322-06:00","closed_at":"2025-12-23T14:10:09.147322-06:00","dependencies":[{"issue_id":"scribe-g6j.23","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.597351-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.24","title":"Add unit tests for PersonMentionNode.ts","description":"PersonMentionNode.ts (183 lines) is a Lexical decorator node with no tests.\n\nFile: apps/desktop/renderer/src/components/Editor/plugins/PersonMentionNode.ts\n\nComplex logic includes:\n- Serialization/deserialization\n- Clone operation\n- DOM creation\n- Click handling and navigation\n\nTests needed:\n- Test serialization to JSON\n- Test deserialization from JSON\n- Test clone produces correct copy\n- Test DOM output structure\n- Test click handler navigation\n\nFiles: apps/desktop/renderer/src/components/Editor/plugins/PersonMentionNode.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.673279-06:00","updated_at":"2025-12-23T14:13:43.69751-06:00","closed_at":"2025-12-23T14:13:43.69751-06:00","dependencies":[{"issue_id":"scribe-g6j.24","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.67363-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.25","title":"Add unit tests for InlineLinkNode.ts","description":"InlineLinkNode.ts has no tests.\n\nFile: apps/desktop/renderer/src/components/Editor/plugins/InlineLinkNode.ts\n\nHandles external link rendering and URL validation.\n\nTests needed:\n- Test URL validation\n- Test rendering output\n- Test serialization/deserialization\n- Test link click behavior\n\nFiles: apps/desktop/renderer/src/components/Editor/plugins/InlineLinkNode.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.746966-06:00","updated_at":"2025-12-23T14:15:35.120599-06:00","closed_at":"2025-12-23T14:15:35.120599-06:00","dependencies":[{"issue_id":"scribe-g6j.25","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.750781-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.26","title":"Add unit tests for tasksHandlers.ts toggleChecklistNode logic","description":"tasksHandlers.ts has integration tests but lacks unit tests for the toggleChecklistNode logic.\n\nFile: apps/desktop/electron/main/src/handlers/tasksHandlers.ts\n\nThe toggleChecklistNode function has complex fallback logic for finding and toggling task nodes in the editor state. This deserves isolated unit testing.\n\nTests needed:\n- Test finding checklist node by various identifiers\n- Test toggle behavior (checked -\u003e unchecked, unchecked -\u003e checked)\n- Test fallback logic when node not found\n- Test error handling\n\nFiles: apps/desktop/electron/main/src/handlers/tasksHandlers.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.824093-06:00","updated_at":"2025-12-23T14:25:48.079038-06:00","closed_at":"2025-12-23T14:25:48.079038-06:00","dependencies":[{"issue_id":"scribe-g6j.26","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.824476-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.27","title":"Fix skipped rollback tests in useNoteState.test.ts","description":"Two tests are skipped in useNoteState.test.ts indicating incomplete rollback functionality.\n\nFile: apps/desktop/renderer/src/hooks/useNoteState.test.ts\n\nSkipped tests (lines 473-527):\n1. 'rolls back on save failure (success: false)' (line 475)\n2. 'rolls back on save exception' (line 501)\n\nComment: \"TODO: Fix rollback tests - they have timing issues with hook's ref-based rollback mechanism\"\n\nThis indicates:\n- Rollback functionality may not work correctly\n- Tests have timing issues with ref-based mechanism\n- Technical debt in both implementation and tests\n\nSolution: Fix the underlying rollback implementation, then unskip tests.\n\nFiles: apps/desktop/renderer/src/hooks/useNoteState.test.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.901162-06:00","updated_at":"2025-12-23T14:15:22.124183-06:00","closed_at":"2025-12-23T14:15:22.124183-06:00","dependencies":[{"issue_id":"scribe-g6j.27","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.901532-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.28","title":"Document escapeMarkdownText algorithm in content-extractor.ts","description":"Document escapeMarkdownText algorithm in markdown-escaper.ts.\n\n**BLOCKED BY:** scribe-g6j.1 (refactor content-extractor first - this function will move to markdown-escaper.ts)\n\nThe escapeMarkdownText function (~156 lines, currently lines 247-402) is complex pattern matching without algorithmic documentation.\n\n**Current state:** No high-level comment explaining the algorithm approach, the state machine used for tracking line starts, emphasis characters, etc.\n\nThe function handles:\n- Detecting emphasis patterns (*bold*, _italic_, **strong**, __strong__)\n- Tracking line state (isAtLineStart for # \u003e - + * escaping)\n- Complex character escaping rules for Markdown special chars\n- Table context handling (pipe escaping)\n- Ordered list detection (1. 2. etc.)\n- Link bracket escaping\n\n**Implementation Steps:**\n1. Wait for g6j.1 to complete (function will move to markdown-escaper.ts)\n2. Add JSDoc block comment at function start explaining:\n   - Overall algorithm approach (character-by-character state machine)\n   - State tracking: isAtLineStart, context.isInTable\n   - Key decision points for escaping\n   - Edge cases handled (nested emphasis, line boundaries, mid-word patterns)\n3. Add inline comments for non-obvious patterns\n4. Consider adding ASCII diagrams for complex logic\n\nFiles: packages/shared/src/markdown-escaper.ts (after g6j.1)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:31.984868-06:00","updated_at":"2025-12-23T14:12:49.660642-06:00","closed_at":"2025-12-23T14:12:49.660642-06:00","dependencies":[{"issue_id":"scribe-g6j.28","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:31.985293-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.28","depends_on_id":"scribe-g6j.1","type":"blocks","created_at":"2025-12-23T13:33:08.834167-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.29","title":"Add JSDoc to createCLI function in cli.ts","description":"The createCLI function in cli.ts lacks JSDoc documentation.\n\nFile: apps/cli/src/cli.ts\n\nMissing documentation for:\n- Function purpose\n- Return value (Command object)\n- Available global options\n- Subcommand organization\n- How to extend the CLI\n\nExample JSDoc needed:\n```typescript\n/**\n * Creates and configures the Scribe CLI application.\n * \n * @returns Configured Commander.js Command instance\n * \n * @example\n * const cli = createCLI();\n * cli.parseAsync(process.argv);\n */\n```\n\nFiles: apps/cli/src/cli.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.067917-06:00","updated_at":"2025-12-23T14:28:58.95387-06:00","closed_at":"2025-12-23T14:28:58.95387-06:00","dependencies":[{"issue_id":"scribe-g6j.29","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.068288-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.3","title":"Split TableKeyboardPlugin.tsx into table utility modules","description":"TableKeyboardPlugin.tsx is 515 lines with ~15 internal helper functions for table manipulation.\n\nCurrent structure: All helper functions are internal but could be extracted:\n- tableSelectionUtils.ts - Selection-related helpers ($isSelectionInTable, $getTableCellFromSelection, etc.)\n- tableNavigationUtils.ts - Navigation helpers ($isFirstCellInTable, $isLastCellInTable, $exitTableBefore/After)\n- TableKeyboardPlugin.tsx - Just the React component registering commands\n\nBenefits: Reduces cognitive load when debugging table issues, enables reuse of table utilities.\n\nFiles: apps/desktop/renderer/src/components/Editor/plugins/TableKeyboardPlugin.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:29.926283-06:00","updated_at":"2025-12-23T14:11:01.556072-06:00","closed_at":"2025-12-23T14:11:01.556072-06:00","dependencies":[{"issue_id":"scribe-g6j.3","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:29.926671-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.30","title":"Add JSDoc to createWindow function in main.ts","description":"The createWindow function in main.ts (lines 107-192) is 85 lines with no JSDoc.\n\nFile: apps/desktop/electron/main/src/main.ts\n\nComplex configuration includes:\n- Window dimensions and bounds\n- Preload script path\n- Web preferences (security settings)\n- Context menu setup\n- State restoration\n\nMissing documentation for:\n- Security settings rationale\n- Window configuration choices\n- Context menu behavior\n- State persistence\n\nFiles: apps/desktop/electron/main/src/main.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.149659-06:00","updated_at":"2025-12-23T14:29:06.711179-06:00","closed_at":"2025-12-23T14:29:06.711179-06:00","dependencies":[{"issue_id":"scribe-g6j.30","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.149997-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.31","title":"Document magic numbers in fuzzy-search.ts and hash-utils.ts","description":"Magic numbers in fuzzy-search.ts and hash-utils.ts lack rationale documentation.\n\nfuzzy-search.ts:\n- FUZZY_MATCH_THRESHOLD = 0.3 (why 0.3?)\n- SUBSTRING_MATCH_BASE = 0.9 (why 0.9?)\n- ALL_WORDS_MATCH_SCORE = 0.85 (why 0.85?)\n\nhash-utils.ts:\n- DJB2_HASH_INITIAL = 5381 (why 5381?)\n- DJB2_HASH_MULTIPLIER = 33 (why 33?)\n- TEXT_HASH_LENGTH = 16 (why 16?)\n\nAdd inline comments explaining:\n- Why these specific values were chosen\n- What user testing/research informed the fuzzy search thresholds\n- That 5381 is a prime for good hash distribution\n- That 33 is traditional in DJB2 algorithm\n\nFiles: packages/shared/src/fuzzy-search.ts, packages/shared/src/hash-utils.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.232644-06:00","updated_at":"2025-12-23T14:27:57.539355-06:00","closed_at":"2025-12-23T14:27:57.539355-06:00","dependencies":[{"issue_id":"scribe-g6j.31","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.233034-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.32","title":"Create test utilities to eliminate as any casts in integration tests","description":"Create test utilities to eliminate `as any` casts in integration tests.\n\n**BLOCKED BY:** scribe-g6j.12, scribe-g6j.2 (test infrastructure must be consolidated first)\n\nHigh-priority files with `as any` casts:\n- templates.integration.test.ts (lines 372, 509-510, 522) - child nodes\n- linked-notes.integration.test.ts (lines 145, 333, 648, 688, 789, 860) - paragraph content\n- date-based-mentions.integration.test.ts (lines 226-227, 593-594, 682-683) - timestamp overrides\n- delete-note.integration.test.ts (lines 420, 471) - test data\n- meeting.test.ts (lines 9, 17-18, 26-31, 42) - content types\n\n**Common patterns requiring utilities:**\n1. Timestamp overrides for deterministic testing\n2. Content type coercion for factory functions\n3. Child node access in editor content\n\n**Implementation Steps:**\n1. Wait for g6j.12 (test helpers migration) and g6j.2 (note-factory consolidation)\n2. Add to @scribe/test-utils:\n   - `function createTestNoteWithOverrides\u003cT extends Note\u003e(base: Partial\u003cT\u003e): T`\n   - `function withTimestamp\u003cT\u003e(obj: T, timestamp: number): T \u0026 { createdAt: number; updatedAt: number }`\n   - Generic content builders with proper typing\n3. Update integration tests to use new utilities\n4. Run linter to verify no new `as any` casts remain\n\nFiles: apps/desktop/test-helpers.ts, packages/test-utils/src/note-factory.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:32.311068-06:00","updated_at":"2025-12-23T14:36:39.938629-06:00","closed_at":"2025-12-23T14:36:39.938629-06:00","dependencies":[{"issue_id":"scribe-g6j.32","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.311422-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.32","depends_on_id":"scribe-g6j.12","type":"blocks","created_at":"2025-12-23T13:33:14.797595-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-g6j.32","depends_on_id":"scribe-g6j.2","type":"blocks","created_at":"2025-12-23T13:33:15.622359-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.33","title":"Refactor handlers to use EngineOrchestrator consistently","description":"IPC handlers use inconsistent patterns for accessing engines.\n\nPattern A - Direct vault access (read-only):\n```typescript\nipcMain.handle('notes:list', async () =\u003e {\n  const vault = requireVault(deps);\n  return vault.list();\n});\n```\n\nPattern B - Using withEngines helper (write operations):\n```typescript\nipcMain.handle('notes:save', withEngines(deps, async (engines, note) =\u003e {...}));\n```\n\nThe EngineOrchestrator (apps/desktop/electron/main/src/EngineOrchestrator.ts) exists but isn't used consistently in all handlers.\n\nSolution:\n1. Document the intentional difference between patterns in code comments\n2. Refactor write operations to use EngineOrchestrator consistently\n3. Add CONTRIBUTING.md documentation for when to use each pattern\n\nFiles: apps/desktop/electron/main/src/handlers/notesHandlers.ts, apps/desktop/electron/main/src/EngineOrchestrator.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:32.38807-06:00","updated_at":"2025-12-23T14:27:32.742682-06:00","closed_at":"2025-12-23T14:27:32.742682-06:00","dependencies":[{"issue_id":"scribe-g6j.33","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.388416-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.34","title":"Convert remaining Promise .then()/.catch() to async/await","description":"Legacy Promise .then()/.catch() patterns should be converted to async/await.\n\nLocations:\n1. packages/engine-core/src/task-index.ts line 206:\n   this.persist().catch((err) =\u003e {...})\n\n2. packages/test-utils/src/vault-factory.ts lines 98, 179:\n   .catch(() =\u003e {}) for cleanup\n\n3. apps/cli/src/index.ts line 16:\n   cli.parseAsync(process.argv).catch(...)\n\n4. apps/desktop/electron/main/src/main.ts line 194:\n   app.whenReady().then(async () =\u003e {...})\n\nThe app.whenReady().then() is borderline acceptable for entry point code, but the others should use try/catch with async/await for consistency.\n\nFiles: packages/engine-core/src/task-index.ts, apps/desktop/electron/main/src/main.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:32.461623-06:00","updated_at":"2025-12-23T14:30:04.344281-06:00","closed_at":"2025-12-23T14:30:04.344281-06:00","dependencies":[{"issue_id":"scribe-g6j.34","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:32.461959-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.4","title":"Extract autocomplete hooks into separate files","description":"useTriggerableAutocomplete.ts is 498 lines with three hooks in one file:\n1. useTriggerableAutocomplete - Main hook for wiki-links [[  and mentions @\n2. useAutocompleteKeyboardNavigation - Keyboard navigation\n3. useClickOutside - Generic click outside detection\n\nProposed split:\n- useTriggerableAutocomplete.ts - Main hook only\n- useAutocompleteKeyboard.ts - Keyboard navigation hook\n- useClickOutside.ts - Generic reusable click outside hook\n\nThe useClickOutside hook is generic and could be reused elsewhere in the codebase.\n\nFiles: apps/desktop/renderer/src/components/Editor/hooks/useTriggerableAutocomplete.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T13:26:30.000154-06:00","updated_at":"2025-12-23T14:32:47.050644-06:00","closed_at":"2025-12-23T14:32:47.050644-06:00","dependencies":[{"issue_id":"scribe-g6j.4","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.000698-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.5","title":"Merge CLI ErrorCode enum into shared package","description":"Merge CLI ErrorCode enum into shared package.\n\nTwo separate ErrorCode enums exist with overlapping codes:\n\n**CLI (apps/cli/src/errors.ts) - 7 codes:**\n- INTERNAL_ERROR, VAULT_NOT_FOUND, NOTE_NOT_FOUND\n- INVALID_INPUT, WRITE_FAILED, PERMISSION_DENIED, HAS_BACKLINKS\n\n**Shared (packages/shared/src/errors.ts) - 20+ codes:**\n- FILE_NOT_FOUND, FILE_READ_ERROR, FILE_WRITE_ERROR...\n- NOTE_NOT_FOUND (duplicate!), INVALID_NOTE_FORMAT, NOTE_CORRUPT\n- VAULT_NOT_INITIALIZED, VALIDATION_ERROR, etc.\n\n**Implementation Steps:**\n1. Add CLI-specific codes to shared ErrorCode enum:\n   - INTERNAL_ERROR (if not present)\n   - HAS_BACKLINKS\n   - VAULT_NOT_FOUND (map to VAULT_NOT_INITIALIZED or add)\n2. Update CLI to import ErrorCode from @scribe/shared\n3. CLIError can extend ScribeError or use shared codes\n4. Update EXIT_CODES mapping in CLI to use shared codes\n5. Remove duplicate enum from apps/cli/src/errors.ts\n6. Run `bun test apps/cli` to verify\n\n**Parallel safe:** No dependencies on other tasks.\n\nFiles: apps/cli/src/errors.ts, packages/shared/src/errors.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:30.076838-06:00","updated_at":"2025-12-23T13:58:11.749827-06:00","closed_at":"2025-12-23T13:58:11.749827-06:00","dependencies":[{"issue_id":"scribe-g6j.5","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.077178-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.6","title":"Consolidate wrapError function into shared handler utilities","description":"Consolidate wrapError function into shared handler utilities.\n\nIdentical wrapError function duplicated in two handler files:\n\n**notesHandlers.ts (lines 52-59):**\n```typescript\nfunction wrapError(error: unknown): never {\n  if (error instanceof ScribeError) {\n    const userError = new Error(error.getUserMessage());\n    userError.name = error.code;\n    throw userError;\n  }\n  throw error;\n}\n```\n\n**peopleHandlers.ts (lines 43-50):** Identical implementation\n\n**Implementation Steps:**\n1. Add wrapError to `apps/desktop/electron/main/src/handlers/types.ts`\n2. Export from types.ts alongside requireVault, withEngines, etc.\n3. Update notesHandlers.ts to import wrapError from './types'\n4. Update peopleHandlers.ts to import wrapError from './types'\n5. Remove local wrapError definitions\n6. Search for other handlers that might benefit (meetingHandlers, dailyHandlers)\n7. Run `bun test apps/desktop` to verify\n\n**Parallel safe:** No dependencies on other tasks.\n\nFiles: apps/desktop/electron/main/src/handlers/notesHandlers.ts, apps/desktop/electron/main/src/handlers/peopleHandlers.ts, apps/desktop/electron/main/src/handlers/types.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.15794-06:00","updated_at":"2025-12-23T13:55:51.289724-06:00","closed_at":"2025-12-23T13:55:51.289724-06:00","dependencies":[{"issue_id":"scribe-g6j.6","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.158313-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.7","title":"Consolidate createDailyContent into single source of truth","description":"Consolidate createDailyContent into single source of truth.\n\ncreateDailyContent function is duplicated in 6+ locations with identical logic:\n\n1. `apps/desktop/renderer/src/templates/daily.ts` (lines 10-40) - **Canonical source (already exists!)**\n2. `apps/desktop/electron/main/src/handlers/dailyHandlers.ts` (lines 51-81) - DUPLICATE\n3. `apps/desktop/daily-handlers.integration.test.ts` (lines 31-68) - DUPLICATE\n4. `apps/desktop/meeting-handlers.integration.test.ts` (lines 34-67) - DUPLICATE\n5. `apps/desktop/date-based-meeting.integration.test.ts` (lines 30-63) - DUPLICATE\n6. `apps/desktop/templates.integration.test.ts` (lines 37-72) - DUPLICATE\n\n**Key insight:** The canonical source already exists at `apps/desktop/renderer/src/templates/daily.ts` and is exported!\n\n**Implementation Steps:**\n1. Update `dailyHandlers.ts` to import createDailyContent from `../../renderer/src/templates/daily.ts`\n2. Remove local createDailyContent definition from dailyHandlers.ts (keep the export)\n3. Update integration tests to import from canonical source OR use test-helpers\n4. Add re-export to test-helpers.ts: `export { createDailyContent } from './renderer/src/templates/daily';`\n5. Update test imports to use test-helpers\n6. Run `bun test apps/desktop` to verify all tests pass\n\n**Parallel safe:** Runs in parallel with g6j.8 and g6j.9.\n\n**UNBLOCKS:** scribe-g6j.12 (test helpers migration)\n\nFiles: apps/desktop/renderer/src/templates/daily.ts, apps/desktop/electron/main/src/handlers/dailyHandlers.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:30.239801-06:00","updated_at":"2025-12-23T13:47:23.911245-06:00","closed_at":"2025-12-23T13:47:23.911245-06:00","dependencies":[{"issue_id":"scribe-g6j.7","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.24019-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.8","title":"Consolidate createMeetingContent into single source of truth","description":"Consolidate createMeetingContent into single source of truth.\n\ncreateMeetingContent function duplicated in 5+ locations:\n\n1. `apps/desktop/renderer/src/templates/meeting.ts` (lines 52-70) - **Canonical source (already exists!)**\n2. `apps/desktop/electron/main/src/handlers/meetingHandlers.ts` (lines 54-104) - DUPLICATE\n3. `apps/desktop/meeting-handlers.integration.test.ts` (lines 69-103) - DUPLICATE\n4. `apps/desktop/date-based-meeting.integration.test.ts` (lines 65-100) - DUPLICATE\n5. `apps/desktop/templates.integration.test.ts` (lines 73-108) - DUPLICATE\n\n**Key insight:** The canonical source already exists at `apps/desktop/renderer/src/templates/meeting.ts`!\n\n**Implementation Steps:**\n1. Update `meetingHandlers.ts` to import createMeetingContent from `../../renderer/src/templates/meeting.ts`\n2. Remove local createMeetingContent definition from meetingHandlers.ts\n3. Add re-export to test-helpers.ts: `export { createMeetingContent } from './renderer/src/templates/meeting';`\n4. Update test imports to use test-helpers\n5. Run `bun test apps/desktop` to verify all tests pass\n\n**Parallel safe:** Runs in parallel with g6j.7 and g6j.9.\n\n**UNBLOCKS:** scribe-g6j.12 (test helpers migration)\n\nFiles: apps/desktop/renderer/src/templates/meeting.ts, apps/desktop/electron/main/src/handlers/meetingHandlers.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T13:26:30.325653-06:00","updated_at":"2025-12-23T13:51:23.868306-06:00","closed_at":"2025-12-23T13:51:23.868306-06:00","dependencies":[{"issue_id":"scribe-g6j.8","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.326044-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-g6j.9","title":"Consolidate createPersonContent into single source of truth","description":"Consolidate createPersonContent into single source of truth.\n\n**IMPORTANT:** No person template file exists yet! This task should CREATE the canonical source.\n\nCurrent locations:\n1. apps/desktop/test-helpers.ts (lines 237-255) - Used by tests\n2. apps/desktop/electron/main/src/handlers/peopleHandlers.ts (lines 63-92) - Used at runtime\n3. apps/desktop/people-handlers.integration.test.ts (as createPersonContentInternal, lines 34-56)\n\n**Implementation Steps:**\n1. Create `apps/desktop/renderer/src/templates/person.ts` (canonical source like daily.ts/meeting.ts)\n2. Export `createPersonContent(name: string): EditorContent \u0026 { type: 'person' }`\n3. Add to `apps/desktop/renderer/src/templates/index.ts` exports\n4. Update `peopleHandlers.ts` to import from templates/person.ts\n5. Update `test-helpers.ts` to re-export from templates/person.ts\n6. Remove createPersonContentInternal from integration tests, use canonical import\n7. Run `bun test apps/desktop` to verify all tests pass\n\n**Parallel safe:** Runs in parallel with g6j.7 and g6j.8.\n\n**UNBLOCKS:** scribe-g6j.12 (test helpers migration)\n\nFiles: apps/desktop/renderer/src/templates/person.ts (NEW), apps/desktop/electron/main/src/handlers/peopleHandlers.ts, apps/desktop/test-helpers.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T13:26:30.409757-06:00","updated_at":"2025-12-23T13:53:31.787659-06:00","closed_at":"2025-12-23T13:53:31.787659-06:00","dependencies":[{"issue_id":"scribe-g6j.9","depends_on_id":"scribe-g6j","type":"parent-child","created_at":"2025-12-23T13:26:30.410158-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-lg3","title":"Remove dead TableKeyboardPlugin.tsx from plugins/ directory","description":"The old 516-line TableKeyboardPlugin.tsx in plugins/ directory is dead code. The refactored version lives in plugins/table/ and is already being used by EditorRoot.tsx. Safe to delete the old file.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T14:11:12.453197-06:00","updated_at":"2025-12-23T14:11:43.259697-06:00","closed_at":"2025-12-23T14:11:43.259697-06:00"}
{"id":"scribe-p2d","title":"Tech Debt Remediation: GH Issue #52 - Comprehensive Cleanup","description":"# Tech Debt Remediation Epic (GitHub Issue #52)\n\n## Executive Summary\n\nThis epic captures the comprehensive tech debt analysis from GitHub Issue #52. The work is organized into 5 sprints with clear dependency chains, enabling maximum parallelization while respecting logical ordering constraints.\n\n---\n\n## 🔄 REVISION LOG (Dec 25, 2025)\n\n### Changes After Plan Review\n1. **scribe-p2d.8 UPDATED**: NoteHeader uses date-fns PARSING, not just formatting - more complex task\n2. **scribe-p2d.14 DOWNGRADED to P3**: Test utility refactoring has poor effort/value ratio\n3. **scribe-p2d.16 DOWNGRADED to P3**: Type-only file, GH issue says \"keep as-is\" for similar files  \n4. **scribe-p2d.17 CLOSED**: metadata.title isn't deprecated - was a misread of GH issue comments\n\n### Active Task Count\n- **P1 (Critical)**: 12 tasks (was 13, .17 closed)\n- **P2 (Medium)**: 2 tasks (was 4, .14 and .16 downgraded)\n- **P3 (Low)**: 4 tasks (was 2, .14 and .16 added)\n\n---\n\n## ⚠️ IMPORTANT: Pre-Implementation Notes\n\n### For Test Tasks (scribe-p2d.1 through .5)\n**Before writing new tests, check existing coverage!**\n\nA 1896-line `content-extractor.test.ts` exists and may test these modules indirectly. Run:\n```bash\nbun test packages/shared --coverage | grep -E 'block-converters|inline-converters|markdown-escaper|content|frontmatter'\n```\n\nFocus on **gap-filling** rather than duplicating existing tests.\n\n### For Date Deduplication (scribe-p2d.6 through .8)\n**Complete scribe-p2d.9 FIRST** - it verifies the shared date-utils API covers all consumer needs.\n\n**⚠️ scribe-p2d.8 is more complex than .6/.7** - NoteHeader uses date-fns parsing, not just formatting!\n\n### Closed/Merged Beads\n- **scribe-p2d.13**: CLOSED - storage.ts already uses structured logger\n- **scribe-p2d.17**: CLOSED - metadata.title isn't actually deprecated\n- **scribe-p2d.20, .21**: MERGED into scribe-p2d.19 (combined JSDoc task)\n\n---\n\n## Strategic Context\n\n### Why This Matters\n\nScribe is a note-taking application built on Electron + React with a Lexical editor. The codebase has grown to include:\n- **@scribe/shared**: Core types, utilities, content conversion (the \"crown jewels\")\n- **@scribe/engine-core**: Note indexing, task management, graph relationships\n- **@scribe/storage-fs**: File system vault operations, migrations\n- **@scribe/design-system**: UI primitives and theming\n- **apps/desktop**: Electron desktop application\n- **apps/cli**: Command-line interface for power users\n\nThe tech debt identified threatens:\n1. **Data Integrity**: Untested content conversion modules handle user notes\n2. **Maintainability**: Duplicate code across 4+ locations for date formatting\n3. **Debuggability**: Production code using console.* instead of structured logger\n\n### Risk Assessment\n\n| Category | Risk Level | Impact |\n|----------|------------|--------|\n| Missing test coverage on content modules | **CRITICAL** | Data corruption during export |\n| Duplicate date formatting | MEDIUM | Inconsistent UX, maintenance burden |\n| Console usage in prod | MEDIUM | Logs lost, no log levels |\n| Large files | LOW | Developer friction only |\n\n## Dependency Graph Overview (UPDATED)\n\n```\nSPRINT 1 (Wave 1 - Start Here):\n├── scribe-p2d.9: Verify date-utils exports (DO THIS FIRST)\n│   └── Blocks: .6, .7, .8\n│\n├── Test Coverage Tasks (5 parallel tasks)\n│   ├── .1: block-converters.ts tests\n│   ├── .2: inline-converters.ts tests  \n│   ├── .3: markdown-escaper.ts tests\n│   ├── .4: content.ts tests\n│   └── .5: frontmatter.ts tests\n│\n└── Date Deduplication Tasks (after .9 completes)\n    ├── .6: Remove from CLI output.ts (simple)\n    ├── .7: Remove from CLI daily.ts (simple)\n    └── .8: Remove from NoteHeader.tsx (COMPLEX - has parsing)\n\nSPRINT 2 (Wave 2 - Logger Migration):\n├── .10: useVaultPath.ts → structured logger\n├── .11: auto-updater.ts → structured logger\n└── .12: search-engine.ts → structured logger\n\nSPRINT 3 (Wave 3 - Refactoring):\n└── .15: Extract validation/locking from storage.ts\n    (Note: .14 and .16 are now P3 - defer)\n\nSPRINT 4 (Wave 4 - Deprecated Code):\n└── .18: Remove deprecated TaskIndex constructor\n    (Note: .17 CLOSED - not actually deprecated)\n\nSPRINT 5 (Wave 5 - Documentation):\n├── .19: JSDoc for block/inline/frontmatter (MERGED)\n└── .22: Document swallowed promises\n```\n\n## Success Metrics\n\n- [ ] All 5 content modules have \u003e80% test coverage\n- [ ] Zero duplicate date formatting functions\n- [ ] Console usage reduced by 50%+ in production code\n- [ ] Deprecated TaskIndex constructor removed\n\n## Sprint Allocation (Updated)\n\n| Sprint | Focus | Active Tasks | Notes |\n|--------|-------|--------------|-------|\n| 1 | Critical Tests + Dedup | 9 tasks | Start with .9 |\n| 2 | Logger Migration | 3 tasks | .13 was already closed |\n| 3 | Refactoring | 1 task | .14, .16 deferred to P3 |\n| 4 | Deprecated | 1 task | .17 closed |\n| 5 | Documentation | 2 tasks | .19 is merged |\n\n## Labels\n\n- tech-debt\n- maintenance  \n- testing\n- refactoring\n- GH-52","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-25T22:18:32.38643-06:00","updated_at":"2025-12-25T22:45:01.568799-06:00"}
{"id":"scribe-p2d.1","title":"[Sprint 1.1] Add comprehensive tests for block-converters.ts","description":"# Add Comprehensive Tests for block-converters.ts\n\n## File Under Test\n`packages/shared/src/block-converters.ts` (357 lines)\n\n## Strategic Context\n\n### Why This is Critical (P1)\nThis module performs **AST transformations** for markdown export - converting Lexical editor nodes to Markdown format. If this code has bugs:\n- User notes could be **corrupted** during export\n- Data could be **lost** or malformed when sharing notes\n- Users lose trust in the application's data integrity\n\n### What This Module Does\nBlock-level node conversion handles:\n- **Headings**: `# H1`, `## H2`, etc. (up to H6)\n- **Paragraphs**: Plain text with inline formatting\n- **Lists**: Ordered (`1.`), unordered (`-`), and checklists (`- [ ]`)\n- **Code blocks**: Fenced code with language hints\n- **Tables**: Complex multi-row, multi-column structures\n- **Blockquotes**: `\u003e ` prefixed content\n- **Horizontal rules**: `---`\n\n### Current State\n- **Lines of code**: 357\n- **Test coverage**: 0% direct tests (but see verification step)\n- **Complexity**: HIGH (recursive AST traversal, context-sensitive output)\n\n---\n\n## IMPORTANT: Pre-Implementation Verification\n\n**Before writing new tests, check existing coverage!**\n\nThere's a 62KB `content-extractor.test.ts` that may already test block-converters indirectly.\n\n```bash\n# Check if block-converters is tested via integration\ngrep -l \"block-converter\\|headingToMarkdown\\|listToMarkdown\" packages/shared/src/*.test.ts\n\n# Check current coverage\nbun test packages/shared --coverage | grep block-converters\n\n# Review content-extractor tests for overlap\ngrep -n \"heading\\|list\\|table\\|code\" packages/shared/src/content-extractor.test.ts | head -30\n```\n\nIf significant coverage already exists, focus on **gap-filling** rather than duplicating tests.\n\n---\n\n## Implementation Plan\n\n### Test Categories\n\n#### 1. Heading Conversion Tests\n```typescript\ndescribe('headingToMarkdown', () =\u003e {\n  it('converts h1 to single #', () =\u003e {});\n  it('converts h2-h6 with correct # count', () =\u003e {});\n  it('preserves inline formatting in headings', () =\u003e {});\n  it('handles empty heading content', () =\u003e {});\n});\n```\n\n#### 2. Paragraph Conversion Tests\n```typescript\ndescribe('paragraphToMarkdown', () =\u003e {\n  it('converts plain text paragraphs', () =\u003e {});\n  it('preserves bold/italic inline formatting', () =\u003e {});\n  it('handles mixed inline styles', () =\u003e {});\n  it('escapes special markdown characters', () =\u003e {});\n});\n```\n\n#### 3. List Conversion Tests\n```typescript\ndescribe('listToMarkdown', () =\u003e {\n  describe('unordered lists', () =\u003e {\n    it('converts single-item list', () =\u003e {});\n    it('converts multi-item list', () =\u003e {});\n    it('handles nested lists (2 levels)', () =\u003e {});\n    it('handles deeply nested lists (3+ levels)', () =\u003e {});\n  });\n  \n  describe('ordered lists', () =\u003e {\n    it('numbers items sequentially', () =\u003e {});\n    it('handles nested ordered lists', () =\u003e {});\n    it('handles mixed ordered/unordered nesting', () =\u003e {});\n  });\n  \n  describe('checklists', () =\u003e {\n    it('renders unchecked as [ ]', () =\u003e {});\n    it('renders checked as [x]', () =\u003e {});\n    it('preserves checklist content', () =\u003e {});\n  });\n});\n```\n\n#### 4. Code Block Tests\n```typescript\ndescribe('codeBlockToMarkdown', () =\u003e {\n  it('wraps in triple backticks', () =\u003e {});\n  it('includes language identifier', () =\u003e {});\n  it('preserves code indentation', () =\u003e {});\n  it('handles empty code blocks', () =\u003e {});\n  it('handles special characters in code', () =\u003e {});\n});\n```\n\n#### 5. Table Conversion Tests\n```typescript\ndescribe('tableToMarkdown', () =\u003e {\n  it('converts simple 2x2 table', () =\u003e {});\n  it('handles header row with separator', () =\u003e {});\n  it('escapes pipe characters in cells', () =\u003e {});\n  it('handles empty cells', () =\u003e {});\n  it('aligns multi-column tables', () =\u003e {});\n});\n```\n\n#### 6. Edge Cases\n```typescript\ndescribe('edge cases', () =\u003e {\n  it('handles deeply nested structures', () =\u003e {});\n  it('handles empty block nodes', () =\u003e {});\n  it('handles malformed input gracefully', () =\u003e {});\n  it('maintains paragraph spacing', () =\u003e {});\n});\n```\n\n### Test Data Strategy\n- Create snapshot tests for complex conversions\n- Use property-based testing for escaping logic\n- Test round-trip where possible (markdown → lexical → markdown)\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/block-converters.test.ts` | CREATE |\n| `packages/shared/src/__fixtures__/block-samples.ts` | CREATE (test fixtures) |\n\n## Verification\n\n```bash\n# Run tests\nbun test packages/shared/src/block-converters.test.ts\n\n# Check coverage\nbun test packages/shared --coverage | grep block-converters\n\n# Target: \u003e80% line coverage\n```\n\n## Success Criteria\n- [ ] Pre-implementation coverage check completed\n- [ ] All test categories implemented (or documented as covered elsewhere)\n- [ ] Coverage \u003e80% for block-converters.ts\n- [ ] No snapshot failures\n- [ ] All edge cases documented with tests\n\n## Dependencies\n- **Blocks**: scribe-p2d.19 (JSDoc docs should come after tests)\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Medium (3-4 hours)\n- **Risk**: Low (pure functions, no side effects)\n\n## Labels\n- testing\n- sprint-1\n- P1-critical\n- content-safety","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:19:01.243168-06:00","updated_at":"2025-12-25T22:52:27.755692-06:00","closed_at":"2025-12-25T22:52:27.755692-06:00","dependencies":[{"issue_id":"scribe-p2d.1","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:19:01.243552-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.10","title":"[Sprint 2.1] Replace console usage in useVaultPath.ts with structured logger","description":"# Replace Console Usage in useVaultPath.ts\n\n## Problem Statement\n`apps/desktop/renderer/src/hooks/useVaultPath.ts` contains 4 instances of `console.*` that should use the structured logger from `@scribe/shared`.\n\n## Why This Matters\n\n### Production Visibility\nConsole logs in production:\n- Are not captured by Electron's crash reporting\n- Have no log levels (can't filter debug vs error)\n- Are lost when the app closes\n- Don't include structured context\n\n### Debugging Difficulty\nWithout structured logging:\n- Can't filter by severity\n- Can't add context (vault path, user action)\n- Can't aggregate across sessions\n\n## Current Console Usage\n\n```typescript\n// apps/desktop/renderer/src/hooks/useVaultPath.ts\nconsole.log('Loading vault path...');           // Line ~X\nconsole.error('Failed to load vault:', err);    // Line ~Y\nconsole.warn('Vault path not found');           // Line ~Z\nconsole.debug('Vault path resolved:', path);    // Line ~W\n```\n\n## Target Implementation\n\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('useVaultPath');\n\n// Replace console.log with log.info or log.debug\nlog.debug('Loading vault path...');\n\n// Replace console.error with log.error (includes stack trace)\nlog.error('Failed to load vault', { error: err.message, stack: err.stack });\n\n// Replace console.warn with log.warn\nlog.warn('Vault path not found', { defaultPath: defaultVaultPath });\n\n// Replace console.debug with log.debug\nlog.debug('Vault path resolved', { path });\n```\n\n## Implementation Plan\n\n### Step 1: Add Logger Import\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('useVaultPath');\n```\n\n### Step 2: Replace Each Console Call\nMap console methods to logger methods:\n| Console | Logger | Notes |\n|---------|--------|-------|\n| `console.log` | `log.info` or `log.debug` | Use debug for verbose |\n| `console.error` | `log.error` | Add error context |\n| `console.warn` | `log.warn` | Add relevant context |\n| `console.debug` | `log.debug` | Already debug level |\n\n### Step 3: Add Structured Context\nDon't just replace text, add structured data:\n```typescript\n// Before\nconsole.error('Failed:', err);\n\n// After\nlog.error('Vault load failed', { \n  error: err.message,\n  vaultPath: attemptedPath,\n  action: 'loadVaultPath'\n});\n```\n\n### Step 4: Test Logging Output\n```bash\n# Set log level to debug\nLOG_LEVEL=debug bun run dev:desktop\n\n# Verify logs appear with correct format\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `apps/desktop/renderer/src/hooks/useVaultPath.ts` | Replace console with logger |\n\n## Verification\n\n```bash\n# Ensure no console usage remains\ngrep -n \"console\\.\" apps/desktop/renderer/src/hooks/useVaultPath.ts\n\n# Should return empty or only eslint-disable comments\n\n# Run tests\nbun test apps/desktop\n```\n\n## Success Criteria\n- [ ] All console calls replaced with structured logger\n- [ ] Logger creates with appropriate namespace\n- [ ] Structured context added to log calls\n- [ ] Tests pass\n- [ ] Log output verified in dev mode\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: None (Sprint 1 tests can run in parallel)\n\n## Estimated Effort\n- **Size**: Small (30-45 minutes)\n- **Risk**: Low\n\n## Labels\n- refactoring\n- sprint-2\n- P1-high\n- logging\n- desktop","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:22:28.477957-06:00","updated_at":"2025-12-25T22:53:00.734715-06:00","closed_at":"2025-12-25T22:53:00.734715-06:00","dependencies":[{"issue_id":"scribe-p2d.10","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:22:28.478282-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.11","title":"[Sprint 2.2] Replace console usage in auto-updater.ts with structured logger","description":"# Replace Console Usage in auto-updater.ts\n\n## Problem Statement\n`apps/desktop/electron/main/src/auto-updater.ts` contains 4 instances of `console.*` for logging update events. This should use structured logging for better production debugging.\n\n## Why Auto-Updater Logging is Critical\n\n### Update Failures are Invisible\nIf an auto-update fails, users don't know why. With console.log:\n- Logs are lost after app restart\n- No way to diagnose \"update stuck\" issues\n- No telemetry on update success rates\n\n### User Support\nWhen users report \"app won't update\", we need:\n- What version they're on\n- What version was available\n- Where in the update flow it failed\n- What error occurred\n\n## Current Console Usage\n\n```typescript\n// apps/desktop/electron/main/src/auto-updater.ts\nconsole.log('Checking for updates...');\nconsole.log('Update available:', info);\nconsole.error('Update error:', err);\nconsole.log('Download progress:', percent);\n```\n\n## Target Implementation\n\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('auto-updater');\n\nlog.info('Checking for updates', { \n  currentVersion: app.getVersion(),\n  channel: updateChannel \n});\n\nlog.info('Update available', { \n  version: info.version,\n  releaseDate: info.releaseDate,\n  releaseNotes: info.releaseNotes?.slice(0, 100) // truncate for logging\n});\n\nlog.error('Update check failed', { \n  error: err.message,\n  code: err.code,\n  currentVersion: app.getVersion()\n});\n\nlog.debug('Download progress', { \n  percent: percent.toFixed(1),\n  bytesPerSecond: speed,\n  transferred: transferred,\n  total: total\n});\n```\n\n## Implementation Plan\n\n### Step 1: Add Logger Import\nThe main process already has access to @scribe/shared:\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('auto-updater');\n```\n\n### Step 2: Map Update Events to Log Levels\n\n| Event | Level | Rationale |\n|-------|-------|-----------|\n| checking-for-update | info | User-facing milestone |\n| update-available | info | Important event |\n| update-not-available | debug | Normal operation |\n| download-progress | debug | Verbose, frequent |\n| update-downloaded | info | Important milestone |\n| error | error | Always log errors |\n\n### Step 3: Add Structured Context\nInclude version info, timing, and error details in every log.\n\n### Step 4: Consider File Logging\nFor auto-updater specifically, consider persisting logs:\n```typescript\n// Future enhancement: write update logs to file\n// ~/.scribe/logs/updates.log\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `apps/desktop/electron/main/src/auto-updater.ts` | Replace console with logger |\n\n## Verification\n\n```bash\n# Ensure no console usage remains\ngrep -n \"console\\.\" apps/desktop/electron/main/src/auto-updater.ts\n\n# Run the app and trigger update check\nbun run dev:desktop\n# Check for updates manually via menu\n```\n\n## Success Criteria\n- [ ] All console calls replaced with structured logger\n- [ ] Update events logged with appropriate levels\n- [ ] Version context included in all logs\n- [ ] Error logs include full error details\n- [ ] Tests pass\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small (30-45 minutes)\n- **Risk**: Low\n\n## Labels\n- refactoring\n- sprint-2\n- P1-high\n- logging\n- desktop\n- auto-update","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:22:45.781765-06:00","updated_at":"2025-12-25T22:54:10.078106-06:00","closed_at":"2025-12-25T22:54:10.078106-06:00","dependencies":[{"issue_id":"scribe-p2d.11","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:22:45.782113-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.12","title":"[Sprint 2.3] Complete TODO: Migrate search-engine.ts to structured logger","description":"# Complete TODO: Migrate search-engine.ts to Structured Logger\n\n## Problem Statement\n`packages/engine-search/src/search-engine.ts` has a TODO comment and eslint-disable for console usage that needs to be addressed:\n\n```typescript\n// eslint-disable-next-line no-console -- TODO: Migrate to logger\nconsole.log('Search index rebuilt');\n```\n\n## Context\n\n### Why Search Engine Logging Matters\nThe search engine is a core component that:\n- Indexes all notes for full-text search\n- Rebuilds indexes on vault changes\n- Can be slow on large vaults\n\nStructured logging helps:\n- Track indexing performance\n- Debug search result issues\n- Monitor index health\n\n### Current State\n- 2 instances of console usage\n- Has eslint-disable comments with TODO\n- Acknowledged as tech debt in the codebase\n\n## Target Implementation\n\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('search-engine');\n\n// Replace index rebuild logging\nlog.info('Search index rebuilt', {\n  noteCount: indexedNotes.length,\n  durationMs: endTime - startTime,\n  vaultPath: vault.path\n});\n\n// Replace search logging (if debug-level)\nlog.debug('Search executed', {\n  query: query.slice(0, 50), // truncate for privacy\n  resultCount: results.length,\n  durationMs: searchTime\n});\n```\n\n## Implementation Plan\n\n### Step 1: Add Logger Import\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('search-engine');\n```\n\n### Step 2: Replace Console Calls\nFind and replace each console usage with appropriate log level.\n\n### Step 3: Remove ESLint Disables\nAfter migration, remove the eslint-disable comments.\n\n### Step 4: Add Performance Metrics\nSince search performance matters, include timing:\n```typescript\nconst start = performance.now();\n// ... indexing logic\nconst duration = performance.now() - start;\nlog.info('Index rebuilt', { durationMs: duration.toFixed(2) });\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `packages/engine-search/src/search-engine.ts` | Replace console, remove disables |\n\n## Verification\n\n```bash\n# Ensure no console usage or eslint-disable for it\ngrep -n \"console\\.\\|no-console\" packages/engine-search/src/search-engine.ts\n\n# Run tests\nbun test packages/engine-search\n\n# Run full test suite to catch regressions\nbun test\n```\n\n## Success Criteria\n- [ ] All console calls replaced\n- [ ] ESLint disable comments removed\n- [ ] Performance metrics included\n- [ ] Tests pass\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small (20-30 minutes)\n- **Risk**: Low\n\n## Labels\n- refactoring\n- sprint-2\n- P1-high\n- logging\n- search\n- tech-debt-acknowledged","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:22:59.956157-06:00","updated_at":"2025-12-25T22:54:55.098577-06:00","closed_at":"2025-12-25T22:54:55.098577-06:00","dependencies":[{"issue_id":"scribe-p2d.12","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:22:59.956539-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.13","title":"[Sprint 2.4] Add structured logging to storage.ts where appropriate","description":"# Add Structured Logging to storage.ts\n\n## Problem Statement\n`packages/storage-fs/src/storage.ts` has 4 instances of console usage for logging file system operations. These should use structured logging for better debugging.\n\n## Context\n\n### Storage Layer Criticality\nThe storage layer handles:\n- Reading/writing note files\n- File locking for concurrent access\n- Migrations between format versions\n- Atomic writes to prevent corruption\n\nFailures here can cause **data loss**. Good logging is essential.\n\n### Current Console Usage\n```typescript\nconsole.log('Writing note:', noteId);\nconsole.error('Write failed:', error);\nconsole.warn('Lock timeout, retrying...');\nconsole.log('Migration complete');\n```\n\n## Target Implementation\n\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('storage-fs');\n\n// File operations\nlog.debug('Writing note', { \n  noteId, \n  path: notePath,\n  sizeBytes: content.length \n});\n\n// Errors with full context\nlog.error('Write failed', { \n  noteId,\n  path: notePath,\n  error: err.message,\n  code: err.code,\n  syscall: err.syscall\n});\n\n// Warnings for retries\nlog.warn('Lock timeout, retrying', { \n  noteId,\n  attempt: attemptNumber,\n  maxAttempts: MAX_RETRIES,\n  waitMs: backoffDelay\n});\n\n// Migrations\nlog.info('Migration complete', {\n  fromVersion: oldVersion,\n  toVersion: newVersion,\n  noteCount: migratedNotes.length,\n  durationMs: migrationTime\n});\n```\n\n## Implementation Plan\n\n### Step 1: Assess Each Console Call\nReview each console usage and determine:\n- Is this actually needed? (some may be debug cruft)\n- What level should it be?\n- What context should be included?\n\n### Step 2: Add Logger\n```typescript\nimport { createLogger } from '@scribe/shared';\n\nconst log = createLogger('storage-fs');\n```\n\n### Step 3: Replace Strategically\n- Keep error logging (critical)\n- Convert verbose logs to debug level\n- Add structured context to all logs\n\n### Step 4: Consider Log Volume\nStorage operations can be frequent. Use debug level for:\n- Individual file reads/writes\n- Lock acquisition/release\n\nUse info level for:\n- Migrations\n- Vault-level operations\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `packages/storage-fs/src/storage.ts` | Replace console with logger |\n\n## Verification\n\n```bash\n# Check for remaining console usage\ngrep -n \"console\\.\" packages/storage-fs/src/storage.ts\n\n# Run storage tests\nbun test packages/storage-fs\n\n# Run integration tests\nbun test apps/desktop\n```\n\n## Success Criteria\n- [ ] Console calls replaced with structured logger\n- [ ] Appropriate log levels used\n- [ ] File operation context included\n- [ ] Tests pass\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small-Medium (45-60 minutes)\n- **Risk**: Low\n\n## Labels\n- refactoring\n- sprint-2\n- P2-medium\n- logging\n- storage","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T22:23:13.515771-06:00","updated_at":"2025-12-25T22:35:16.677429-06:00","closed_at":"2025-12-25T22:35:16.677429-06:00","dependencies":[{"issue_id":"scribe-p2d.13","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:23:13.516108-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.14","title":"[Sprint 3.1] Split note-factory.ts (786 lines) by note type","description":"# Split note-factory.ts by Note Type\n\n## ⚠️ PRIORITY DOWNGRADED TO P3\n\nThis is **test utility code** - splitting it provides minimal user-facing value. The 786-line file is complex but:\n- Tests work fine\n- Developers rarely touch this file\n- Effort/reward ratio is poor\n\nConsider deferring indefinitely unless the file becomes a maintenance burden.\n\n---\n\n## Original Problem Statement\n`packages/test-utils/src/note-factory.ts` is 786 lines - the largest file in the codebase. It contains test factories for all note types.\n\n## Why This is P3 (Low Priority)\n\n1. **It's test code** - doesn't affect users\n2. **It works** - no bugs or issues reported\n3. **Low change frequency** - rarely modified\n4. **Time better spent elsewhere** - P1/P2 tasks have higher impact\n\n## If/When Implemented\n\n### Proposed Structure\n```\npackages/test-utils/src/note-factory/\n├── index.ts           # Re-exports\n├── base-factory.ts    # Shared infrastructure\n├── daily-factory.ts   # Daily note specific\n├── meeting-factory.ts # Meeting note specific\n├── person-factory.ts  # Person note specific\n└── generic-factory.ts # createTestNote, createMockNote\n```\n\n## Success Criteria (if done)\n- [ ] Each file \u003c200 lines\n- [ ] All tests pass\n- [ ] No import changes needed\n\n## Estimated Effort\n- **Size**: Medium-Large (3-4 hours)\n- **Risk**: Medium (many tests depend on this)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-25T22:23:50.214584-06:00","updated_at":"2025-12-25T22:44:10.639514-06:00","dependencies":[{"issue_id":"scribe-p2d.14","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:23:50.21493-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.15","title":"[Sprint 3.2] Extract validation/locking/migration from storage.ts (646 lines)","description":"# Extract Validation/Locking/Migration from storage.ts\n\n## Problem Statement\n`packages/storage-fs/src/storage.ts` is 646 lines with multiple distinct responsibilities that should be separated for maintainability.\n\n## Current Responsibilities\n\n### 1. Note Validation (~100 lines)\n- Validating note structure before save\n- Checking required fields\n- Type validation\n\n### 2. File Locking (~80 lines)\n- Preventing concurrent writes\n- Lock acquisition/release\n- Timeout handling\n\n### 3. Format Migration (~120 lines)\n- Upgrading note format versions\n- Handling legacy formats\n- Migration error handling\n\n### 4. Core Storage (~350 lines)\n- Read/write operations\n- Directory management\n- Path resolution\n\n## Proposed Structure\n\n```\npackages/storage-fs/src/\n├── storage.ts           # Core storage (reduced to ~350 lines)\n├── note-validator.ts    # Validation logic (already exists, enhance)\n├── file-locker.ts       # File locking abstraction\n└── note-migrator.ts     # Migration logic (already exists, enhance)\n```\n\n## Implementation Plan\n\n### Step 1: Audit Existing Extractors\nCheck what's already extracted:\n- `note-validator.ts` - exists, may need more logic moved in\n- `note-migrator.ts` - exists, may need more logic moved in\n- File locking - probably still inline\n\n### Step 2: Extract File Locking\nCreate `file-locker.ts`:\n```typescript\nexport interface FileLock {\n  release(): Promise\u003cvoid\u003e;\n}\n\nexport interface FileLocker {\n  acquireLock(path: string, timeout?: number): Promise\u003cFileLock\u003e;\n  isLocked(path: string): boolean;\n}\n\nexport function createFileLocker(): FileLocker {\n  // Implementation\n}\n```\n\n### Step 3: Move Inline Validation to Validator\nIf there's validation logic in storage.ts, move it to note-validator.ts.\n\n### Step 4: Consolidate Migration Logic\nIf there's migration logic in storage.ts, move it to note-migrator.ts.\n\n### Step 5: Update Storage Imports\n```typescript\n// storage.ts\nimport { NoteValidator } from './note-validator';\nimport { createFileLocker } from './file-locker';\nimport { NoteMigrator } from './note-migrator';\n```\n\n### Step 6: Run Tests\n```bash\nbun test packages/storage-fs\nbun test apps/desktop\n```\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `packages/storage-fs/src/file-locker.ts` | CREATE |\n| `packages/storage-fs/src/storage.ts` | REDUCE (extract logic) |\n| `packages/storage-fs/src/note-validator.ts` | ENHANCE |\n| `packages/storage-fs/src/note-migrator.ts` | ENHANCE |\n| `packages/storage-fs/src/index.ts` | UPDATE exports |\n\n## Verification\n\n```bash\n# All storage tests pass\nbun test packages/storage-fs\n\n# Integration tests pass\nbun test apps/desktop\n\n# Check file sizes\nwc -l packages/storage-fs/src/storage.ts\n# Should be \u003c 400 lines\n```\n\n## Success Criteria\n- [ ] storage.ts reduced to \u003c400 lines\n- [ ] File locking extracted to separate module\n- [ ] All tests pass\n- [ ] No breaking API changes\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: Sprint 2.4 (logger migration should happen first)\n\n## Estimated Effort\n- **Size**: Medium (2-3 hours)\n- **Risk**: Medium (storage is critical path)\n\n## Labels\n- refactoring\n- sprint-3\n- P2-medium\n- storage","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T22:24:07.083306-06:00","updated_at":"2025-12-25T22:57:02.111819-06:00","closed_at":"2025-12-25T22:57:02.111819-06:00","dependencies":[{"issue_id":"scribe-p2d.15","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:24:07.083658-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.16","title":"[Sprint 3.3] Split ipc-contract.ts (645 lines) by namespace","description":"# Split ipc-contract.ts by Namespace\n\n## ⚠️ PRIORITY DOWNGRADED TO P3\n\nThis file contains **type definitions only** - no runtime code. The original GitHub issue #52 explicitly says:\n\n\u003e `packages/shared/src/types/note-types.ts` (639 lines) - **Keep as-is (type definitions)**\n\nThe same logic applies here. Type-only files can be large without maintenance burden because:\n- TypeScript provides excellent navigation (go to definition)\n- No runtime complexity to debug\n- Namespaces already provide logical grouping\n\nConsider deferring indefinitely unless developers report navigation issues.\n\n---\n\n## Original Problem Statement\n`packages/shared/src/ipc-contract.ts` is 645 lines containing the entire IPC contract.\n\n## Why This is P3 (Low Priority)\n\n1. **Types only** - no runtime code to debug\n2. **Namespaces work** - already logically organized\n3. **IDE navigation** - TypeScript handles this well\n4. **GH issue says keep as-is** - for similar 639-line type file\n\n## If/When Implemented\n\n### Proposed Structure\n```\npackages/shared/src/ipc/\n├── index.ts              # Re-exports\n├── types.ts              # Shared IPC types\n├── notes-contract.ts     # Notes namespace\n├── tasks-contract.ts     # Tasks namespace\n├── search-contract.ts    # Search namespace\n├── vault-contract.ts     # Vault namespace\n├── app-contract.ts       # App namespace\n└── graph-contract.ts     # Graph namespace\n```\n\n## Estimated Effort\n- **Size**: Medium (2-3 hours)\n- **Risk**: Low (types only)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-25T22:24:25.941421-06:00","updated_at":"2025-12-25T22:44:18.5921-06:00","dependencies":[{"issue_id":"scribe-p2d.16","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:24:25.941774-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.17","title":"[Sprint 4.1] Document metadata.title migration path","description":"# Document metadata.title Migration Path\n\n## Problem Statement\nThe `metadata.title` field in notes is deprecated but still referenced in 5 files. Before removing it, we need a documented migration path.\n\n## Context\n\n### What Changed\nOriginally, notes had:\n```typescript\ninterface NoteMetadata {\n  title: string;  // DEPRECATED\n  // ... other fields\n}\n```\n\nNow, titles are derived from:\n1. First heading in content\n2. Filename fallback\n3. Note type default (\"Untitled Daily\", \"Untitled Meeting\")\n\n### Why This Matters\n- Existing notes may have `metadata.title` set\n- Migrations need to handle legacy format\n- Users upgrading from old versions need data preserved\n\n## Current References\n\n| File | Line | Usage |\n|------|------|-------|\n| `packages/shared/src/types/note-types.ts` | ~45 | Type definition with @deprecated |\n| `packages/storage-fs/src/note-migrator.ts` | ~32 | Migration reads old title |\n| `apps/desktop/renderer/src/hooks/useNoteTitle.ts` | ~15 | Fallback to metadata.title |\n| `apps/desktop/test-helpers.ts` | ~89 | Test factories set title |\n| `packages/test-utils/src/note-factory.ts` | ~156 | Test factories set title |\n\n## Documentation to Create\n\n### 1. Migration Strategy Document\nCreate `docs/migrations/metadata-title-deprecation.md`:\n\n```markdown\n# Metadata Title Deprecation\n\n## Background\nNotes originally stored titles in `metadata.title`. This was redundant \nbecause titles are extractable from note content.\n\n## Migration Path\n\n### Phase 1: Dual Read (Current)\n- New code reads title from content first heading\n- Falls back to `metadata.title` for legacy notes\n- Migration code preserves both during format upgrades\n\n### Phase 2: Write Removal (Next Minor Version)\n- Stop writing `metadata.title` on save\n- Continue reading for backwards compatibility\n- Update note-factory test helpers\n\n### Phase 3: Full Removal (Next Major Version)\n- Remove `metadata.title` from type definitions\n- Remove fallback read logic\n- Migration script to clean old notes\n\n## Timeline\n- Phase 1: v1.x (current)\n- Phase 2: v1.x+1\n- Phase 3: v2.0\n\n## Testing\nEach phase requires:\n- Unit tests for migration logic\n- Integration tests with legacy note fixtures\n- Manual testing with real user vaults\n```\n\n### 2. Type Definition Update\nAdd deprecation notice with removal timeline:\n```typescript\ninterface NoteMetadata {\n  /**\n   * @deprecated Since v1.x. Titles are now derived from content.\n   * Will be removed in v2.0. See docs/migrations/metadata-title-deprecation.md\n   */\n  title?: string;\n}\n```\n\n## Implementation Plan\n\n### Step 1: Create Migration Document\nWrite the full migration strategy document.\n\n### Step 2: Update Type Definition\nAdd explicit removal timeline to @deprecated JSDoc.\n\n### Step 3: Add Code Comments\nIn each referencing file, add comment explaining deprecation:\n```typescript\n// DEPRECATED: metadata.title fallback - remove in v2.0\n// See docs/migrations/metadata-title-deprecation.md\nif (!title \u0026\u0026 metadata.title) {\n  title = metadata.title;\n}\n```\n\n### Step 4: Create Tracking Issue\nOpen a GitHub issue for v2.0 to track actual removal.\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `docs/migrations/metadata-title-deprecation.md` | CREATE |\n| `packages/shared/src/types/note-types.ts` | UPDATE deprecation notice |\n| Various files | ADD explanatory comments |\n\n## Verification\n\n```bash\n# Ensure document is well-formed\ncat docs/migrations/metadata-title-deprecation.md\n\n# Ensure deprecation notices are in place\ngrep -rn \"@deprecated.*title\" packages/shared/src/types/\n```\n\n## Success Criteria\n- [ ] Migration document created\n- [ ] Type definition has removal timeline\n- [ ] All references have explanatory comments\n- [ ] Future removal tracked\n\n## Dependencies\n- **Blocks**: scribe-p2d.18 (actual removal)\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small (1 hour)\n- **Risk**: Low (documentation only)\n\n## Labels\n- documentation\n- sprint-4\n- P2-medium\n- deprecated\n- migration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T22:24:53.235453-06:00","updated_at":"2025-12-25T22:44:22.788544-06:00","closed_at":"2025-12-25T22:44:22.788544-06:00","dependencies":[{"issue_id":"scribe-p2d.17","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:24:53.235803-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.18","title":"[Sprint 4.2] Remove deprecated TaskIndex constructor","description":"# Remove Deprecated TaskIndex Constructor\n\n## Problem Statement\n`packages/engine-core/src/task-index.ts` (line 140) has a deprecated constructor that creates TaskIndex without TaskPersistence. This should be removed.\n\n## Context\n\n### What Changed\nThe TaskIndex was updated to require TaskPersistence for proper task state saving:\n\n```typescript\n// OLD (deprecated)\nconstructor(vault: IVault) {\n  // No persistence - tasks lost on restart\n}\n\n// NEW (current)\nconstructor(vault: IVault, persistence: TaskPersistence) {\n  // Tasks properly persisted\n}\n```\n\n### Why This Matters\n- Using the old constructor means tasks aren't persisted\n- Any code using old constructor has a bug\n- Keeping deprecated code increases maintenance burden\n\n## Current Usage\n\nSearch for usages of the deprecated constructor:\n```bash\ngrep -rn \"new TaskIndex(\" --include=\"*.ts\" | grep -v persistence\n```\n\n## Implementation Plan\n\n### Step 1: Find All Usages\n```bash\ngrep -rn \"new TaskIndex\" apps/ packages/\n```\n\n### Step 2: Update Test Usages\nTests may use the simpler constructor. Update to use mock persistence:\n```typescript\n// Before\nconst taskIndex = new TaskIndex(vault);\n\n// After\nconst mockPersistence = createMockTaskPersistence();\nconst taskIndex = new TaskIndex(vault, mockPersistence);\n```\n\n### Step 3: Update Production Usages\nAny production code using old constructor is buggy. Fix by providing persistence.\n\n### Step 4: Remove Deprecated Constructor\nDelete the deprecated constructor and update type definition.\n\n### Step 5: Run Tests\n```bash\nbun test packages/engine-core\nbun test apps/desktop\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `packages/engine-core/src/task-index.ts` | Remove deprecated constructor |\n| Test files | Update to use persistence |\n| Any production files | Update to use persistence |\n\n## Verification\n\n```bash\nbun test packages/engine-core\nbun test\nbun run typecheck\n```\n\n## Success Criteria\n- [ ] Deprecated constructor removed\n- [ ] All usages updated to use persistence\n- [ ] Tests pass\n- [ ] Type checking passes\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: None (independent of metadata.title deprecation)\n\n## Estimated Effort\n- **Size**: Small-Medium (1-2 hours)\n- **Risk**: Medium (may have hidden usages)\n\n## Labels\n- refactoring\n- sprint-4\n- P2-medium\n- deprecated\n- breaking-change","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-25T22:25:09.848611-06:00","updated_at":"2025-12-25T22:55:54.072348-06:00","closed_at":"2025-12-25T22:55:54.072348-06:00","dependencies":[{"issue_id":"scribe-p2d.18","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:25:09.849021-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.19","title":"[Sprint 5.1] Add JSDoc documentation for block-converters.ts","description":"# Add JSDoc Documentation for Content Conversion Modules\n\n## Problem Statement\nThree critical content conversion modules lack sufficient JSDoc documentation:\n- `packages/shared/src/block-converters.ts` (357 lines) - AST transformations\n- `packages/shared/src/inline-converters.ts` (305 lines) - inline formatting\n- `packages/shared/src/frontmatter.ts` (99 lines) - YAML generation\n\n## Why Documentation Matters\n\n### Knowledge Transfer\n- New developers can't understand the conversion logic\n- Complex edge cases are undocumented\n- No explanation of why certain patterns exist\n\n### Maintenance Risk\n- Without docs, refactoring is risky\n- Bug fixes may break undocumented behavior\n- Code reviews can't verify correctness\n\n---\n\n## Part 1: block-converters.ts\n\n### Module Overview\n```typescript\n/**\n * @module block-converters\n * \n * Converts Lexical editor block nodes to Markdown format.\n * \n * ## Supported Block Types\n * - Headings (h1-h6) → # to ######\n * - Paragraphs → plain text with inline formatting\n * - Lists (ordered, unordered, checklist) → - * 1. [ ]\n * - Code blocks → fenced with language\n * - Tables → GitHub-flavored markdown tables\n * - Blockquotes → \u003e prefixed\n * - Horizontal rules → ---\n * \n * @see {@link inline-converters} for inline content handling\n * @see {@link markdown-escaper} for character escaping\n */\n```\n\n### Key Functions to Document\n- `headingToMarkdown` - heading conversion with level\n- `paragraphToMarkdown` - text with inline formatting\n- `listToMarkdown` - recursive list handling\n- `tableToMarkdown` - complex table structure\n- `codeBlockToMarkdown` - fenced code with language\n\n---\n\n## Part 2: inline-converters.ts\n\n### Module Overview\n```typescript\n/**\n * @module inline-converters\n * \n * Converts Lexical inline nodes to Markdown format.\n * \n * ## Format Combination Rules\n * - Bold + Italic = ***text***\n * - Code takes precedence (no nesting)\n * - Strikethrough wraps outer: ~~**text**~~\n * \n * ## Link Types\n * - External: [text](url)\n * - Internal: [[note-name]] or [[note|display]]\n * - Mentions: @PersonName\n */\n```\n\n### Format Priority Matrix\nDocument the nesting order (outer to inner):\n1. Strikethrough (~~)\n2. Bold (**)\n3. Italic (*)\n4. Underline (\u003cu\u003e)\n5. Code (`) - cannot contain other formats\n\n---\n\n## Part 3: frontmatter.ts\n\n### Module Overview\n```typescript\n/**\n * @module frontmatter\n * \n * Generates YAML frontmatter for Markdown export.\n * \n * ## Compatibility\n * Output is compatible with: Obsidian, Hugo, Jekyll, Astro\n * \n * ## Escaping Rules\n * Values are wrapped in double quotes when they contain:\n * - Colons followed by space\n * - Hash symbols, brackets, braces\n * - Leading/trailing whitespace\n */\n```\n\n---\n\n## Implementation Plan\n\n### Step 1: Add Module Overviews\nAdd comprehensive module-level JSDoc at top of each file.\n\n### Step 2: Document Public Functions\nAdd JSDoc with @param, @returns, @example, @remarks for each public function.\n\n### Step 3: Document Complex Internals\nAdd explanatory comments for non-obvious algorithms.\n\n### Step 4: Add @see Cross-References\nLink related modules together.\n\n### Step 5: Verify Documentation\n```bash\nbun run typecheck\nnpx typedoc packages/shared/src/block-converters.ts packages/shared/src/inline-converters.ts packages/shared/src/frontmatter.ts --out /tmp/docs\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/block-converters.ts` | ADD JSDoc |\n| `packages/shared/src/inline-converters.ts` | ADD JSDoc |\n| `packages/shared/src/frontmatter.ts` | ADD JSDoc |\n\n## Success Criteria\n- [ ] All three modules have module-level overview\n- [ ] All public functions documented with @param, @returns\n- [ ] Examples provided for complex functions\n- [ ] Cross-references between related modules\n- [ ] Format combination matrix documented\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: scribe-p2d.1, scribe-p2d.2, scribe-p2d.5 (tests should exist first)\n\n## Estimated Effort\n- **Size**: Medium (3-4 hours total)\n- **Risk**: Low\n\n## Labels\n- documentation\n- sprint-5\n- P3-low\n- jsdoc\n- MERGED from scribe-p2d.19, .20, .21","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-25T22:25:34.216688-06:00","updated_at":"2025-12-25T22:37:08.107415-06:00","dependencies":[{"issue_id":"scribe-p2d.19","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:25:34.217051-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.19","depends_on_id":"scribe-p2d.1","type":"blocks","created_at":"2025-12-25T22:26:43.867694-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.19","depends_on_id":"scribe-p2d.5","type":"blocks","created_at":"2025-12-25T22:37:18.239992-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.2","title":"[Sprint 1.2] Add comprehensive tests for inline-converters.ts","description":"# Add Comprehensive Tests for inline-converters.ts\n\n## File Under Test\n`packages/shared/src/inline-converters.ts` (305 lines)\n\n## Strategic Context\n\n### Why This is Critical (P1)\nThis module handles **inline content conversion** - the text formatting that users see in every note. Bugs here affect:\n- **Bold/Italic rendering**: `**text**` and `*text*` output\n- **Links**: Internal note links and external URLs\n- **Mentions**: @person references that power the people graph\n- **Inline code**: `` `code` `` snippets\n\nIf conversion fails, user formatting is lost or corrupted in exports.\n\n### What This Module Does\nInline content extraction handles:\n- **Text formatting**: Bold, italic, underline, strikethrough, code\n- **Combined formats**: Bold-italic, underlined-code, etc.\n- **Link nodes**: External URLs with display text\n- **Internal links**: Note-to-note references (wiki-style links)\n- **Mentions**: Person mentions that connect to people notes\n- **Escape sequences**: Markdown special character handling\n\n### Current State\n- **Lines of code**: 305\n- **Test coverage**: 0% (NO TESTS)\n- **Complexity**: MEDIUM (format combination logic, link handling)\n\n## Implementation Plan\n\n### Test Categories\n\n#### 1. Text Formatting Tests\n```typescript\ndescribe('textToMarkdown', () =\u003e {\n  describe('single formats', () =\u003e {\n    it('converts bold to **text**', () =\u003e {});\n    it('converts italic to *text*', () =\u003e {});\n    it('converts underline to \u003cu\u003etext\u003c/u\u003e', () =\u003e {});\n    it('converts strikethrough to ~~text~~', () =\u003e {});\n    it('converts code to `text`', () =\u003e {});\n  });\n  \n  describe('combined formats', () =\u003e {\n    it('converts bold+italic to ***text***', () =\u003e {});\n    it('handles bold+code correctly', () =\u003e {});\n    it('handles triple format combinations', () =\u003e {});\n  });\n  \n  describe('format boundaries', () =\u003e {\n    it('handles format changes mid-text', () =\u003e {});\n    it('handles adjacent different formats', () =\u003e {});\n    it('handles nested format contexts', () =\u003e {});\n  });\n});\n```\n\n#### 2. Link Conversion Tests\n```typescript\ndescribe('linkToMarkdown', () =\u003e {\n  describe('external links', () =\u003e {\n    it('converts to [text](url) format', () =\u003e {});\n    it('handles links without display text', () =\u003e {});\n    it('escapes special chars in URLs', () =\u003e {});\n    it('handles email links (mailto:)', () =\u003e {});\n  });\n  \n  describe('internal links', () =\u003e {\n    it('converts wiki-style [[note]] links', () =\u003e {});\n    it('handles links with display text [[note|display]]', () =\u003e {});\n    it('handles links to non-existent notes', () =\u003e {});\n  });\n});\n```\n\n#### 3. Mention Conversion Tests\n```typescript\ndescribe('mentionToMarkdown', () =\u003e {\n  it('converts person mention to @name', () =\u003e {});\n  it('preserves mention metadata', () =\u003e {});\n  it('handles mentions with special characters', () =\u003e {});\n  it('handles multiple mentions in sequence', () =\u003e {});\n});\n```\n\n#### 4. Escape Handling Tests\n```typescript\ndescribe('escapeInlineMarkdown', () =\u003e {\n  it('escapes asterisks that could be formatting', () =\u003e {});\n  it('escapes underscores that could be formatting', () =\u003e {});\n  it('escapes backticks', () =\u003e {});\n  it('preserves already-escaped characters', () =\u003e {});\n  it('handles edge: *text* surrounded by words', () =\u003e {});\n});\n```\n\n#### 5. Integration Tests\n```typescript\ndescribe('inline content integration', () =\u003e {\n  it('converts paragraph with mixed content', () =\u003e {});\n  it('handles formatted text with links', () =\u003e {});\n  it('handles mentions inside formatted text', () =\u003e {});\n});\n```\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/inline-converters.test.ts` | CREATE |\n| `packages/shared/src/__fixtures__/inline-samples.ts` | CREATE (test fixtures) |\n\n## Verification\n\n```bash\n# Run tests\nbun test packages/shared/src/inline-converters.test.ts\n\n# Check coverage\nbun test packages/shared --coverage | grep inline-converters\n\n# Target: \u003e80% line coverage\n```\n\n## Success Criteria\n- [ ] All test categories implemented\n- [ ] Coverage \u003e80% for inline-converters.ts\n- [ ] Format combination matrix tested\n- [ ] Edge cases for escaping documented\n\n## Dependencies\n- **Blocks**: None (fully parallel)\n- **Blocked by**: None\n\n## Relationship to Other Tasks\n- Pairs well with block-converters.ts tests (Sprint 1.1)\n- Both feed into content-extractor integration\n- Test fixtures can be shared\n\n## Estimated Effort\n- **Size**: Medium (3-4 hours)\n- **Risk**: Low (pure functions, predictable inputs)\n\n## Labels\n- testing\n- sprint-1\n- P1-critical\n- content-safety","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:19:25.978278-06:00","updated_at":"2025-12-25T22:54:33.87535-06:00","closed_at":"2025-12-25T22:54:33.87535-06:00","dependencies":[{"issue_id":"scribe-p2d.2","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:19:25.97867-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.20","title":"[Sprint 5.2] Add JSDoc documentation for inline-converters.ts","description":"# Add JSDoc Documentation for inline-converters.ts\n\n## Problem Statement\n`packages/shared/src/inline-converters.ts` handles inline content conversion (bold, italic, links, mentions) but lacks documentation explaining the format combination logic.\n\n## Documentation Required\n\n### 1. Module Overview\n```typescript\n/**\n * @module inline-converters\n * \n * Converts Lexical inline nodes to Markdown format.\n * \n * ## Supported Inline Types\n * - Text with formatting (bold, italic, underline, strikethrough, code)\n * - External links → [text](url)\n * - Internal links → [[note-name]] or [[note|display]]\n * - Person mentions → @PersonName\n * \n * ## Format Combination Rules\n * - Bold + Italic = ***text***\n * - Code takes precedence (no nesting)\n * - Strikethrough wraps outer: ~~**text**~~\n * \n * @see {@link block-converters} for block-level conversion\n * @see {@link markdown-escaper} for character escaping\n */\n```\n\n### 2. Format Combination Matrix\nDocument the complex format interaction logic:\n```typescript\n/**\n * Applies text formatting to content.\n * \n * ## Format Priority\n * When multiple formats apply, they nest in this order (outer to inner):\n * 1. Strikethrough (~~)\n * 2. Bold (**)\n * 3. Italic (*)\n * 4. Underline (\u003cu\u003e)\n * 5. Code (`) - cannot contain other formats\n * \n * ## Combination Examples\n * | Formats | Output |\n * |---------|--------|\n * | bold | **text** |\n * | italic | *text* |\n * | bold+italic | ***text*** |\n * | strikethrough+bold | ~~**text**~~ |\n * | code | `text` (no other formats) |\n */\n```\n\n### 3. Link Handling Documentation\n```typescript\n/**\n * Converts link nodes to Markdown format.\n * \n * ## Link Types\n * - External: `[display](https://example.com)`\n * - Internal: `[[note-name]]` or `[[note-name|Display Text]]`\n * - Email: `[email](mailto:user@example.com)`\n * \n * ## URL Escaping\n * - Parentheses in URLs are escaped: `url%28with%29parens`\n * - Spaces are encoded: `url%20with%20spaces`\n * \n * @param node - Link node containing url and optional title\n * @returns Markdown link string\n */\n```\n\n## Implementation Plan\n\n### Step 1: Add Module Overview\nDocument the overall purpose and supported types.\n\n### Step 2: Document Format Combination\nExplain the matrix of format interactions.\n\n### Step 3: Document Each Converter\nAdd JSDoc to link, mention, and text converters.\n\n### Step 4: Add Examples\nInclude @example blocks with input/output.\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/inline-converters.ts` | ADD JSDoc |\n\n## Success Criteria\n- [ ] Module overview added\n- [ ] Format combination matrix documented\n- [ ] All converters documented\n- [ ] Examples provided\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: Sprint 1.2 (tests should exist first)\n\n## Estimated Effort\n- **Size**: Small-Medium (1-2 hours)\n- **Risk**: Low\n\n## Labels\n- documentation\n- sprint-5\n- P3-low\n- jsdoc","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-25T22:25:50.550736-06:00","updated_at":"2025-12-25T22:37:12.504803-06:00","closed_at":"2025-12-25T22:37:12.504803-06:00","dependencies":[{"issue_id":"scribe-p2d.20","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:25:50.551069-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.20","depends_on_id":"scribe-p2d.2","type":"blocks","created_at":"2025-12-25T22:26:44.034947-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.21","title":"[Sprint 5.3] Add JSDoc documentation for frontmatter.ts","description":"# Add JSDoc Documentation for frontmatter.ts\n\n## Problem Statement\n`packages/shared/src/frontmatter.ts` generates YAML frontmatter for markdown export but lacks documentation on YAML escaping rules and output format.\n\n## Documentation Required\n\n### 1. Module Overview\n```typescript\n/**\n * @module frontmatter\n * \n * Generates YAML frontmatter for Markdown export.\n * \n * ## Output Format\n * ```yaml\n * ---\n * title: Note Title\n * created: 2024-01-15T10:30:00Z\n * updated: 2024-01-16T14:20:00Z\n * tags:\n *   - tag1\n *   - tag2\n * ---\n * ```\n * \n * ## Compatibility\n * Output is compatible with:\n * - Obsidian\n * - Hugo\n * - Jekyll\n * - Astro\n * - Any YAML 1.1 compliant parser\n * \n * @see {@link content-extractor} for full export pipeline\n */\n```\n\n### 2. Escaping Rules Documentation\n```typescript\n/**\n * Escapes a string value for safe YAML output.\n * \n * ## Escaping Rules\n * \n * ### Quote Wrapping\n * Values are wrapped in double quotes when they contain:\n * - Colons followed by space (`: `)\n * - Hash symbols (`#`)\n * - Square brackets (`[`, `]`)\n * - Curly braces (`{`, `}`)\n * - Leading/trailing whitespace\n * \n * ### Character Escaping\n * Inside double quotes:\n * - `\"` becomes `\\\"`\n * - `\\` becomes `\\\\`\n * - Newlines become `\\n`\n * \n * ### Safe Values\n * These don't need quoting:\n * - Alphanumeric strings\n * - Strings with spaces (but no special chars)\n * \n * @param value - The string to escape\n * @returns YAML-safe string, possibly quoted\n */\n```\n\n## Implementation Plan\n\n### Step 1: Add Module Overview\nDocument purpose, output format, compatibility.\n\n### Step 2: Document Escaping Logic\nExplain when and how values are escaped.\n\n### Step 3: Document Optional Fields\nExplain which fields are included/omitted based on input.\n\n### Step 4: Add Examples\nInclude full frontmatter output examples.\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/frontmatter.ts` | ADD JSDoc |\n\n## Success Criteria\n- [ ] Module overview with output format\n- [ ] Escaping rules documented\n- [ ] Optional field behavior documented\n- [ ] Compatibility notes included\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: Sprint 1.5 (tests should exist first)\n\n## Estimated Effort\n- **Size**: Small (45 minutes)\n- **Risk**: Low\n\n## Labels\n- documentation\n- sprint-5\n- P3-low\n- jsdoc","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-25T22:26:03.379245-06:00","updated_at":"2025-12-25T22:37:13.488197-06:00","closed_at":"2025-12-25T22:37:13.488197-06:00","dependencies":[{"issue_id":"scribe-p2d.21","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:26:03.379626-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.21","depends_on_id":"scribe-p2d.5","type":"blocks","created_at":"2025-12-25T22:26:44.22505-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.22","title":"[Sprint 5.4] Document intentional swallowed promises with explanatory comments","description":"# Document Intentional Swallowed Promises\n\n## Problem Statement\nThe codebase has 7 instances of `.catch(() =\u003e {})` or `.catch(() =\u003e ...)` that intentionally swallow promise rejections. While intentional, they lack explanatory comments.\n\n## Why This Matters\n\n### Code Review Friction\nWithout comments, reviewers may think these are bugs:\n- \"Why is this error ignored?\"\n- \"Shouldn't we handle this?\"\n\n### Future Maintenance\nDevelopers maintaining this code need to understand:\n- Why the error is intentionally ignored\n- What the expected failure scenarios are\n\n## Verified Instances (Accurate as of analysis)\n\n| File | Line | Purpose |\n|------|------|---------|\n| `apps/cli/src/signals.ts` | ~93 | Signal cleanup - can fail if process exiting |\n| `apps/cli/src/signals.ts` | ~106 | Second signal cleanup attempt |\n| `apps/cli/tests/setup.ts` | ~46 | Test cleanup - best effort |\n| `packages/test-utils/src/vault-factory.ts` | ~98 | Temp directory cleanup |\n| `packages/test-utils/src/vault-factory.ts` | ~179 | Temp directory cleanup |\n| `apps/cli/tests/unit/vault-resolver.test.ts` | ~47 | Test cleanup |\n| `apps/desktop/renderer/.../AttendeesWidget.tsx` | ~51 | Returns null on failure (slightly different pattern) |\n\n## Documentation Pattern\n\nReplace:\n```typescript\ncleanup().catch(() =\u003e {});\n```\n\nWith:\n```typescript\n// INTENTIONAL: Best-effort cleanup during process exit/teardown.\n// Expected to fail if directory already removed or process terminating.\n// No user-visible impact if this fails.\ncleanup().catch(() =\u003e {});\n```\n\n## Implementation Plan\n\n### Step 1: Review Each Instance\nFor each swallowed promise:\n1. Understand why it's intentional\n2. Document the expected failure scenarios\n3. Confirm it's truly safe to ignore\n\n### Step 2: Add Comments\nAdd explanatory comment before each `.catch(() =\u003e {})`.\n\n### Step 3: Consider Debug Logging (Optional)\nFor some cases, consider logging at debug level:\n```typescript\ncleanup().catch((err) =\u003e {\n  // Best-effort cleanup - log but don't fail\n  log.debug('Cleanup failed (expected during teardown)', { error: err.message });\n});\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `apps/cli/src/signals.ts` | ADD comments (2 instances) |\n| `apps/cli/tests/setup.ts` | ADD comment |\n| `packages/test-utils/src/vault-factory.ts` | ADD comments (2 instances) |\n| `apps/cli/tests/unit/vault-resolver.test.ts` | ADD comment |\n| `apps/desktop/renderer/src/components/ContextPanel/AttendeesWidget.tsx` | ADD comment (different pattern) |\n\n## Verification\n\n```bash\n# Find all swallowed promises\ngrep -rn \"catch(() =\u003e\" apps/ packages/ --include=\"*.ts\" --include=\"*.tsx\"\n\n# Ensure each has a comment above it\n# Manual review\n```\n\n## Success Criteria\n- [ ] All 7 instances have explanatory comments\n- [ ] Comments explain why swallowing is intentional\n- [ ] Expected failure scenarios documented\n- [ ] No new swallowed promises added without comments\n\n## Dependencies\n- **Blocks**: None\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small (45 minutes)\n- **Risk**: Low\n\n## Labels\n- documentation\n- sprint-5\n- P3-low\n- code-quality","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-25T22:26:22.768444-06:00","updated_at":"2025-12-25T22:39:51.092816-06:00","dependencies":[{"issue_id":"scribe-p2d.22","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:26:22.76882-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.3","title":"[Sprint 1.3] Add comprehensive tests for markdown-escaper.ts","description":"# Add Comprehensive Tests for markdown-escaper.ts\n\n## File Under Test\n`packages/shared/src/markdown-escaper.ts` (336 lines)\n\n## Strategic Context\n\n### Why This is Critical (P1)\nThe markdown escaper is the **defensive layer** that prevents user content from accidentally triggering markdown formatting. This is critical for:\n- **Data fidelity**: User text like `*important*` stays as-is if not intentionally formatted\n- **Security-adjacent**: Prevents injection of unintended markdown structures\n- **Export quality**: Clean, predictable markdown output\n\n### What This Module Does\nEscape/unescape utilities for markdown special characters:\n- **Line-start escaping**: `#`, `\u003e`, `-`, `+`, `*` at start of line\n- **Inline escaping**: `*`, `_`, `` ` ``, `[`, `]`, `(`, `)`, `\\`\n- **Context-aware escaping**: Different rules for table cells (pipe escaping)\n- **Ordered list detection**: Escaping `1.`, `2.`, etc. at line start\n- **Emphasis pattern detection**: Mid-word `*` and `_` handling\n\n### Current State\n- **Lines of code**: 336\n- **Test coverage**: 0% (NO TESTS)\n- **Complexity**: HIGH (state machine, context-sensitive rules)\n\n## Implementation Plan\n\n### Test Categories\n\n#### 1. Line-Start Escaping Tests\n```typescript\ndescribe('escapeLineStart', () =\u003e {\n  it('escapes # that would become heading', () =\u003e {\n    expect(escape('# not a heading')).toBe('\\\\# not a heading');\n  });\n  it('escapes \u003e that would become blockquote', () =\u003e {});\n  it('escapes - that would become list item', () =\u003e {});\n  it('escapes + that would become list item', () =\u003e {});\n  it('escapes * that would become list item', () =\u003e {});\n  it('does NOT escape # mid-line', () =\u003e {});\n  it('handles multiple # at start', () =\u003e {});\n});\n```\n\n#### 2. Ordered List Escaping Tests\n```typescript\ndescribe('escapeOrderedListMarker', () =\u003e {\n  it('escapes \"1. \" at line start', () =\u003e {});\n  it('escapes multi-digit numbers \"10. \"', () =\u003e {});\n  it('does NOT escape \"1.\" without space', () =\u003e {});\n  it('does NOT escape mid-line numbers', () =\u003e {});\n});\n```\n\n#### 3. Emphasis Escaping Tests\n```typescript\ndescribe('escapeEmphasis', () =\u003e {\n  describe('asterisk escaping', () =\u003e {\n    it('escapes *word* pattern', () =\u003e {});\n    it('escapes **word** pattern', () =\u003e {});\n    it('does NOT escape mid-word asterisk', () =\u003e {});\n    it('escapes ***word*** pattern', () =\u003e {});\n  });\n  \n  describe('underscore escaping', () =\u003e {\n    it('escapes _word_ pattern', () =\u003e {});\n    it('escapes __word__ pattern', () =\u003e {});\n    it('does NOT escape mid_word underscores', () =\u003e {});\n  });\n  \n  describe('edge cases', () =\u003e {\n    it('handles \"a*b*c\" (all mid-word)', () =\u003e {});\n    it('handles \"word* not emphasis\"', () =\u003e {});\n    it('handles \"*emphasis* more text\"', () =\u003e {});\n  });\n});\n```\n\n#### 4. Bracket/Parenthesis Escaping Tests\n```typescript\ndescribe('escapeLinkCharacters', () =\u003e {\n  it('escapes [ that could start link text', () =\u003e {});\n  it('escapes ] that could end link text', () =\u003e {});\n  it('escapes ( in link context', () =\u003e {});\n  it('escapes ) in link context', () =\u003e {});\n  it('preserves balanced brackets in prose', () =\u003e {});\n});\n```\n\n#### 5. Table Context Tests\n```typescript\ndescribe('escapeTableContent', () =\u003e {\n  it('escapes | in table cells', () =\u003e {});\n  it('preserves other escaping in table cells', () =\u003e {});\n  it('handles complex cell content', () =\u003e {});\n});\n```\n\n#### 6. State Machine Tests\n```typescript\ndescribe('contextTracking', () =\u003e {\n  it('tracks line start correctly', () =\u003e {});\n  it('resets after newline', () =\u003e {});\n  it('handles Windows line endings (CRLF)', () =\u003e {});\n  it('maintains state across multiple escapes', () =\u003e {});\n});\n```\n\n#### 7. Round-Trip Tests\n```typescript\ndescribe('escape/unescape round-trip', () =\u003e {\n  it('text survives escape → unescape', () =\u003e {});\n  it('formatted text survives round-trip', () =\u003e {});\n  it('complex document survives round-trip', () =\u003e {});\n});\n```\n\n## Property-Based Testing Opportunity\n\nThis module is an excellent candidate for property-based testing:\n\n```typescript\nimport { fc } from '@fast-check/vitest';\n\ndescribe('property-based tests', () =\u003e {\n  it('escape never produces unbalanced backslashes', () =\u003e {\n    fc.assert(fc.property(fc.string(), (s) =\u003e {\n      const escaped = escapeMarkdownText(s);\n      return !escaped.includes('\\\\\\\\\\\\'); // no triple escapes\n    }));\n  });\n  \n  it('escape is idempotent for safe strings', () =\u003e {\n    fc.assert(fc.property(fc.string(), (s) =\u003e {\n      // If string has no special chars, escape should be identity\n    }));\n  });\n});\n```\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/markdown-escaper.test.ts` | CREATE |\n\n## Verification\n\n```bash\n# Run tests\nbun test packages/shared/src/markdown-escaper.test.ts\n\n# Check coverage\nbun test packages/shared --coverage | grep markdown-escaper\n\n# Target: \u003e90% line coverage (escaper is critical)\n```\n\n## Success Criteria\n- [ ] All test categories implemented\n- [ ] Coverage \u003e90% for markdown-escaper.ts (higher bar for critical code)\n- [ ] Property-based tests for invariants\n- [ ] All edge cases from issue #52 covered\n\n## Dependencies\n- **Blocks**: None (fully parallel)\n- **Blocked by**: None\n- **Related**: Feeds into inline-converters.ts testing\n\n## Estimated Effort\n- **Size**: Medium-Large (4-5 hours)\n- **Risk**: Medium (state machine complexity)\n\n## Labels\n- testing\n- sprint-1\n- P1-critical\n- content-safety\n- property-based-testing","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:19:56.861986-06:00","updated_at":"2025-12-25T22:56:03.670945-06:00","closed_at":"2025-12-25T22:56:03.670945-06:00","dependencies":[{"issue_id":"scribe-p2d.3","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:19:56.862341-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.4","title":"[Sprint 1.4] Add comprehensive tests for content.ts","description":"# Add Comprehensive Tests for content.ts\n\n## File Under Test\n`packages/shared/src/content.ts` (206 lines)\n\n## Strategic Context\n\n### Why This is Critical (P1)\nThis module provides **content creation utilities** - the foundational building blocks for creating note content. Every new note, template, and content structure flows through here:\n- **createEmptyContent()**: Base for all new notes\n- **Content type utilities**: Helpers for structured content creation\n- **Content validation**: Ensuring content meets expected structure\n\n### What This Module Does\nContent creation utilities handle:\n- **Empty content creation**: Properly structured Lexical root nodes\n- **Content type helpers**: Daily, meeting, person note structures\n- **Content structure validation**: Ensuring AST integrity\n- **Content cloning**: Safe deep copies for modification\n\n### Current State\n- **Lines of code**: 206\n- **Test coverage**: 0% (NO TESTS)\n- **Complexity**: MEDIUM (structure creation, type safety)\n\n## Implementation Plan\n\n### Test Categories\n\n#### 1. Empty Content Creation Tests\n```typescript\ndescribe('createEmptyContent', () =\u003e {\n  it('creates valid EditorContent structure', () =\u003e {\n    const content = createEmptyContent();\n    expect(content.root).toBeDefined();\n    expect(content.root.type).toBe('root');\n  });\n  \n  it('includes empty paragraph with correct properties', () =\u003e {\n    const content = createEmptyContent();\n    const paragraph = content.root.children[0];\n    expect(paragraph.type).toBe('paragraph');\n    expect(paragraph.format).toBeDefined();\n    expect(paragraph.indent).toBe(0);\n    expect(paragraph.direction).toBeDefined();\n    expect(paragraph.version).toBeDefined();\n  });\n  \n  it('creates independent instances (not shared references)', () =\u003e {\n    const content1 = createEmptyContent();\n    const content2 = createEmptyContent();\n    content1.root.children.push({ type: 'test' });\n    expect(content2.root.children).toHaveLength(1);\n  });\n  \n  it('matches expected EditorContent type', () =\u003e {\n    const content = createEmptyContent();\n    // Type-level check: this should compile\n    const typed: EditorContent = content;\n    expect(typed).toBeDefined();\n  });\n});\n```\n\n#### 2. Daily Content Creation Tests\n```typescript\ndescribe('createDailyContent', () =\u003e {\n  it('creates content with date heading', () =\u003e {});\n  it('includes default daily note structure', () =\u003e {});\n  it('accepts custom date parameter', () =\u003e {});\n  it('formats date correctly in heading', () =\u003e {});\n});\n```\n\n#### 3. Meeting Content Creation Tests\n```typescript\ndescribe('createMeetingContent', () =\u003e {\n  it('creates content with meeting title', () =\u003e {});\n  it('includes attendees section', () =\u003e {});\n  it('includes agenda section', () =\u003e {});\n  it('includes notes section', () =\u003e {});\n  it('includes action items section', () =\u003e {});\n});\n```\n\n#### 4. Person Content Creation Tests\n```typescript\ndescribe('createPersonContent', () =\u003e {\n  it('creates content with person name heading', () =\u003e {});\n  it('includes contact info section', () =\u003e {});\n  it('includes notes section', () =\u003e {});\n  it('handles special characters in names', () =\u003e {});\n});\n```\n\n#### 5. Content Validation Tests\n```typescript\ndescribe('content validation', () =\u003e {\n  it('validates well-formed content', () =\u003e {});\n  it('rejects missing root', () =\u003e {});\n  it('rejects invalid node types', () =\u003e {});\n  it('handles null/undefined gracefully', () =\u003e {});\n});\n```\n\n#### 6. Content Cloning Tests\n```typescript\ndescribe('content cloning', () =\u003e {\n  it('creates deep copy of content', () =\u003e {});\n  it('modifications to clone do not affect original', () =\u003e {});\n  it('handles complex nested structures', () =\u003e {});\n  it('preserves all node properties', () =\u003e {});\n});\n```\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/content.test.ts` | CREATE |\n\n## Verification\n\n```bash\n# Run tests\nbun test packages/shared/src/content.test.ts\n\n# Check coverage\nbun test packages/shared --coverage | grep content.ts\n\n# Target: \u003e80% line coverage\n```\n\n## Success Criteria\n- [ ] All content creation functions tested\n- [ ] Coverage \u003e80% for content.ts\n- [ ] Type safety verified at runtime\n- [ ] Deep clone independence verified\n\n## Dependencies\n- **Blocks**: None (fully parallel)\n- **Blocked by**: None\n- **Related**: Content creation is used by note-factory.ts\n\n## Estimated Effort\n- **Size**: Small-Medium (2-3 hours)\n- **Risk**: Low (well-defined structures)\n\n## Labels\n- testing\n- sprint-1\n- P1-critical\n- content-safety","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:20:21.589313-06:00","updated_at":"2025-12-25T22:56:18.887154-06:00","closed_at":"2025-12-25T22:56:18.887154-06:00","dependencies":[{"issue_id":"scribe-p2d.4","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:20:21.589647-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.5","title":"[Sprint 1.5] Add comprehensive tests for frontmatter.ts","description":"# Add Comprehensive Tests for frontmatter.ts\n\n## File Under Test\n`packages/shared/src/frontmatter.ts` (~100 lines)\n\n## Strategic Context\n\n### Why This is Critical (P1)\nFrontmatter is the **metadata header** for markdown exports. YAML frontmatter is used by:\n- **Static site generators**: Hugo, Jekyll, Astro expect valid frontmatter\n- **Note-taking apps**: Obsidian, Logseq parse frontmatter for metadata\n- **Export interoperability**: Users expect their exported notes to work elsewhere\n\nInvalid frontmatter can make exported notes unusable in other tools.\n\n### What This Module Does\nYAML frontmatter generation for markdown export:\n- **Title**: Note title as frontmatter field\n- **Created/Updated dates**: Timestamp metadata\n- **Tags**: Array of tags in YAML format\n- **Custom fields**: Extensible metadata structure\n- **Special character handling**: YAML escaping for edge cases\n\n### Current State\n- **Lines of code**: ~100\n- **Test coverage**: 0% (NO TESTS)\n- **Complexity**: MEDIUM (YAML generation, special char handling)\n\n## Implementation Plan\n\n### Test Categories\n\n#### 1. Basic Frontmatter Generation\n```typescript\ndescribe('generateFrontmatter', () =\u003e {\n  it('generates valid YAML frontmatter structure', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Test' });\n    expect(fm).toMatch(/^---\\n/);\n    expect(fm).toMatch(/\\n---$/);\n  });\n  \n  it('includes title field', () =\u003e {\n    const fm = generateFrontmatter({ title: 'My Note' });\n    expect(fm).toContain('title: My Note');\n  });\n  \n  it('includes created date in ISO format', () =\u003e {\n    const fm = generateFrontmatter({ \n      title: 'Test',\n      createdAt: new Date('2024-01-15T10:30:00Z')\n    });\n    expect(fm).toContain('created: 2024-01-15');\n  });\n  \n  it('includes updated date if different from created', () =\u003e {});\n});\n```\n\n#### 2. Tags Handling Tests\n```typescript\ndescribe('frontmatter tags', () =\u003e {\n  it('formats single tag as YAML array', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Test', tags: ['important'] });\n    expect(fm).toContain('tags:\\n  - important');\n  });\n  \n  it('formats multiple tags correctly', () =\u003e {\n    const fm = generateFrontmatter({ \n      title: 'Test', \n      tags: ['work', 'project', 'urgent'] \n    });\n    expect(fm).toContain('  - work');\n    expect(fm).toContain('  - project');\n    expect(fm).toContain('  - urgent');\n  });\n  \n  it('omits tags field if empty array', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Test', tags: [] });\n    expect(fm).not.toContain('tags:');\n  });\n});\n```\n\n#### 3. Special Character Escaping Tests\n```typescript\ndescribe('YAML special character handling', () =\u003e {\n  it('quotes title containing colon', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Meeting: Q1 Planning' });\n    expect(fm).toContain('title: \"Meeting: Q1 Planning\"');\n  });\n  \n  it('escapes quotes in title', () =\u003e {\n    const fm = generateFrontmatter({ title: 'The \"Big\" Meeting' });\n    expect(fm).toContain('title: \"The \\\\\"Big\\\\\" Meeting\"');\n  });\n  \n  it('handles newlines in title', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Line 1\\nLine 2' });\n    // Should use multiline YAML or escape\n  });\n  \n  it('handles special YAML characters: { } [ ] @ # \u0026', () =\u003e {});\n  \n  it('handles emoji in title', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Celebration  Party' });\n    expect(fm).toContain('Celebration');\n  });\n});\n```\n\n#### 4. Custom Fields Tests\n```typescript\ndescribe('custom frontmatter fields', () =\u003e {\n  it('includes custom string fields', () =\u003e {\n    const fm = generateFrontmatter({ \n      title: 'Test',\n      custom: { author: 'John Doe' }\n    });\n    expect(fm).toContain('author: John Doe');\n  });\n  \n  it('includes custom array fields', () =\u003e {});\n  it('includes custom nested objects', () =\u003e {});\n  it('handles null custom values', () =\u003e {});\n});\n```\n\n#### 5. Edge Cases\n```typescript\ndescribe('edge cases', () =\u003e {\n  it('handles empty title', () =\u003e {});\n  it('handles very long titles (\u003e100 chars)', () =\u003e {});\n  it('handles undefined optional fields', () =\u003e {});\n  it('produces parseable YAML (round-trip test)', () =\u003e {\n    const fm = generateFrontmatter({ title: 'Test', tags: ['a', 'b'] });\n    const parsed = YAML.parse(fm.slice(4, -4)); // strip ---\n    expect(parsed.title).toBe('Test');\n    expect(parsed.tags).toEqual(['a', 'b']);\n  });\n});\n```\n\n## Files to Create/Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/frontmatter.test.ts` | CREATE |\n\n## Verification\n\n```bash\n# Run tests\nbun test packages/shared/src/frontmatter.test.ts\n\n# Check coverage\nbun test packages/shared --coverage | grep frontmatter\n\n# Target: \u003e80% line coverage\n```\n\n## Success Criteria\n- [ ] All frontmatter generation paths tested\n- [ ] Coverage \u003e80% for frontmatter.ts\n- [ ] YAML output is parseable (round-trip verified)\n- [ ] Special characters handled correctly\n\n## Dependencies\n- **Blocks**: None (fully parallel)\n- **Blocked by**: None\n- **Related**: Used by content-extractor for markdown export\n\n## Estimated Effort\n- **Size**: Small (2 hours)\n- **Risk**: Low (well-defined output format)\n\n## Labels\n- testing\n- sprint-1\n- P1-critical\n- content-safety\n- export","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:20:46.927374-06:00","updated_at":"2025-12-25T22:56:29.745727-06:00","closed_at":"2025-12-25T22:56:29.745727-06:00","dependencies":[{"issue_id":"scribe-p2d.5","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:20:46.927756-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.6","title":"[Sprint 1.6] Remove duplicate formatDate from CLI output.ts","description":"# Remove Duplicate formatDate from CLI output.ts\n\n## Problem Statement\nThe `formatDate` function is duplicated in `apps/cli/src/output.ts` (lines 133-142) when the canonical implementation exists in `@scribe/shared` at `packages/shared/src/date-utils.ts`.\n\n## Why This Matters\n\n### Consistency Risk\nDifferent date formatting implementations can produce subtly different outputs:\n- Timezone handling differences\n- Locale-specific formatting\n- Edge cases (midnight, DST transitions)\n\n### Maintenance Burden\nEvery bug fix or improvement to date formatting needs to happen in 4 places. This is unsustainable and error-prone.\n\n### User Experience\nUsers expect consistent date formatting whether they use the CLI or desktop app. Duplicates make this harder to guarantee.\n\n## Current State\n\n### Duplicate Location\n```typescript\n// apps/cli/src/output.ts, lines 133-142\nfunction formatDate(date: Date): string {\n  // Local duplicate implementation\n}\n```\n\n### Canonical Location\n```typescript\n// packages/shared/src/date-utils.ts, lines 34-80\nexport function formatDate(date: Date, format?: string): string {\n  // Canonical implementation with full format support\n}\n```\n\n## Implementation Plan\n\n### Step 1: Add Import\n```typescript\n// At top of apps/cli/src/output.ts\nimport { formatDate } from '@scribe/shared';\n```\n\n### Step 2: Remove Local Function\nDelete lines 133-142 containing the local `formatDate` implementation.\n\n### Step 3: Verify Usage\nSearch for all usages of `formatDate` in output.ts and ensure they're compatible with the shared implementation signature.\n\n### Step 4: Run Tests\n```bash\nbun test apps/cli\n```\n\n### Step 5: Manual Verification\n```bash\n# Run CLI commands that use date formatting\nscribe list --recent\nscribe show \u003cnote-id\u003e\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `apps/cli/src/output.ts` | Remove duplicate, add import |\n\n## Verification\n\n```bash\n# Ensure no duplicate definitions\ngrep -n \"function formatDate\" apps/cli/src/\n\n# Should only show import, not definition\ngrep -n \"formatDate\" apps/cli/src/output.ts\n\n# Run tests\nbun test apps/cli\n```\n\n## Success Criteria\n- [ ] Local formatDate function removed\n- [ ] Import from @scribe/shared added\n- [ ] All CLI tests pass\n- [ ] Date formatting output unchanged\n\n## Dependencies\n- **Blocks**: None (fully parallel with other dedup tasks)\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small (30 minutes)\n- **Risk**: Low (well-tested shared function)\n\n## Labels\n- refactoring\n- sprint-1\n- P1-high\n- deduplication\n- cli","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:21:15.039303-06:00","updated_at":"2025-12-25T22:50:03.103085-06:00","closed_at":"2025-12-25T22:50:03.103085-06:00","dependencies":[{"issue_id":"scribe-p2d.6","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:21:15.039633-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.6","depends_on_id":"scribe-p2d.9","type":"blocks","created_at":"2025-12-25T22:26:37.6439-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.7","title":"[Sprint 1.7] Remove duplicate date functions from CLI daily.ts","description":"# Remove Duplicate Date Functions from CLI daily.ts\n\n## Problem Statement\nThe `formatDateYMD` and `formatDateTitle` functions are duplicated in `apps/cli/src/commands/daily.ts` (lines 17-31). These should use the canonical implementations from `@scribe/shared`.\n\n## Current Duplicates\n\n### formatDateYMD (lines 17-23)\n```typescript\n// apps/cli/src/commands/daily.ts\nfunction formatDateYMD(date: Date): string {\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n```\n\n### formatDateTitle (lines 25-31)\n```typescript\nfunction formatDateTitle(date: Date): string {\n  return date.toLocaleDateString('en-US', {\n    weekday: 'long',\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  });\n}\n```\n\n## Canonical Equivalents in @scribe/shared\n\n```typescript\n// packages/shared/src/date-utils.ts\nexport function formatDateYYYYMMDD(date: Date): string { ... }  // lines 34-45\nexport function formatDateFull(date: Date): string { ... }      // lines 130-149\n```\n\n## Implementation Plan\n\n### Step 1: Verify Canonical Functions\nEnsure the shared functions produce identical output:\n```typescript\n// Test that these are equivalent:\nformatDateYMD(date) === formatDateYYYYMMDD(date)\nformatDateTitle(date) === formatDateFull(date)\n```\n\n### Step 2: Add Imports\n```typescript\n// At top of apps/cli/src/commands/daily.ts\nimport { formatDateYYYYMMDD, formatDateFull } from '@scribe/shared';\n```\n\n### Step 3: Update Usages\nReplace local function calls:\n```typescript\n// Before\nconst dateStr = formatDateYMD(date);\nconst title = formatDateTitle(date);\n\n// After\nconst dateStr = formatDateYYYYMMDD(date);\nconst title = formatDateFull(date);\n```\n\n### Step 4: Remove Local Functions\nDelete lines 17-31 containing the duplicate implementations.\n\n### Step 5: Run Tests\n```bash\nbun test apps/cli\n```\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `apps/cli/src/commands/daily.ts` | Remove duplicates, update imports |\n\n## Verification\n\n```bash\n# Ensure no duplicate definitions\ngrep -n \"function formatDate\" apps/cli/src/commands/\n\n# Run tests\nbun test apps/cli\n\n# Test daily note creation\nscribe daily\nscribe daily --date 2024-01-15\n```\n\n## Success Criteria\n- [ ] Local formatDateYMD function removed\n- [ ] Local formatDateTitle function removed\n- [ ] Imports from @scribe/shared added\n- [ ] All CLI tests pass\n- [ ] Daily note dates formatted correctly\n\n## Dependencies\n- **Blocks**: None (fully parallel)\n- **Blocked by**: None\n\n## Estimated Effort\n- **Size**: Small (30 minutes)\n- **Risk**: Low\n\n## Labels\n- refactoring\n- sprint-1\n- P1-high\n- deduplication\n- cli","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:21:31.032881-06:00","updated_at":"2025-12-25T22:50:48.555959-06:00","closed_at":"2025-12-25T22:50:48.555959-06:00","dependencies":[{"issue_id":"scribe-p2d.7","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:21:31.033224-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.7","depends_on_id":"scribe-p2d.9","type":"blocks","created_at":"2025-12-25T22:26:37.816357-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.8","title":"[Sprint 1.8] Remove duplicate date functions from NoteHeader.tsx","description":"# Remove/Consolidate Date Functions from NoteHeader.tsx\n\n## Problem Statement\nThe `NoteHeader` component in `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.tsx` (lines 27-46) contains local date formatting and **parsing** implementations.\n\n## ⚠️ IMPORTANT: This is NOT a Simple Dedup\n\nUnlike the CLI tasks, NoteHeader uses **date-fns parsing**:\n\n```typescript\n// Line 39-45 - parses MM-dd-yyyy format string!\nfunction formatDateString(dateStr: string): string {\n  const date = parse(dateStr, 'MM-dd-yyyy', new Date());\n  return date.toLocaleDateString('en-US', { ... });\n}\n```\n\nThis is fundamentally different from the CLI duplicates because:\n1. It takes a **string in MM-dd-yyyy format**, not a Date object\n2. It uses date-fns `parse()` to convert the string to a Date\n3. The shared `formatDate` functions take Date objects, not formatted strings\n\n## Current Functions\n\n```typescript\n// Line 27-34: Simple timestamp formatting (CAN be replaced)\nfunction formatDate(timestamp: number): string { ... }\n\n// Line 39-45: String parsing + formatting (REQUIRES date-fns or extension)\nfunction formatDateString(dateStr: string): string { ... }\n```\n\n## Implementation Options\n\n### Option A: Keep date-fns for parsing\n```typescript\nimport { parse } from 'date-fns';\nimport { formatDate } from '@scribe/shared';\n\nfunction formatDateString(dateStr: string): string {\n  const date = parse(dateStr, 'MM-dd-yyyy', new Date());\n  return formatDate(date, 'short'); // Use shared for formatting only\n}\n```\n\n### Option B: Extend @scribe/shared with parser\nAdd to date-utils.ts:\n```typescript\nexport function parseDateString(dateStr: string, format: string): Date { ... }\n```\n\n### Option C: Use meeting.date as Date upstream\nIf meeting.date could be stored as timestamp instead of string, this becomes simpler.\n\n## Recommendation\n\n**Option A** - Keep date-fns for parsing, use shared for formatting:\n- Minimal change scope\n- Preserves existing behavior\n- date-fns is already a dependency\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `apps/desktop/renderer/src/components/NoteHeader/NoteHeader.tsx` | Partial refactor |\n\n## Success Criteria\n- [ ] `formatDate(timestamp)` replaced with shared import\n- [ ] `formatDateString` either kept or properly extended\n- [ ] Tests pass\n- [ ] Meeting notes display correct dates\n\n## Dependencies\n- **Blocked by**: scribe-p2d.9 (verify shared API)\n\n## Estimated Effort\n- **Size**: Medium (1 hour - more complex than CLI tasks)\n- **Risk**: Low-Medium (visual verification needed)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:21:46.716672-06:00","updated_at":"2025-12-25T22:51:32.820707-06:00","closed_at":"2025-12-25T22:51:32.820707-06:00","dependencies":[{"issue_id":"scribe-p2d.8","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:21:46.717125-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-p2d.8","depends_on_id":"scribe-p2d.9","type":"blocks","created_at":"2025-12-25T22:26:37.985097-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-p2d.9","title":"[Sprint 1.9] Verify @scribe/shared date-utils exports cover all dedup needs","description":"# Verify @scribe/shared Date-Utils Exports (PREREQUISITE)\n\n## Purpose\n**This task MUST be completed before scribe-p2d.6, .7, .8** - it verifies that `@scribe/shared` exports all the date utilities needed by CLI and desktop consumers.\n\n## Why This Task Exists\n\n### Dependency Awareness\nTasks 1.6, 1.7, 1.8 depend on this task's findings. If shared package is missing a function, we need to add it first.\n\n### API Design Opportunity\nThis is a chance to review the date-utils API:\n- Are function names clear and consistent?\n- Are there missing utilities that should be added?\n- Should we add format presets for common patterns?\n\n## Current Exports from @scribe/shared\n`packages/shared/src/date-utils.ts` already exports:\n\n| Function | Description |\n|----------|-------------|\n| `formatDate(date, style)` | Formats with 'short', 'medium', 'long', 'iso', 'time' |\n| `formatDateYMD(date)` | Returns 'YYYY-MM-DD' format |\n| `formatDateMMDDYYYY(date)` | Returns 'MM/DD/YYYY' format |\n| `formatDateTitle(date)` | Returns 'Month Day, Year' format |\n| `getRelativeDateString(timestamp)` | Returns relative time like '2 hours ago' |\n| `parseDate(dateString)` | Parses date string to Date |\n| `isToday(date)`, `isYesterday(date)` | Date comparisons |\n\n## Analysis Checklist\n\n### Compare Against Consumer Usage\n\n| Consumer | Current Usage | Shared Equivalent | Match? |\n|----------|---------------|-------------------|--------|\n| CLI output.ts:133 | `formatDate(iso)` → full datetime | `formatDate(date, 'time')` | Verify |\n| CLI daily.ts:17 | `formatDateYMD(date)` | `formatDateYMD(date)` | ✓ |\n| CLI daily.ts:24 | `formatDateTitle(dateStr)` | `formatDateTitle(date)` | Verify signature |\n| NoteHeader.tsx:27 | `formatDate(timestamp)` | `formatDate(date, 'medium')` | Verify |\n| NoteHeader.tsx:39 | `formatDateString(dateStr)` | May need to add | Check |\n\n## Implementation Plan\n\n### Step 1: Audit Consumer Usage\n```bash\n# Check exact signatures needed\ngrep -A5 'function formatDate' apps/cli/src/output.ts\ngrep -A5 'function formatDate' apps/cli/src/commands/daily.ts\ngrep -A5 'function formatDate' apps/desktop/renderer/src/components/NoteHeader/NoteHeader.tsx\n```\n\n### Step 2: Compare Output Formats\nRun the shared functions and compare output to consumer expectations.\n\n### Step 3: Add Missing Functions (if any)\nIf gaps are found, add the missing utilities to `packages/shared/src/date-utils.ts`.\n\n### Step 4: Update Barrel Export\nEnsure all functions are exported from `packages/shared/src/index.ts`.\n\n## Files to Potentially Modify\n\n| File | Action |\n|------|--------|\n| `packages/shared/src/date-utils.ts` | Add missing functions (if any) |\n| `packages/shared/src/index.ts` | Update exports (if needed) |\n\n## Verification\n\n```bash\n# Build shared package\nbun run build --filter=@scribe/shared\n\n# Verify exports\nbun run typecheck\n```\n\n## Success Criteria\n- [ ] All consumer date functions mapped to shared equivalents\n- [ ] Missing functions added (if any)\n- [ ] All functions exported from package barrel\n- [ ] Output format compatibility verified\n\n## Dependencies\n- **Blocks**: scribe-p2d.6, scribe-p2d.7, scribe-p2d.8 (they MUST wait for this)\n- **Blocked by**: None (START THIS FIRST!)\n\n## Estimated Effort\n- **Size**: Small-Medium (1-2 hours including analysis)\n- **Risk**: Low\n\n## Labels\n- refactoring\n- sprint-1\n- P1-high\n- deduplication\n- foundation\n- PREREQUISITE","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-25T22:22:06.163695-06:00","updated_at":"2025-12-25T22:49:14.997004-06:00","closed_at":"2025-12-25T22:49:14.997004-06:00","dependencies":[{"issue_id":"scribe-p2d.9","depends_on_id":"scribe-p2d","type":"parent-child","created_at":"2025-12-25T22:22:06.164088-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo","title":"Settings Page - Full Implementation (GH Issue #50)","description":"# Settings Page Epic\n\n## Overview\nThis epic implements a comprehensive Settings page for the Scribe desktop application, accessible via a gear icon in the sidebar footer. The settings page opens as a full-screen modal with a VS Code/macOS System Settings-style sidebar navigation pattern.\n\n## Background \u0026 Motivation\nCurrently, Scribe has limited configurability exposed to users:\n- Theme toggle is buried in the sidebar footer\n- Vault location is hardcoded/undiscoverable\n- Update checking requires manual intervention\n- No centralized place for user preferences\n\nA proper Settings page serves several goals:\n1. **Discoverability** - Users can find and modify all app preferences in one place\n2. **Professional UX** - Aligns with user expectations from VS Code, macOS, and modern Electron apps\n3. **Foundation for Growth** - Establishes patterns for future settings (CLI, spellcheck, plugins, etc.)\n4. **Vault Management** - Critical for users with multiple vaults or who need to relocate their data\n\n## Architecture Decision: Full-Screen Modal Pattern\nWe chose a full-screen modal (hiding the sidebar) rather than:\n- **Inline panel**: Would compete with editor space, complex state management\n- **Separate window**: Electron multi-window adds complexity, feels disconnected\n- **Route-based**: Would require router setup, loses context of current session\n\nThe full-screen modal pattern:\n- Familiar from macOS System Preferences, VS Code Settings\n- Clear entry/exit points (gear icon → modal → X/Escape)\n- Can reuse existing Overlay primitive for backdrop and escape handling\n- Sidebar navigation scales well as settings sections grow\n\n## Technical Approach\n\n### Phase 1: Infrastructure (Foundation)\nBuild reusable primitives and IPC infrastructure that enable the feature:\n1. **SegmentedControl** - New design system primitive for theme picker\n2. **Folder Picker IPC** - dialog:selectFolder for vault management\n3. **Vault IPC Channels** - vault:getPath, vault:setPath, vault:create\n\n### Phase 2: UI Shell (Scaffolding)\nBuild the settings page structure without full functionality:\n1. **Sidebar gear icon** - Replace footer with settings trigger\n2. **SettingsPage modal** - Full-screen container with sidebar layout\n3. **Section navigation** - General and Changelog sections\n\n### Phase 3: Settings Functionality (Features)\nImplement actual settings with full behavior:\n1. **Theme setting** - SegmentedControl with immediate apply\n2. **Version + Updates** - Display version, check/install updates\n3. **Vault display** - Show current path (read-only initially)\n4. **Vault switching** - Full hot-reload implementation\n5. **Create new vault** - initializeVault integration\n\n## Key Technical Challenges\n\n### Engine Hot-Reload (Most Complex)\nSwitching vaults at runtime requires:\n- Proper cleanup of existing FileSystemVault instance\n- Re-initialization of SearchEngine, GraphEngine, TaskEngine\n- Renderer state refresh (note list, current note, etc.)\n- Graceful handling of \"current note doesn't exist in new vault\"\n\n**Mitigation**: We'll implement vault switching in waves:\n1. First: Display current path (read-only)\n2. Second: Full switching with engine hot-reload\n3. Fallback: If hot-reload proves too risky, require app restart\n\n### State Synchronization\nSettings changes need to:\n- Persist to config.json (already exists via app:setConfig)\n- Reflect immediately in UI (theme, vault)\n- Handle errors gracefully (invalid vault, failed update)\n\n## Success Criteria\n1. Gear icon visible in sidebar footer, clickable to open settings\n2. Settings modal opens full-screen, closes via X or Escape\n3. Theme switching works immediately with Dark/Light/System options\n4. Version displayed, update checking functional\n5. Vault path displayed, switching to valid vaults works\n6. Create new vault initializes structure correctly\n\n## Out of Scope (Future Work)\n- CLI installation from Settings (separate feature)\n- Actual changelog content (placeholder only)\n- Keyboard shortcuts customization\n- Plugin management\n- Multiple simultaneous vaults\n\n## References\n- GitHub Issue: #50\n- Existing IPC contract: packages/shared/src/ipc-contract.ts\n- Theme system: packages/design-system/src/ThemeProvider.tsx\n- Update hooks: apps/desktop/renderer/src/hooks/useUpdateStatus.ts\n- Vault utilities: packages/storage-fs/src/vault.ts\n\n## Dependency Graph Summary\nWave 1 (Parallel - No blockers): SegmentedControl, Sidebar gear icon, Folder picker IPC, Vault IPC basics\nWave 2 (Depends on Wave 1): SettingsPage shell, Theme setting\nWave 3 (Depends on Wave 2): Version/Update section, Vault display\nWave 4 (Depends on Wave 3): Vault switching (engine hot-reload)\nWave 5 (Depends on Wave 4): Create new vault","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-23T14:56:09.822152-06:00","updated_at":"2025-12-24T11:17:11.668943-06:00","closed_at":"2025-12-24T11:17:11.668943-06:00"}
{"id":"scribe-roo.1","title":"Create SegmentedControl design system primitive","description":"# Create SegmentedControl Design System Primitive\n\n## What\nBuild a new reusable SegmentedControl component for the design system. This is a mutually exclusive toggle group (like iOS segmented controls or radio button groups styled as connected buttons).\n\n## Why\n- **Required for Theme Picker**: The Settings page needs Dark | Light | System options displayed as a segmented control per the spec\n- **Design System Gap**: No existing component handles this pattern\n- **Reusability**: This pattern will be useful elsewhere (view toggles, filter switches, etc.)\n\n## Technical Approach\n\n### Component API\n```typescript\ninterface SegmentedControlProps\u003cT extends string\u003e {\n  options: Array\u003c{ value: T; label: string; disabled?: boolean }\u003e;\n  value: T;\n  onChange: (value: T) =\u003e void;\n  size?: 'sm' | 'md' | 'lg';\n  fullWidth?: boolean;\n  disabled?: boolean;\n  'aria-label'?: string;\n}\n```\n\n### Styling Requirements\n- Connected buttons with shared border (first/last have rounded corners)\n- Active segment has distinct background (accent color or elevated surface)\n- Smooth transition between states (use vars.animation.duration.fast)\n- Keyboard navigation: arrow keys to move between options\n- Focus visible state on the entire group and active segment\n\n### CSS Variables to Use\n- `vars.color.surface` - Inactive segment background\n- `vars.color.accent` or `vars.color.backgroundAlt` - Active segment\n- `vars.color.border` - Shared border between segments\n- `vars.radius.md` - Corner radius for first/last segments\n- `vars.spacing.2`, `vars.spacing.3` - Internal padding\n\n### Accessibility\n- Role: `radiogroup` on container\n- Each segment: `role=\"radio\"`, `aria-checked`\n- Keyboard: Arrow keys navigate, Enter/Space select\n- Focus management: Roving tabindex pattern\n\n### Files to Create\n1. `SegmentedControl.tsx` - Main component\n2. `SegmentedControl.css.ts` - vanilla-extract styles\n3. `index.ts` - Barrel export\n4. `SegmentedControl.test.tsx` - Unit tests\n\n### Test Cases\n- Renders all options\n- Correct option selected on mount\n- onChange called with correct value on click\n- Keyboard navigation (arrow keys)\n- Disabled state (entire control and individual options)\n- Accessibility attributes present\n\n## Implementation Reference\nSimilar components for reference:\n- Radix UI ToggleGroup: https://www.radix-ui.com/primitives/docs/components/toggle-group\n- Headless UI RadioGroup: https://headlessui.com/react/radio-group\n\n## Parallel Safe\nYes - no dependencies on other tasks. Can be built independently.\n\n## Files\n- packages/design-system/src/primitives/SegmentedControl/SegmentedControl.tsx\n- packages/design-system/src/primitives/SegmentedControl/SegmentedControl.css.ts\n- packages/design-system/src/primitives/SegmentedControl/index.ts\n- packages/design-system/src/primitives/SegmentedControl/SegmentedControl.test.tsx\n- packages/design-system/src/index.ts (add export)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:56:09.88867-06:00","updated_at":"2025-12-23T19:16:17.084862-06:00","closed_at":"2025-12-23T19:16:17.084862-06:00","dependencies":[{"issue_id":"scribe-roo.1","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:09.889037-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.10","title":"Implement theme setting with SegmentedControl","description":"# Implement Theme Setting with SegmentedControl\n\n## What\nBuild the theme setting UI using the new SegmentedControl component, integrating with the existing useTheme hook.\n\n## Why\n- **Core Settings Feature**: Theme switching is one of the most commonly used settings\n- **Demonstrates SegmentedControl**: First real usage of the new primitive\n- **Leverages Existing Infrastructure**: useTheme hook already handles persistence and system preference detection\n\n## Technical Approach\n\n### Component Implementation\n```tsx\n// ThemeSetting.tsx (or inline in GeneralSettings.tsx)\nimport { SegmentedControl } from '@scribe/design-system';\nimport { useTheme } from '@scribe/design-system';\n\nexport function ThemeSetting() {\n  const { theme, setTheme } = useTheme();\n  \n  const options = [\n    { value: 'dark', label: 'Dark' },\n    { value: 'light', label: 'Light' },\n    { value: 'system', label: 'System' },\n  ];\n  \n  return (\n    \u003cSegmentedControl\n      options={options}\n      value={theme}\n      onChange={setTheme}\n      aria-label=\"Theme preference\"\n    /\u003e\n  );\n}\n```\n\n### Integration with GeneralSettings\n```tsx\n// In GeneralSettings.tsx\n\u003cSettingsGroup title=\"Theme\"\u003e\n  \u003cThemeSetting /\u003e\n\u003c/SettingsGroup\u003e\n```\n\n### Behavior\n- **Immediate Apply**: Theme changes instantly when user clicks a segment\n- **Persistence**: useTheme hook already persists to config.json via ThemeStorage adapter\n- **System Detection**: \"System\" option follows OS dark/light preference via media query\n\n### Existing Infrastructure (No Changes Needed)\nThe useTheme hook already provides:\n```typescript\ninterface ThemeContextValue {\n  theme: Theme;                        // User's preference ('dark' | 'light' | 'system')\n  resolvedTheme: 'light' | 'dark';     // Actual applied theme\n  setTheme: (theme: Theme) =\u003e void;    // Persists and applies\n}\n```\n\nThe ThemeProvider already:\n- Loads from config.json on mount\n- Saves to config.json on change\n- Listens to `prefers-color-scheme: dark` media query\n- Applies theme class to document.documentElement\n\n### UX Considerations\n- **Visual Feedback**: Active segment should clearly stand out\n- **System Label**: Consider showing \"(Dark)\" or \"(Light)\" next to \"System\" to indicate resolved value\n- **No Confirmation**: Changes apply immediately, no save button needed\n\n### Enhanced: Show Resolved Theme for System\n```tsx\nexport function ThemeSetting() {\n  const { theme, resolvedTheme, setTheme } = useTheme();\n  \n  const options = [\n    { value: 'dark', label: 'Dark' },\n    { value: 'light', label: 'Light' },\n    { \n      value: 'system', \n      label: theme === 'system' \n        ? `System (${resolvedTheme === 'dark' ? 'Dark' : 'Light'})` \n        : 'System' \n    },\n  ];\n  \n  return (\n    \u003cSegmentedControl\n      options={options}\n      value={theme}\n      onChange={setTheme}\n      aria-label=\"Theme preference\"\n    /\u003e\n  );\n}\n```\n\n## BLOCKED BY\n- scribe-roo.1 (SegmentedControl primitive) - Need the component\n- scribe-roo.8 (GeneralSettings structure) - Need the container\n\n## Files\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx (add ThemeSetting)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.513271-06:00","updated_at":"2025-12-24T11:07:27.530564-06:00","closed_at":"2025-12-24T11:07:27.530564-06:00","dependencies":[{"issue_id":"scribe-roo.10","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.514023-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.10","depends_on_id":"scribe-roo.1","type":"blocks","created_at":"2025-12-23T15:01:07.392049-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.10","depends_on_id":"scribe-roo.8","type":"blocks","created_at":"2025-12-23T15:01:07.443377-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.11","title":"Implement version display and update checking UI","description":"# Implement Version Display and Update Checking UI\n\n## What\nBuild the version and update checking section in GeneralSettings, showing current version and providing update management.\n\n## Why\n- **User Visibility**: Users should know what version they're running\n- **Update Management**: Centralized place for checking and installing updates\n- **Leverages Existing Hook**: useUpdateStatus already tracks all update states\n\n## Technical Approach\n\n### Component Implementation\n```tsx\n// VersionSetting.tsx\nimport { Button, Text } from '@scribe/design-system';\nimport { useUpdateStatus } from '../../../hooks/useUpdateStatus';\n\nexport function VersionSetting() {\n  const { status, version, error, installUpdate } = useUpdateStatus();\n  \n  const checkForUpdates = () =\u003e {\n    window.scribe.update.check();\n  };\n  \n  return (\n    \u003cdiv className={styles.versionSetting}\u003e\n      \u003cText variant=\"body\"\u003ev{__APP_VERSION__}\u003c/Text\u003e\n      \n      \u003cdiv className={styles.updateControls}\u003e\n        {renderUpdateButton()}\n        {renderStatusMessage()}\n      \u003c/div\u003e\n    \u003c/div\u003e\n  );\n  \n  function renderUpdateButton() {\n    switch (status) {\n      case 'idle':\n        return \u003cButton onClick={checkForUpdates}\u003eCheck for Updates\u003c/Button\u003e;\n      case 'checking':\n        return \u003cButton disabled\u003eChecking...\u003c/Button\u003e;\n      case 'downloading':\n        return \u003cButton disabled\u003eDownloading...\u003c/Button\u003e;\n      case 'ready':\n        return \u003cButton onClick={installUpdate}\u003eRestart to Update\u003c/Button\u003e;\n      case 'error':\n        return \u003cButton onClick={checkForUpdates}\u003eRetry Check\u003c/Button\u003e;\n    }\n  }\n  \n  function renderStatusMessage() {\n    switch (status) {\n      case 'ready':\n        return \u003cText variant=\"body\" color=\"success\"\u003eUpdate ready: v{version}\u003c/Text\u003e;\n      case 'error':\n        return \u003cText variant=\"body\" color=\"danger\"\u003e{error}\u003c/Text\u003e;\n      default:\n        return null;\n    }\n  }\n}\n```\n\n### State Machine (from useUpdateStatus)\n```\nidle -\u003e checking -\u003e downloading -\u003e ready\n  |        |            |           |\n  v        v            v           v\nerror   (idle)       (idle)     (restart)\n```\n\n### Update Flow\n1. **Idle**: Show \"Check for Updates\" button\n2. **Checking**: Show \"Checking...\" (disabled)\n3. **Downloading**: Show \"Downloading...\" (disabled)\n4. **Ready**: Show \"Restart to Update\" (enabled, calls installUpdate)\n5. **Error**: Show error message, \"Retry Check\" button\n\n### After \"No Update Available\"\nThe useUpdateStatus hook returns to 'idle' when no update is found. We could enhance to show a brief \"You're up to date\" message:\n```tsx\nconst [lastCheckResult, setLastCheckResult] = useState\u003c'none' | 'up-to-date' | null\u003e(null);\n\n// After checking completes with no update\nuseEffect(() =\u003e {\n  if (status === 'idle' \u0026\u0026 lastStatus === 'checking') {\n    setLastCheckResult('up-to-date');\n    setTimeout(() =\u003e setLastCheckResult(null), 3000);\n  }\n}, [status]);\n```\n\n### Toast on Download Complete\nThe spec mentions showing the existing toast notification when download completes. This already happens via UpdateToast component in App.tsx. No changes needed.\n\n### Styling\n```typescript\n// Add to GeneralSettings.css.ts\nexport const versionSetting = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[2],\n});\n\nexport const updateControls = style({\n  display: 'flex',\n  alignItems: 'center',\n  gap: vars.spacing[3],\n});\n```\n\n## BLOCKED BY\n- scribe-roo.8 (GeneralSettings structure) - Need the container\n\n## Files\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx (add VersionSetting)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.581522-06:00","updated_at":"2025-12-24T11:10:23.386708-06:00","closed_at":"2025-12-24T11:10:23.386708-06:00","dependencies":[{"issue_id":"scribe-roo.11","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.582402-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.11","depends_on_id":"scribe-roo.8","type":"blocks","created_at":"2025-12-23T15:01:07.491226-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.12","title":"Create useVaultPath hook for vault state management","description":"# Create useVaultPath Hook for Vault State Management\n\n## What\nCreate a custom hook that manages vault path state: fetching current path, tracking loading/error states, and providing methods to change vaults.\n\n## Why\n- **Centralized Vault State**: Keep vault-related state and logic in one place\n- **Loading States**: Handle async vault operations gracefully\n- **Error Handling**: Manage validation errors from vault switching\n- **Reusability**: Can be used in GeneralSettings and potentially elsewhere\n\n## Technical Approach\n\n### Hook API\n```typescript\n// useVaultPath.ts\nexport interface UseVaultPathReturn {\n  // Current vault state\n  path: string | null;\n  isLoading: boolean;\n  error: string | null;\n  \n  // Actions\n  refresh: () =\u003e Promise\u003cvoid\u003e;\n  setVaultPath: (newPath: string) =\u003e Promise\u003cVaultSwitchResult\u003e;\n  createVault: (newPath: string) =\u003e Promise\u003cVaultCreateResult\u003e;\n  validatePath: (path: string) =\u003e Promise\u003cVaultValidationResult\u003e;\n  \n  // Derived state\n  isValid: boolean;\n}\n\nexport function useVaultPath(): UseVaultPathReturn {\n  const [path, setPath] = useState\u003cstring | null\u003e(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState\u003cstring | null\u003e(null);\n  \n  // Fetch current vault path on mount\n  useEffect(() =\u003e {\n    refresh();\n  }, []);\n  \n  const refresh = useCallback(async () =\u003e {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const currentPath = await window.scribe.vault.getPath();\n      setPath(currentPath);\n    } catch (err) {\n      setError('Failed to load vault path');\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n  \n  const setVaultPath = useCallback(async (newPath: string) =\u003e {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const result = await window.scribe.vault.setPath(newPath);\n      if (result.success) {\n        setPath(result.path);\n      } else {\n        setError(result.error || 'Failed to switch vault');\n      }\n      return result;\n    } catch (err) {\n      const errorMsg = 'Failed to switch vault';\n      setError(errorMsg);\n      return { success: false, path: newPath, error: errorMsg };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n  \n  const createVault = useCallback(async (newPath: string) =\u003e {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const result = await window.scribe.vault.create(newPath);\n      if (result.success) {\n        setPath(result.path);\n      } else {\n        setError(result.error || 'Failed to create vault');\n      }\n      return result;\n    } catch (err) {\n      const errorMsg = 'Failed to create vault';\n      setError(errorMsg);\n      return { success: false, path: newPath, error: errorMsg };\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n  \n  const validatePath = useCallback(async (pathToValidate: string) =\u003e {\n    try {\n      return await window.scribe.vault.validate(pathToValidate);\n    } catch {\n      return { valid: false, missingDirs: ['unknown'] };\n    }\n  }, []);\n  \n  return {\n    path,\n    isLoading,\n    error,\n    refresh,\n    setVaultPath,\n    createVault,\n    validatePath,\n    isValid: path !== null \u0026\u0026 !error,\n  };\n}\n```\n\n### Usage in GeneralSettings\n```tsx\nfunction VaultLocationSetting() {\n  const { path, isLoading, error, setVaultPath, createVault } = useVaultPath();\n  \n  if (isLoading \u0026\u0026 !path) {\n    return \u003cText variant=\"body\" color=\"muted\"\u003eLoading...\u003c/Text\u003e;\n  }\n  \n  return (\n    \u003cdiv\u003e\n      \u003cText variant=\"code\"\u003e{path}\u003c/Text\u003e\n      {error \u0026\u0026 \u003cText variant=\"body\" color=\"danger\"\u003e{error}\u003c/Text\u003e}\n      \u003cdiv className={styles.vaultButtons}\u003e\n        \u003cButton onClick={handleChange}\u003eChange\u003c/Button\u003e\n        \u003cButton onClick={handleCreateNew}\u003eCreate New\u003c/Button\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Error States\nThe hook tracks:\n- **Load errors**: Failed to fetch current path\n- **Switch errors**: Invalid vault, permission denied\n- **Create errors**: Path exists, permission denied\n\n## BLOCKED BY\n- scribe-roo.3 (Vault IPC handlers) - Need window.scribe.vault API\n\n## UNBLOCKS\n- scribe-roo.13 (Vault path display)\n- scribe-roo.15 (Vault switching UI)\n- scribe-roo.16 (Create new vault)\n\n## Files\n- apps/desktop/renderer/src/hooks/useVaultPath.ts (NEW)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.649771-06:00","updated_at":"2025-12-23T15:07:42.785943-06:00","closed_at":"2025-12-23T15:07:42.785943-06:00","dependencies":[{"issue_id":"scribe-roo.12","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.650357-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.12","depends_on_id":"scribe-roo.3","type":"blocks","created_at":"2025-12-23T15:01:07.536607-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.13","title":"Implement vault path display (read-only)","description":"# Implement Vault Path Display (Read-Only)\n\n## What\nDisplay the current vault path in GeneralSettings. This is the first step before implementing full vault switching.\n\n## Why\n- **User Visibility**: Users should know where their notes are stored\n- **Incremental Delivery**: Ship read-only display before full switching capability\n- **Foundation**: UI structure needed for vault management buttons\n\n## Technical Approach\n\n### Component Implementation\n```tsx\n// VaultLocationSetting.tsx\nimport { Text, Button } from '@scribe/design-system';\nimport { useVaultPath } from '../../../hooks/useVaultPath';\n\nexport function VaultLocationSetting() {\n  const { path, isLoading, error } = useVaultPath();\n  \n  if (isLoading) {\n    return (\n      \u003cdiv className={styles.vaultLocation}\u003e\n        \u003cText variant=\"body\" color=\"muted\"\u003eLoading vault path...\u003c/Text\u003e\n      \u003c/div\u003e\n    );\n  }\n  \n  if (error) {\n    return (\n      \u003cdiv className={styles.vaultLocation}\u003e\n        \u003cText variant=\"body\" color=\"danger\"\u003e{error}\u003c/Text\u003e\n      \u003c/div\u003e\n    );\n  }\n  \n  return (\n    \u003cdiv className={styles.vaultLocation}\u003e\n      \u003cText variant=\"code\" className={styles.vaultPath}\u003e\n        {path}\n      \u003c/Text\u003e\n      \n      \u003cdiv className={styles.vaultActions}\u003e\n        \u003cButton variant=\"secondary\" disabled\u003e\n          Change\n        \u003c/Button\u003e\n        \u003cButton variant=\"secondary\" disabled\u003e\n          Create New\n        \u003c/Button\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Path Display Styling\n```typescript\n// Add to GeneralSettings.css.ts\nexport const vaultLocation = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[3],\n});\n\nexport const vaultPath = style({\n  fontFamily: 'var(--font-mono)',\n  backgroundColor: vars.color.backgroundAlt,\n  padding: `${vars.spacing[2]} ${vars.spacing[3]}`,\n  borderRadius: vars.radius.sm,\n  wordBreak: 'break-all',  // Handle long paths\n});\n\nexport const vaultActions = style({\n  display: 'flex',\n  gap: vars.spacing[2],\n});\n```\n\n### Initial State (Buttons Disabled)\nFor this task, buttons are disabled placeholders. They'll be enabled in subsequent tasks:\n- **Change**: Enabled in scribe-roo.15\n- **Create New**: Enabled in scribe-roo.16\n\n### Path Truncation (Optional)\nFor very long paths, consider truncating with ellipsis in the middle:\n```typescript\nfunction truncatePath(path: string, maxLength = 50): string {\n  if (path.length \u003c= maxLength) return path;\n  \n  const start = path.slice(0, 20);\n  const end = path.slice(-25);\n  return `${start}...${end}`;\n}\n```\n\nOr use CSS text-overflow with a title attribute for full path on hover.\n\n### Accessibility\n- Path should be selectable for copy/paste\n- Consider adding a \"Copy path\" button for convenience\n\n## BLOCKED BY\n- scribe-roo.8 (GeneralSettings structure) - Need the container\n- scribe-roo.12 (useVaultPath hook) - Need the data hook\n\n## UNBLOCKS\n- scribe-roo.15 (Vault switching UI)\n\n## Files\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx (add VaultLocationSetting)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.718636-06:00","updated_at":"2025-12-23T19:35:03.550706-06:00","closed_at":"2025-12-23T19:35:03.550706-06:00","dependencies":[{"issue_id":"scribe-roo.13","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.719083-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.13","depends_on_id":"scribe-roo.8","type":"blocks","created_at":"2025-12-23T15:01:07.583518-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.13","depends_on_id":"scribe-roo.3","type":"blocks","created_at":"2025-12-23T15:11:22.986261-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.14","title":"Implement vault switching backend (restart-based MVP)","description":"# Implement Vault Switching (Restart Required - MVP)\n\n## What\nImplement vault switching that requires an app restart. This is the **safe MVP approach** - full hot-reload is a stretch goal in a separate task.\n\n## Why\n- **Lower Risk**: App restart is a known-safe state transition\n- **Simpler Implementation**: No engine cleanup/re-initialization logic needed\n- **User Acceptable**: Most settings changes in desktop apps require restart\n- **Foundation**: Config persistence is needed for hot-reload anyway\n\n## Technical Approach\n\n### Implementation (Simple)\n```typescript\n// In vaultHandlers.ts\nipcMain.handle(IPC_CHANNELS.VAULT_SET_PATH, async (_, newPath: string) =\u003e {\n  // 1. Validate the new path is a valid vault\n  const isValid = await isValidVault(newPath);\n  if (!isValid) {\n    return { \n      success: false, \n      path: newPath, \n      error: 'Not a valid Scribe vault. Missing required folders.' \n    };\n  }\n  \n  // 2. Save new path to config\n  const config = await loadConfig();\n  await saveConfig({ ...config, vaultPath: newPath });\n  \n  // 3. Return success with restart required flag\n  return { \n    success: true, \n    path: newPath, \n    requiresRestart: true \n  };\n});\n```\n\n### UI Flow\n1. User selects new vault via folder picker\n2. System validates it's a valid vault\n3. If valid: Save path to config, show \"Restart Required\" dialog\n4. User clicks \"Restart Now\" → app.relaunch() + app.exit()\n5. On restart, app loads with new vault path from config\n\n### Config Integration\n```typescript\n// AppConfig extension\ninterface AppConfig {\n  lastOpenedNoteId?: string;\n  theme?: 'light' | 'dark' | 'system';\n  vaultPath?: string;  // NEW\n}\n```\n\n### Restart Dialog\n```tsx\n// In GeneralSettings after successful vault switch\n\u003cDialog\u003e\n  \u003cDialogTitle\u003eRestart Required\u003c/DialogTitle\u003e\n  \u003cDialogContent\u003e\n    Scribe needs to restart to switch to the new vault.\n  \u003c/DialogContent\u003e\n  \u003cDialogActions\u003e\n    \u003cButton onClick={handleRestartLater}\u003eLater\u003c/Button\u003e\n    \u003cButton onClick={handleRestartNow} variant=\"primary\"\u003eRestart Now\u003c/Button\u003e\n  \u003c/DialogActions\u003e\n\u003c/Dialog\u003e\n```\n\n### Main Process: Load Vault from Config\n```typescript\n// In main.ts initialization\nconst config = await loadConfig();\nconst vaultPath = config.vaultPath || getDefaultVaultPath();\nconst vault = new FileSystemVault(createVaultPath(vaultPath));\n```\n\n## Scope\n- Vault path validation ✓\n- Config persistence ✓\n- Restart dialog UI ✓\n- app.relaunch() integration ✓\n- **NOT in scope**: Engine hot-reload (separate stretch goal task)\n\n## Files\n- apps/desktop/electron/main/src/handlers/vaultHandlers.ts\n- apps/desktop/electron/main/src/main.ts (load vault from config)\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx (restart dialog)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:56:10.788654-06:00","updated_at":"2025-12-23T19:30:18.966012-06:00","closed_at":"2025-12-23T19:30:18.966012-06:00","dependencies":[{"issue_id":"scribe-roo.14","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.789417-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.14","depends_on_id":"scribe-roo.3","type":"blocks","created_at":"2025-12-23T15:01:15.912593-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.14","depends_on_id":"scribe-roo.21","type":"blocks","created_at":"2025-12-23T15:11:41.398372-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.15","title":"Implement vault switching UI with validation","description":"# Implement Vault Switching UI with Validation\n\n## What\nEnable the \"Change\" button in vault settings, allowing users to select and switch to a different vault folder. Uses the restart-based approach (not hot-reload).\n\n## Why\n- **Primary Vault Management Feature**: Users need to switch between vaults\n- **Validation Feedback**: Clear errors when selected folder isn't a valid vault\n- **Complete User Flow**: From folder selection to restart prompt\n\n## Technical Approach\n\n### UI Flow (Restart-Based)\n1. User clicks \"Change\" button\n2. Native folder picker opens (via dialog:selectFolder)\n3. User selects a folder\n4. System validates the folder is a valid vault\n5. If invalid: Show inline error message\n6. If valid: Save to config, show restart dialog\n7. User clicks \"Restart Now\" or \"Later\"\n\n### Component Implementation\n```tsx\nfunction VaultLocationSetting() {\n  const [currentPath, setCurrentPath] = useState\u003cstring | null\u003e(null);\n  const [validationError, setValidationError] = useState\u003cstring | null\u003e(null);\n  const [showRestartDialog, setShowRestartDialog] = useState(false);\n  \n  // Load current vault path on mount\n  useEffect(() =\u003e {\n    window.scribe.vault.getPath().then(setCurrentPath);\n  }, []);\n  \n  const handleChangeVault = async () =\u003e {\n    setValidationError(null);\n    \n    // 1. Open folder picker\n    const selectedPath = await window.scribe.dialog.selectFolder({\n      title: 'Select Scribe Vault',\n      defaultPath: currentPath || undefined,\n    });\n    \n    if (!selectedPath) return; // User cancelled\n    \n    // 2. Validate and set path (handler does validation)\n    const result = await window.scribe.vault.setPath(selectedPath);\n    \n    if (!result.success) {\n      setValidationError(result.error || 'Failed to switch vault');\n      return;\n    }\n    \n    // 3. Show restart dialog\n    if (result.requiresRestart) {\n      setShowRestartDialog(true);\n    }\n  };\n  \n  return (\n    \u003cdiv\u003e\n      \u003cText variant=\"code\"\u003e{currentPath}\u003c/Text\u003e\n      {validationError \u0026\u0026 \u003cText color=\"danger\"\u003e{validationError}\u003c/Text\u003e}\n      \u003cButton onClick={handleChangeVault}\u003eChange\u003c/Button\u003e\n      \n      {showRestartDialog \u0026\u0026 (\n        \u003cRestartDialog \n          onRestartNow={() =\u003e window.scribe.app.relaunch()}\n          onLater={() =\u003e setShowRestartDialog(false)}\n        /\u003e\n      )}\n    \u003c/div\u003e\n  );\n}\n```\n\n### Restart Dialog\n```tsx\nfunction RestartDialog({ onRestartNow, onLater }) {\n  return (\n    \u003cOverlay open onClose={onLater}\u003e\n      \u003cSurface\u003e\n        \u003cText variant=\"heading3\"\u003eRestart Required\u003c/Text\u003e\n        \u003cText\u003eScribe needs to restart to use the new vault.\u003c/Text\u003e\n        \u003cdiv\u003e\n          \u003cButton variant=\"secondary\" onClick={onLater}\u003eLater\u003c/Button\u003e\n          \u003cButton variant=\"primary\" onClick={onRestartNow}\u003eRestart Now\u003c/Button\u003e\n        \u003c/div\u003e\n      \u003c/Surface\u003e\n    \u003c/Overlay\u003e\n  );\n}\n```\n\n### Error Messages (per spec)\n- Invalid vault: \"Not a valid Scribe vault. Missing required folders.\"\n\n## Dependencies\n- scribe-roo.2 (Folder picker IPC) - Need dialog:selectFolder\n- scribe-roo.3 (Vault IPC handlers) - Need vault:setPath, vault:validate  \n- scribe-roo.13 (Vault display) - Need existing UI structure\n- scribe-roo.14 (Vault switching backend) - Need restart-based switching logic\n\nNote: Does NOT require hot-reload (scribe-roo.19). Restart is acceptable for MVP.\n\n## Files\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.857309-06:00","updated_at":"2025-12-24T11:10:45.97019-06:00","closed_at":"2025-12-24T11:10:45.97019-06:00","dependencies":[{"issue_id":"scribe-roo.15","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.857995-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.15","depends_on_id":"scribe-roo.2","type":"blocks","created_at":"2025-12-23T15:01:15.962011-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.15","depends_on_id":"scribe-roo.3","type":"blocks","created_at":"2025-12-23T15:01:16.006785-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.15","depends_on_id":"scribe-roo.13","type":"blocks","created_at":"2025-12-23T15:01:16.096382-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.15","depends_on_id":"scribe-roo.14","type":"blocks","created_at":"2025-12-23T15:01:16.14141-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.15","depends_on_id":"scribe-roo.21","type":"blocks","created_at":"2025-12-23T15:11:41.44607-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.16","title":"Implement create new vault functionality","description":"# Implement Create New Vault Functionality\n\n## What\nEnable the \"Create New\" button to create a fresh vault at a user-selected location, then prompt for restart.\n\n## Why\n- **New User Onboarding**: First-time users need to create their initial vault\n- **Multiple Vaults**: Power users may want separate vaults for different purposes\n\n## Technical Approach\n\n### UI Flow (Restart-Based)\n1. User clicks \"Create New\" button\n2. Native folder picker opens\n3. User selects a location\n4. System calls vault:create to initialize vault structure\n5. If success: Show restart dialog\n6. On restart: App loads with new vault\n\n### Component Implementation\n```tsx\nconst handleCreateVault = async () =\u003e {\n  const selectedPath = await window.scribe.dialog.selectFolder({\n    title: 'Choose Location for New Vault',\n  });\n  \n  if (!selectedPath) return;\n  \n  const result = await window.scribe.vault.create(selectedPath);\n  \n  if (!result.success) {\n    setCreationError(result.error);\n    return;\n  }\n  \n  // Show restart dialog (vault:create sets config)\n  setShowRestartDialog(true);\n};\n```\n\n### Backend Handler\n```typescript\nipcMain.handle(IPC_CHANNELS.VAULT_CREATE, async (_, path: string) =\u003e {\n  // Check if vault already exists\n  const exists = await isValidVault(path);\n  if (exists) {\n    return { success: false, error: 'A vault already exists here' };\n  }\n  \n  // Create vault structure\n  await initializeVault(createVaultPath(path));\n  \n  // Save to config for restart\n  await saveConfig({ ...config, vaultPath: path });\n  \n  return { success: true, path, requiresRestart: true };\n});\n```\n\n### Vault Structure Created\n```\nselected-path/\n├── notes/\n└── quarantine/\n```\n\n## Dependencies\n- scribe-roo.2 (Folder picker)\n- scribe-roo.3 (Vault IPC)\n- scribe-roo.14 (Vault switching backend - for config persistence)\n- scribe-roo.15 (Vault switching UI - for restart dialog pattern)\n\n## Files\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx\n- apps/desktop/electron/main/src/handlers/vaultHandlers.ts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.927967-06:00","updated_at":"2025-12-24T11:12:47.664715-06:00","closed_at":"2025-12-24T11:12:47.664715-06:00","dependencies":[{"issue_id":"scribe-roo.16","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.92858-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.16","depends_on_id":"scribe-roo.2","type":"blocks","created_at":"2025-12-23T15:01:23.608534-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.16","depends_on_id":"scribe-roo.3","type":"blocks","created_at":"2025-12-23T15:01:23.660811-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.16","depends_on_id":"scribe-roo.14","type":"blocks","created_at":"2025-12-23T15:01:23.757372-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.16","depends_on_id":"scribe-roo.15","type":"blocks","created_at":"2025-12-23T15:01:23.804487-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.17","title":"Add integration tests for Settings page","description":"# Add Integration Tests for Settings Page\n\n## What\nCreate comprehensive integration tests for the Settings page functionality.\n\n## Why\n- **Confidence**: Ensure settings page works end-to-end\n- **Regression Prevention**: Catch breaking changes in future updates\n- **Documentation**: Tests serve as living documentation of expected behavior\n\n## Technical Approach\n\n### Test Structure\n```typescript\n// settings.integration.test.ts\ndescribe('Settings Page', () =\u003e {\n  describe('Opening/Closing', () =\u003e {\n    it('opens settings when gear icon is clicked');\n    it('closes settings when X button is clicked');\n    it('closes settings when Escape key is pressed');\n    it('opens with General section selected by default');\n  });\n  \n  describe('Section Navigation', () =\u003e {\n    it('switches to Changelog section when clicked');\n    it('switches back to General section when clicked');\n    it('maintains section selection while open');\n  });\n  \n  describe('Theme Setting', () =\u003e {\n    it('displays current theme selection');\n    it('changes theme to Dark when Dark segment clicked');\n    it('changes theme to Light when Light segment clicked');\n    it('changes theme to System when System segment clicked');\n    it('persists theme selection after closing settings');\n  });\n  \n  describe('Version Setting', () =\u003e {\n    it('displays current app version');\n    it('shows Check for Updates button in idle state');\n    it('shows Checking... when update check in progress');\n    it('shows Restart to Update when update ready');\n  });\n  \n  describe('Vault Location', () =\u003e {\n    it('displays current vault path');\n    it('opens folder picker when Change button clicked');\n    it('shows error for invalid vault selection');\n    it('switches vault when valid vault selected');\n    it('creates new vault when Create New selected');\n  });\n});\n```\n\n### Test Setup\n```typescript\n// Test setup with mock vault\nbeforeEach(async () =\u003e {\n  testContext = await setupTestContext();\n  // Create test vaults for switching tests\n  testVault1 = await createTestVault('vault-1');\n  testVault2 = await createTestVault('vault-2');\n});\n\nafterEach(async () =\u003e {\n  await cleanupTestContext(testContext);\n  await cleanupTestVault(testVault1);\n  await cleanupTestVault(testVault2);\n});\n```\n\n### Key Test Scenarios\n\n#### Theme Switching\n```typescript\nit('changes theme to Dark when Dark segment clicked', async () =\u003e {\n  // Open settings\n  await clickGearIcon();\n  \n  // Click Dark segment\n  const darkSegment = screen.getByRole('radio', { name: /dark/i });\n  await userEvent.click(darkSegment);\n  \n  // Verify theme changed\n  expect(document.documentElement.classList.contains('darkTheme')).toBe(true);\n  \n  // Verify persisted to config\n  const config = await window.scribe.app.getConfig();\n  expect(config.theme).toBe('dark');\n});\n```\n\n#### Vault Switching\n```typescript\nit('switches vault when valid vault selected', async () =\u003e {\n  // Mock folder picker to return testVault2 path\n  vi.spyOn(window.scribe.dialog, 'selectFolder').mockResolvedValue(testVault2.path);\n  \n  // Open settings and click Change\n  await clickGearIcon();\n  await userEvent.click(screen.getByText('Change'));\n  \n  // Wait for switch to complete\n  await waitFor(() =\u003e {\n    expect(screen.getByText(testVault2.path)).toBeInTheDocument();\n  });\n  \n  // Verify note list refreshed\n  const notes = await window.scribe.notes.list();\n  expect(notes).toEqual(testVault2.expectedNotes);\n});\n```\n\n#### Invalid Vault Error\n```typescript\nit('shows error for invalid vault selection', async () =\u003e {\n  // Mock folder picker to return invalid path\n  const invalidPath = '/tmp/not-a-vault';\n  vi.spyOn(window.scribe.dialog, 'selectFolder').mockResolvedValue(invalidPath);\n  \n  // Open settings and click Change\n  await clickGearIcon();\n  await userEvent.click(screen.getByText('Change'));\n  \n  // Verify error shown\n  expect(screen.getByText(/not a valid scribe vault/i)).toBeInTheDocument();\n  \n  // Verify vault path unchanged\n  expect(screen.getByText(testVault1.path)).toBeInTheDocument();\n});\n```\n\n### Test Coverage Goals\n- All happy paths for settings interactions\n- Error states for vault operations\n- Keyboard navigation (Escape to close)\n- State persistence (theme, vault path)\n- UI state management (loading, disabled buttons)\n\n## BLOCKED BY\n- scribe-roo.7 (App.tsx integration) - Need complete Settings page\n- scribe-roo.15 (Vault switching UI) - Need vault switching implemented\n- scribe-roo.16 (Create new vault) - Need vault creation implemented\n\n## Files\n- apps/desktop/settings.integration.test.ts (NEW)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.99816-06:00","updated_at":"2025-12-24T11:16:19.511925-06:00","closed_at":"2025-12-24T11:16:19.511925-06:00","dependencies":[{"issue_id":"scribe-roo.17","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.99919-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.17","depends_on_id":"scribe-roo.7","type":"blocks","created_at":"2025-12-23T15:01:31.588742-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.17","depends_on_id":"scribe-roo.15","type":"blocks","created_at":"2025-12-23T15:01:31.63723-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.17","depends_on_id":"scribe-roo.16","type":"blocks","created_at":"2025-12-23T15:01:31.684028-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.18","title":"Add unit tests for vault IPC handlers","description":"# Add Unit Tests for Vault IPC Handlers\n\n## What\nCreate unit tests for the vault IPC handlers (vault:getPath, vault:setPath, vault:create, vault:validate).\n\n## Why\n- **Isolated Testing**: Test main process logic without full app\n- **Error Scenarios**: Easy to simulate error conditions\n- **Fast Feedback**: Unit tests run much faster than integration tests\n\n## Technical Approach\n\n### Test Structure\n```typescript\n// vaultHandlers.test.ts\nimport { describe, it, expect, vi, beforeEach } from 'vitest';\nimport { registerVaultHandlers } from './vaultHandlers';\nimport * as vaultModule from '@scribe/storage-fs';\n\n// Mock ipcMain\nconst mockIpcMain = {\n  handle: vi.fn(),\n};\n\ndescribe('Vault Handlers', () =\u003e {\n  beforeEach(() =\u003e {\n    vi.clearAllMocks();\n  });\n  \n  describe('vault:getPath', () =\u003e {\n    it('returns current vault path from config');\n    it('returns default path if none configured');\n  });\n  \n  describe('vault:validate', () =\u003e {\n    it('returns valid:true for valid vault');\n    it('returns valid:false with missing dirs for invalid vault');\n    it('handles non-existent path gracefully');\n  });\n  \n  describe('vault:setPath', () =\u003e {\n    it('validates path before saving');\n    it('returns error for invalid vault');\n    it('saves new path to config on success');\n    it('returns requiresRestart: true on success');\n  });\n  \n  describe('vault:create', () =\u003e {\n    it('returns error if vault already exists');\n    it('calls initializeVault for new path');\n    it('saves path to config after creation');\n    it('returns requiresRestart: true on success');\n    it('returns error if creation fails');\n    it('handles permission denied gracefully');\n  });\n});\n```\n\n### Mock Setup\n```typescript\nconst mockConfig = {\n  vaultPath: '/mock/vault',\n};\n\n// Mock storage-fs module\nvi.mock('@scribe/storage-fs', () =\u003e ({\n  isValidVault: vi.fn(),\n  initializeVault: vi.fn(),\n  createVaultPath: vi.fn((p) =\u003e p),\n}));\n\n// Mock config module\nvi.mock('./config', () =\u003e ({\n  loadConfig: vi.fn(() =\u003e mockConfig),\n  saveConfig: vi.fn(),\n}));\n```\n\n### Key Test Cases\n\n#### vault:validate\n```typescript\nit('returns valid:false with missing dirs for invalid vault', async () =\u003e {\n  vi.mocked(vaultModule.isValidVault).mockResolvedValue(false);\n  \n  const handler = getRegisteredHandler('vault:validate');\n  const result = await handler({}, '/some/path');\n  \n  expect(result).toEqual({\n    valid: false,\n    missingDirs: ['notes', 'quarantine'],\n  });\n});\n```\n\n#### vault:setPath (MVP - restart-based)\n```typescript\nit('saves new path to config and returns requiresRestart', async () =\u003e {\n  vi.mocked(vaultModule.isValidVault).mockResolvedValue(true);\n  \n  const handler = getRegisteredHandler('vault:setPath');\n  const result = await handler({}, '/new/path');\n  \n  expect(saveConfig).toHaveBeenCalledWith(\n    expect.objectContaining({ vaultPath: '/new/path' })\n  );\n  expect(result).toEqual({ \n    success: true, \n    path: '/new/path',\n    requiresRestart: true \n  });\n});\n\nit('returns error for invalid vault without saving', async () =\u003e {\n  vi.mocked(vaultModule.isValidVault).mockResolvedValue(false);\n  \n  const handler = getRegisteredHandler('vault:setPath');\n  const result = await handler({}, '/invalid/path');\n  \n  expect(saveConfig).not.toHaveBeenCalled();\n  expect(result).toEqual({\n    success: false,\n    path: '/invalid/path',\n    error: 'Not a valid Scribe vault. Missing required folders.',\n  });\n});\n```\n\n#### vault:create\n```typescript\nit('returns error if vault already exists', async () =\u003e {\n  vi.mocked(vaultModule.isValidVault).mockResolvedValue(true);\n  \n  const handler = getRegisteredHandler('vault:create');\n  const result = await handler({}, '/existing/vault');\n  \n  expect(vaultModule.initializeVault).not.toHaveBeenCalled();\n  expect(result).toEqual({\n    success: false,\n    path: '/existing/vault',\n    error: 'A vault already exists at this location',\n  });\n});\n\nit('creates vault, saves config, and returns requiresRestart', async () =\u003e {\n  vi.mocked(vaultModule.isValidVault).mockResolvedValue(false);\n  vi.mocked(vaultModule.initializeVault).mockResolvedValue(undefined);\n  \n  const handler = getRegisteredHandler('vault:create');\n  const result = await handler({}, '/new/vault');\n  \n  expect(vaultModule.initializeVault).toHaveBeenCalledWith('/new/vault');\n  expect(saveConfig).toHaveBeenCalledWith(\n    expect.objectContaining({ vaultPath: '/new/vault' })\n  );\n  expect(result).toEqual({\n    success: true,\n    path: '/new/vault',\n    requiresRestart: true,\n  });\n});\n\nit('handles permission denied gracefully', async () =\u003e {\n  vi.mocked(vaultModule.isValidVault).mockResolvedValue(false);\n  vi.mocked(vaultModule.initializeVault).mockRejectedValue(\n    new Error('EACCES: permission denied')\n  );\n  \n  const handler = getRegisteredHandler('vault:create');\n  const result = await handler({}, '/protected/path');\n  \n  expect(result).toEqual({\n    success: false,\n    path: '/protected/path',\n    error: expect.stringContaining('permission'),\n  });\n});\n```\n\n### Helper Function\n```typescript\nfunction getRegisteredHandler(channel: string) {\n  const call = mockIpcMain.handle.mock.calls.find(\n    ([c]) =\u003e c === channel\n  );\n  if (!call) throw new Error(\\`Handler for ${channel} not registered\\`);\n  return call[1];\n}\n```\n\n## BLOCKED BY\n- scribe-roo.3 (Vault IPC handlers) - Need handlers to test\n\n## Files\n- apps/desktop/electron/main/src/handlers/vaultHandlers.test.ts (NEW)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:56:11.070483-06:00","updated_at":"2025-12-23T19:23:09.418703-06:00","closed_at":"2025-12-23T19:23:09.418703-06:00","dependencies":[{"issue_id":"scribe-roo.18","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:11.071198-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.18","depends_on_id":"scribe-roo.3","type":"blocks","created_at":"2025-12-23T15:01:31.729838-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.19","title":"Implement engine hot-reload for vault switching (stretch goal)","description":"# Engine Hot-Reload for Vault Switching (Stretch Goal)\n\n## What\nEnable switching vaults at runtime without requiring an app restart. This is a **stretch goal** that builds on the MVP restart-based approach.\n\n## Why\n- **Better UX**: No restart interruption\n- **Power User Feature**: Frequent vault switchers benefit\n- **Technical Achievement**: Shows robust engine architecture\n\n## Prerequisites\n- [deleted:[deleted:scribe-roo].14] (restart-based switching) must be complete first\n- All other Settings page features working\n\n## Technical Approach\n\n### EngineOrchestrator.switchVault()\n```typescript\nasync switchVault(newVaultPath: string): Promise\u003cVaultSwitchResult\u003e {\n  // 1. Validate new vault\n  const isValid = await isValidVault(newVaultPath);\n  if (!isValid) {\n    return { success: false, error: 'Not a valid vault' };\n  }\n  \n  // 2. Cleanup existing engines\n  await this.shutdown();\n  \n  // 3. Create new vault instance\n  this.vault = new FileSystemVault(createVaultPath(newVaultPath));\n  await this.vault.load();\n  \n  // 4. Re-initialize engines\n  this.graphEngine = new GraphEngine();\n  this.searchEngine = new SearchEngine();\n  this.taskIndex = new TaskIndex(...);\n  \n  // 5. Rebuild indexes\n  await this.initialize();\n  \n  return { success: true, path: newVaultPath };\n}\n```\n\n### Renderer Notification\n```typescript\n// Main process after switch\nBrowserWindow.getAllWindows().forEach(win =\u003e {\n  win.webContents.send('vault:switched', { path: newVaultPath });\n});\n\n// Renderer subscription\nuseEffect(() =\u003e {\n  return window.scribe.vault.onSwitched((newPath) =\u003e {\n    // Clear current note\n    // Refresh note list\n    // Reset navigation history\n  });\n}, []);\n```\n\n### Edge Cases\n- Current note doesn't exist in new vault → show welcome state\n- Switch fails mid-operation → attempt rollback\n- Large vault → show loading indicator during reindex\n\n## Risk Assessment\n- **High Complexity**: Engine lifecycle management\n- **Testing Critical**: Need extensive integration tests\n- **Rollback Difficult**: If switch fails partially\n\n## Recommendation\nImplement only after restart-based switching is stable and well-tested. Consider this for v1.1 or later.\n\n## Files\n- apps/desktop/electron/main/src/EngineOrchestrator.ts\n- apps/desktop/electron/main/src/handlers/vaultHandlers.ts\n- packages/shared/src/ipc-contract.ts (vault:switched event)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-23T15:06:57.582811-06:00","updated_at":"2025-12-25T21:54:41.564435-06:00","dependencies":[{"issue_id":"scribe-roo.19","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T15:06:57.583245-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.19","depends_on_id":"scribe-roo.14","type":"blocks","created_at":"2025-12-23T15:07:01.833734-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.2","title":"Add folder picker IPC handler (dialog:selectFolder)","description":"# Add Folder Picker IPC Handler (dialog:selectFolder)\n\n## What\nAdd a new IPC channel that opens the native OS folder picker dialog and returns the selected path.\n\n## Why\n- **Required for Vault Management**: Users need to select folders when changing vault location or creating new vaults\n- **No Existing Handler**: The current IPC contract doesn't include folder/file dialogs\n- **Security**: Renderer process can't access dialog.showOpenDialog directly due to sandboxing\n\n## Technical Approach\n\n### IPC Contract Addition\n```typescript\n// In packages/shared/src/ipc-contract.ts\nexport const IPC_CHANNELS = {\n  // ... existing channels\n  DIALOG_SELECT_FOLDER: 'dialog:selectFolder',\n} as const;\n\n// Add to ScribeAPI interface\nexport interface DialogAPI {\n  selectFolder(options?: { title?: string; defaultPath?: string }): Promise\u003cstring | null\u003e;\n}\n```\n\n### Main Process Handler\n```typescript\n// In apps/desktop/electron/main/src/handlers/dialogHandlers.ts\nimport { dialog } from 'electron';\nimport { IPC_CHANNELS } from '@scribe/shared';\n\nexport function registerDialogHandlers(): void {\n  ipcMain.handle(\n    IPC_CHANNELS.DIALOG_SELECT_FOLDER,\n    async (_, options?: { title?: string; defaultPath?: string }) =\u003e {\n      const result = await dialog.showOpenDialog({\n        title: options?.title ?? 'Select Folder',\n        defaultPath: options?.defaultPath,\n        properties: ['openDirectory', 'createDirectory'],\n      });\n      \n      if (result.canceled || result.filePaths.length === 0) {\n        return null;\n      }\n      \n      return result.filePaths[0];\n    }\n  );\n}\n```\n\n### Preload Bridge\n```typescript\n// Add to window.scribe in preload.ts\ndialog: {\n  selectFolder: (options?: { title?: string; defaultPath?: string }) =\u003e\n    ipcRenderer.invoke(IPC_CHANNELS.DIALOG_SELECT_FOLDER, options),\n}\n```\n\n### Options\n- `title`: Dialog window title (default: \"Select Folder\")\n- `defaultPath`: Initial directory to display (useful for showing current vault path)\n- `properties`: `openDirectory` (folders only), `createDirectory` (allow new folder button)\n\n### Return Value\n- `string`: Absolute path to selected folder\n- `null`: User cancelled the dialog\n\n### Platform Considerations\n- macOS: Native NSOpenPanel\n- Windows: Native folder browser\n- Linux: GTK file chooser (if available)\n\n## Parallel Safe\nYes - no dependencies on other tasks.\n\n## Files\n- packages/shared/src/ipc-contract.ts\n- apps/desktop/electron/main/src/handlers/dialogHandlers.ts (NEW)\n- apps/desktop/electron/preload/src/preload.ts\n- apps/desktop/electron/main/src/main.ts (register handlers)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:56:09.954885-06:00","updated_at":"2025-12-23T19:07:58.807399-06:00","closed_at":"2025-12-23T19:07:58.807399-06:00","dependencies":[{"issue_id":"scribe-roo.2","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:09.955256-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.20","title":"Add SettingsIcon to design system icons","description":"# Add SettingsIcon to Design System\n\n## What\nExport the Settings (gear/cog) icon from Lucide React in the design system icons.\n\n## Why\n- **Required for scribe-roo.4**: The sidebar gear icon needs this icon\n- **Common Pattern**: Settings icon will be used in multiple places\n\n## Implementation\n```typescript\n// In packages/design-system/src/icons/icons.ts (or index.ts)\nexport { Settings as SettingsIcon } from 'lucide-react';\n```\n\nOr if using a custom mapping:\n```typescript\n// Add to the exports\nSettingsIcon,\n```\n\n## Verification\nLucide React has the Settings icon (gear/cog shape). Verify it exists:\nhttps://lucide.dev/icons/settings\n\n## Files\n- packages/design-system/src/icons/index.ts (add export)\n\n## Parallel Safe\nYES - no dependencies.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:08:43.778268-06:00","updated_at":"2025-12-23T19:03:22.758797-06:00","closed_at":"2025-12-23T19:03:22.758797-06:00","dependencies":[{"issue_id":"scribe-roo.20","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T15:08:43.77863-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.21","title":"Add app:relaunch IPC handler for vault switching restart","description":"# Add app:relaunch IPC Handler\n\n## What\nAdd an IPC handler that relaunches the Electron app. Required for vault switching to take effect.\n\n## Why\n- **Vault Switching Requires Restart**: The restart-based vault switching approach (scribe-roo.14) needs a way to restart the app\n- **No Existing Handler**: There's currently no IPC channel for app.relaunch()\n- **Clean Restart**: app.relaunch() + app.exit() provides a clean restart\n\n## Technical Approach\n\n### IPC Contract\n```typescript\n// In packages/shared/src/ipc-contract.ts\nexport const IPC_CHANNELS = {\n  // ... existing\n  APP_RELAUNCH: 'app:relaunch',\n} as const;\n```\n\n### Main Process Handler\n```typescript\n// In appHandlers.ts\nipcMain.handle(IPC_CHANNELS.APP_RELAUNCH, () =\u003e {\n  app.relaunch();\n  app.exit(0);\n});\n```\n\n### Preload Bridge\n```typescript\n// Add to window.scribe.app\napp: {\n  // ... existing\n  relaunch: () =\u003e ipcRenderer.invoke(IPC_CHANNELS.APP_RELAUNCH),\n}\n```\n\n## Files\n- packages/shared/src/ipc-contract.ts\n- apps/desktop/electron/main/src/handlers/appHandlers.ts\n- apps/desktop/electron/preload/src/preload.ts\n\n## Parallel Safe\nYES - No dependencies on other Settings tasks. Can be done alongside scribe-roo.2 and scribe-roo.3.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T15:11:37.305926-06:00","updated_at":"2025-12-23T19:05:19.179193-06:00","closed_at":"2025-12-23T19:05:19.179193-06:00","dependencies":[{"issue_id":"scribe-roo.21","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T15:11:37.306337-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.3","title":"Add vault IPC handlers (vault:getPath, vault:setPath, vault:create)","description":"# Add Vault IPC Handlers (vault:getPath, vault:setPath, vault:create)\n\n## What\nAdd IPC channels for vault management: reading current path, switching vaults, and creating new vaults.\n\n## Why\n- **Settings Page Requirement**: Users need to see their current vault location and optionally change it\n- **Multi-Vault Support Foundation**: Enables users to work with different vaults\n- **New User Onboarding**: Creating a vault is essential for first-time setup\n\n## Technical Approach\n\n### IPC Contract Additions\n```typescript\n// In packages/shared/src/ipc-contract.ts\nexport const IPC_CHANNELS = {\n  // ... existing\n  VAULT_GET_PATH: 'vault:getPath',\n  VAULT_SET_PATH: 'vault:setPath',\n  VAULT_CREATE: 'vault:create',\n  VAULT_VALIDATE: 'vault:validate',\n} as const;\n\nexport interface VaultAPI {\n  getPath(): Promise\u003cstring\u003e;\n  setPath(path: string): Promise\u003cVaultSwitchResult\u003e;\n  create(path: string): Promise\u003cVaultCreateResult\u003e;\n  validate(path: string): Promise\u003cVaultValidationResult\u003e;\n}\n\nexport interface VaultSwitchResult {\n  success: boolean;\n  path: string;\n  error?: string;\n}\n\nexport interface VaultCreateResult {\n  success: boolean;\n  path: string;\n  error?: string;\n}\n\nexport interface VaultValidationResult {\n  valid: boolean;\n  missingDirs?: string[];\n}\n```\n\n### Handler Implementations\n\n#### vault:getPath\nSimply returns the current vault path from EngineOrchestrator or config.\n\n#### vault:validate\nUses existing `isValidVault()` from storage-fs to check if path is valid vault.\n\n#### vault:setPath (Complex - See scribe-roo.14)\nThis is the complex one that requires engine hot-reload. Initial implementation:\n1. Validate the new path is a valid vault\n2. If invalid, return error\n3. If valid, update config and notify renderer\n4. Full engine hot-reload handled in separate task (scribe-roo.14)\n\n#### vault:create\nUses existing `initializeVault()` from storage-fs:\n1. Validate path doesn't already contain a vault\n2. Call `initializeVault(path)` to create structure\n3. Optionally switch to the new vault\n\n### AppConfig Extension\n```typescript\n// In apps/desktop/electron/main/src/handlers/types.ts\nexport interface AppConfig {\n  lastOpenedNoteId?: string;\n  theme?: 'light' | 'dark' | 'system';\n  vaultPath?: string;  // NEW - stores current vault location\n}\n```\n\n### Error Handling\n- Invalid path: Return `{ success: false, error: 'Path does not exist' }`\n- Not a vault: Return `{ success: false, error: 'Not a valid Scribe vault. Missing required folders.' }`\n- Permission denied: Return `{ success: false, error: 'Permission denied' }`\n- Path already exists (for create): Return `{ success: false, error: 'Vault already exists at this location' }`\n\n## Dependencies\n- scribe-roo.14 (Engine hot-reload) - Full vault switching implementation depends on this\n\n## Parallel Safe\nPartially - Basic handlers can be built independently, but full vault switching needs scribe-roo.14.\n\n## Files\n- packages/shared/src/ipc-contract.ts\n- apps/desktop/electron/main/src/handlers/vaultHandlers.ts (NEW)\n- apps/desktop/electron/preload/src/preload.ts\n- apps/desktop/electron/main/src/handlers/types.ts (AppConfig extension)\n- apps/desktop/electron/main/src/main.ts (register handlers)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:56:10.026087-06:00","updated_at":"2025-12-23T19:11:15.68551-06:00","closed_at":"2025-12-23T19:11:15.68551-06:00","dependencies":[{"issue_id":"scribe-roo.3","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.027219-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.4","title":"Replace sidebar footer with settings gear icon","description":"# Replace Sidebar Footer with Settings Gear Icon\n\n## What\nRemove the current sidebar footer (avatar, \"Guest User\", version indicator, theme toggle) and replace it with a minimal settings gear icon button.\n\n## Why\n- **Settings Access Point**: The gear icon is the entry point to the Settings page\n- **Cleaner UI**: Current footer is cluttered; settings belong in a dedicated page\n- **Familiar Pattern**: Gear icon for settings is a universal UI convention\n\n## Current Footer Structure (to be replaced)\n```tsx\n// Current footer in Sidebar.tsx\n\u003cdiv className={footerSection}\u003e\n  \u003cdiv className={footerUser}\u003e\n    \u003cimg src={avatarPlaceholder} className={footerAvatar} /\u003e\n    \u003cspan className={footerUsername}\u003eGuest User\u003c/span\u003e\n  \u003c/div\u003e\n  \u003cdiv className={footerControls}\u003e\n    \u003cspan className={versionIndicator}\u003ev{__APP_VERSION__}\u003c/span\u003e\n    \u003cbutton onClick={onThemeToggle}\u003e\n      {currentTheme === 'dark' ? \u003cSunIcon /\u003e : \u003cMoonIcon /\u003e}\n    \u003c/button\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n## New Footer Structure\n```tsx\n\u003cdiv className={footerSection}\u003e\n  \u003cbutton \n    className={settingsButton}\n    onClick={onOpenSettings}\n    aria-label=\"Open settings\"\n  \u003e\n    \u003cSettingsIcon size={20} /\u003e\n  \u003c/button\u003e\n\u003c/div\u003e\n```\n\n## Technical Changes\n\n### Props Update\n```typescript\n// Remove from SidebarProps\n- onThemeToggle: () =\u003e void;\n- currentTheme: 'light' | 'dark';\n\n// Add to SidebarProps\n+ onOpenSettings: () =\u003e void;\n```\n\n### CSS Updates\n- Keep footerSection styling (positioning at bottom)\n- Remove footerUser, footerAvatar, footerUsername, footerControls styles\n- Add settingsButton style (centered, hover state, icon sizing)\n\n### Icon\nUse existing `SettingsIcon` from design system, or add one if missing. Fallback to a gear SVG:\n```tsx\n// Gear icon (cog) - common settings icon\n\u003csvg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\"\u003e\n  \u003cpath d=\"M12 15a3 3 0 100-6 3 3 0 000 6z\" /\u003e\n  \u003cpath d=\"M19.4 15a1.65 1.65 0 00.33 1.82l...\" /\u003e\n\u003c/svg\u003e\n```\n\n### App.tsx Integration\nThe Sidebar already receives callbacks from App.tsx. Add `onOpenSettings` that calls `setIsSettingsOpen(true)` (state managed by useSettingsPage hook).\n\n## Considerations\n- **Version Display**: Moves to Settings \u003e General section\n- **Theme Toggle**: Moves to Settings \u003e General section\n- **Guest User**: Can be removed entirely (no login system yet)\n- **Tooltip**: Consider adding \"Settings\" tooltip on hover\n\n## Parallel Safe\nYes - no dependencies on other tasks. Can be built before SettingsPage exists (just need the onClick handler stub).\n\n## Files\n- apps/desktop/renderer/src/components/Sidebar/Sidebar.tsx\n- apps/desktop/renderer/src/components/Sidebar/Sidebar.css.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-23T14:56:10.095631-06:00","updated_at":"2025-12-23T19:19:44.787276-06:00","closed_at":"2025-12-23T19:19:44.787276-06:00","dependencies":[{"issue_id":"scribe-roo.4","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.098956-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.4","depends_on_id":"scribe-roo.20","type":"blocks","created_at":"2025-12-23T15:08:48.699715-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.5","title":"Create SettingsPage modal shell with sidebar layout","description":"# Create SettingsPage Modal Shell with Sidebar Layout\n\n## What\nBuild the main SettingsPage component: a full-screen modal with a VS Code/macOS Settings-style sidebar navigation pattern. This task includes:\n- The useSettingsPage hook (previously scribe-roo.6)\n- The ChangelogSettings placeholder section (previously scribe-roo.9)\n\nBoth are trivially small and tightly coupled to this shell.\n\n## Why\n- **Core UI Container**: This is the main shell that houses all settings sections\n- **UX Pattern**: Sidebar + content area is the most scalable pattern for settings\n- **Reuses Overlay**: Leverages existing design system Overlay primitive for modal behavior\n\n## Technical Approach\n\n### useSettingsPage Hook (inline with component)\n```typescript\nexport type SettingsSection = 'general' | 'changelog';\n\nexport function useSettingsPage() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [activeSection, setActiveSection] = useState\u003cSettingsSection\u003e('general');\n  \n  const open = useCallback(() =\u003e {\n    setIsOpen(true);\n    setActiveSection('general');\n  }, []);\n  \n  const close = useCallback(() =\u003e setIsOpen(false), []);\n  \n  return { isOpen, open, close, activeSection, setActiveSection };\n}\n```\n\n### ChangelogSettings (placeholder)\n```tsx\nexport function ChangelogSettings() {\n  return (\n    \u003cdiv className={styles.changelogSettings}\u003e\n      \u003cText variant=\"heading3\"\u003eChangelog\u003c/Text\u003e\n      \u003cText variant=\"body\" color=\"muted\"\u003e\n        Release notes and version history will appear here in a future update.\n      \u003c/Text\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Component Structure\n```tsx\nexport function SettingsPage({ isOpen, onClose }: SettingsPageProps) {\n  const [activeSection, setActiveSection] = useState\u003cSettingsSection\u003e('general');\n  \n  if (!isOpen) return null;\n  \n  return (\n    \u003cOverlay open={isOpen} onClose={onClose} closeOnEscape\u003e\n      \u003cSurface className={styles.settingsContainer}\u003e\n        \u003cheader className={styles.header}\u003e\n          \u003cText variant=\"heading2\"\u003eSettings\u003c/Text\u003e\n          \u003cbutton onClick={onClose} aria-label=\"Close settings\"\u003e\u003cXIcon /\u003e\u003c/button\u003e\n        \u003c/header\u003e\n        \u003cdiv className={styles.content}\u003e\n          \u003cSettingsSidebar activeSection={activeSection} onSelect={setActiveSection} /\u003e\n          \u003cmain className={styles.mainContent}\u003e\n            {activeSection === 'general' \u0026\u0026 \u003cGeneralSettings /\u003e}\n            {activeSection === 'changelog' \u0026\u0026 \u003cChangelogSettings /\u003e}\n          \u003c/main\u003e\n        \u003c/div\u003e\n      \u003c/Surface\u003e\n    \u003c/Overlay\u003e\n  );\n}\n```\n\n### Layout (sidebar + content, VS Code pattern)\n- Full viewport (100vw x 100vh)\n- Sidebar: ~200px fixed width\n- Content: Flex grow, scrollable\n- Header: Fixed top with title + close button\n\n### Files to Create\n- SettingsPage.tsx (component + hook)\n- SettingsPage.css.ts\n- SettingsSidebar.tsx + css\n- ChangelogSettings.tsx (simple placeholder)\n- index.ts (barrel export)\n\n## Parallel Safe\nYES - No dependencies. Can be built independently of the gear icon.\n\n## Files\n- apps/desktop/renderer/src/components/Settings/SettingsPage.tsx (NEW)\n- apps/desktop/renderer/src/components/Settings/SettingsPage.css.ts (NEW)\n- apps/desktop/renderer/src/components/Settings/SettingsSidebar.tsx (NEW)\n- apps/desktop/renderer/src/components/Settings/ChangelogSettings.tsx (NEW)\n- apps/desktop/renderer/src/hooks/useSettingsPage.ts (NEW)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.16838-06:00","updated_at":"2025-12-23T19:26:50.59555-06:00","closed_at":"2025-12-23T19:26:50.59555-06:00","dependencies":[{"issue_id":"scribe-roo.5","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.169409-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.6","title":"Create useSettingsPage hook for state management","description":"# Create useSettingsPage Hook for State Management\n\n## What\nCreate a custom hook to manage Settings page state: open/close, active section, and any transient settings state.\n\n## Why\n- **Centralized State**: Keep settings-related state in one place\n- **Reusability**: Can be used from App.tsx and passed down\n- **Separation of Concerns**: UI logic separate from component rendering\n- **Future Expansion**: Easy to add more state (unsaved changes warning, etc.)\n\n## Technical Approach\n\n### Hook API\n```typescript\n// useSettingsPage.ts\nexport type SettingsSection = 'general' | 'changelog';\n\nexport interface UseSettingsPageReturn {\n  // Modal state\n  isOpen: boolean;\n  open: () =\u003e void;\n  close: () =\u003e void;\n  toggle: () =\u003e void;\n  \n  // Section navigation\n  activeSection: SettingsSection;\n  setActiveSection: (section: SettingsSection) =\u003e void;\n}\n\nexport function useSettingsPage(): UseSettingsPageReturn {\n  const [isOpen, setIsOpen] = useState(false);\n  const [activeSection, setActiveSection] = useState\u003cSettingsSection\u003e('general');\n  \n  const open = useCallback(() =\u003e {\n    setIsOpen(true);\n    setActiveSection('general'); // Reset to default on open\n  }, []);\n  \n  const close = useCallback(() =\u003e {\n    setIsOpen(false);\n  }, []);\n  \n  const toggle = useCallback(() =\u003e {\n    setIsOpen(prev =\u003e !prev);\n  }, []);\n  \n  return {\n    isOpen,\n    open,\n    close,\n    toggle,\n    activeSection,\n    setActiveSection,\n  };\n}\n```\n\n### Usage in App.tsx\n```tsx\nfunction App() {\n  const settings = useSettingsPage();\n  \n  return (\n    \u003cdiv className={styles.app}\u003e\n      \u003cSidebar \n        onOpenSettings={settings.open}\n        // ... other props\n      /\u003e\n      \n      \u003cSettingsPage \n        isOpen={settings.isOpen}\n        onClose={settings.close}\n        activeSection={settings.activeSection}\n        onSelectSection={settings.setActiveSection}\n      /\u003e\n      \n      {/* ... rest of app */}\n    \u003c/div\u003e\n  );\n}\n```\n\n### Future Extensions\nThis hook can be extended to support:\n- **Dirty state tracking**: Warn before closing with unsaved changes\n- **Keyboard shortcuts**: Cmd+, to open settings\n- **Deep linking**: Open to specific section (e.g., from toast \"Update Settings\")\n- **History**: Remember last visited section\n\n### Potential Addition: Keyboard Shortcut\n```typescript\n// Inside the hook\nuseEffect(() =\u003e {\n  const handleKeyDown = (e: KeyboardEvent) =\u003e {\n    // Cmd+, (macOS) or Ctrl+, (Windows/Linux) opens settings\n    if ((e.metaKey || e.ctrlKey) \u0026\u0026 e.key === ',') {\n      e.preventDefault();\n      toggle();\n    }\n  };\n  \n  window.addEventListener('keydown', handleKeyDown);\n  return () =\u003e window.removeEventListener('keydown', handleKeyDown);\n}, [toggle]);\n```\n\n## Parallel Safe\nYes - no dependencies. Can be built independently.\n\n## Files\n- apps/desktop/renderer/src/hooks/useSettingsPage.ts (NEW)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.237266-06:00","updated_at":"2025-12-23T15:05:58.864121-06:00","closed_at":"2025-12-23T15:05:58.864121-06:00","dependencies":[{"issue_id":"scribe-roo.6","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.237929-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.7","title":"Integrate SettingsPage into App.tsx","description":"# Integrate SettingsPage into App.tsx\n\n## What\nWire up the SettingsPage component and useSettingsPage hook into the main App.tsx, connecting it to the sidebar gear icon.\n\n## Why\n- **Entry Point Connection**: Links the gear icon click to opening settings\n- **State Hosting**: App.tsx is the appropriate level to host settings state\n- **Coordinated Rendering**: Settings modal needs to render at the app level to overlay everything\n\n## Technical Approach\n\n### App.tsx Changes\n```tsx\n// App.tsx\nimport { SettingsPage } from './components/Settings';\nimport { useSettingsPage } from './hooks/useSettingsPage';\n\nfunction App() {\n  // ... existing hooks\n  const settings = useSettingsPage();\n  \n  return (\n    \u003cdiv className={styles.app}\u003e\n      \u003cdiv className={styles.titlebarDragRegion} /\u003e\n      \n      \u003cErrorBoundary name=\"Sidebar\"\u003e\n        \u003cSidebar \n          // ... existing props\n          onOpenSettings={settings.open}  // NEW: replace onThemeToggle\n          // REMOVE: onThemeToggle, currentTheme\n        /\u003e\n      \u003c/ErrorBoundary\u003e\n      \n      {/* Main content area */}\n      \u003cEditorCommandProvider\u003e\n        \u003cdiv className={styles.mainContent}\u003e\n          {/* ... existing content */}\n        \u003c/div\u003e\n      \u003c/EditorCommandProvider\u003e\n      \n      {/* Settings modal - renders at app level to overlay everything */}\n      \u003cSettingsPage \n        isOpen={settings.isOpen}\n        onClose={settings.close}\n      /\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Remove Theme Toggle Props\nSince theme toggle moves to Settings, remove from Sidebar props:\n```typescript\n// Before\n\u003cSidebar\n  onThemeToggle={() =\u003e setTheme(resolvedTheme === 'dark' ? 'light' : 'dark')}\n  currentTheme={resolvedTheme}\n  // ...\n/\u003e\n\n// After\n\u003cSidebar\n  onOpenSettings={settings.open}\n  // ...\n/\u003e\n```\n\n### Rendering Order\nSettingsPage should render AFTER the main content but is a portal-based overlay, so order in JSX doesn't strictly matter. However, for clarity:\n```tsx\n{/* Main app UI */}\n\u003cSidebar ... /\u003e\n\u003cmain ... /\u003e\n\n{/* Overlays (render last for z-index clarity) */}\n\u003cCommandPalette ... /\u003e\n\u003cSettingsPage ... /\u003e\n\u003cToast ... /\u003e\n```\n\n### ErrorBoundary\nConsider wrapping SettingsPage in ErrorBoundary:\n```tsx\n\u003cErrorBoundary name=\"Settings\"\u003e\n  \u003cSettingsPage ... /\u003e\n\u003c/ErrorBoundary\u003e\n```\n\n## BLOCKED BY\n- scribe-roo.4 (Sidebar gear icon) - Need onOpenSettings prop\n- scribe-roo.5 (SettingsPage shell) - Need component to render\n- scribe-roo.6 (useSettingsPage hook) - Need state management\n\n## Files\n- apps/desktop/renderer/src/App.tsx","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.306119-06:00","updated_at":"2025-12-23T19:27:04.422179-06:00","closed_at":"2025-12-23T19:27:04.422179-06:00","dependencies":[{"issue_id":"scribe-roo.7","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.307382-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.7","depends_on_id":"scribe-roo.5","type":"blocks","created_at":"2025-12-23T15:00:59.586308-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.8","title":"Implement GeneralSettings section structure","description":"# Implement GeneralSettings Section Structure\n\n## What\nBuild the GeneralSettings component that contains Vault Location, Version, and Theme settings.\n\n## Why\n- **Main Settings Section**: General is the default and most important section\n- **Organizes Related Settings**: Groups vault, version, and theme logically\n- **Foundation for Functionality**: This structure enables the actual setting implementations\n\n## Technical Approach\n\n### Component Structure\n```tsx\n// GeneralSettings.tsx\nexport function GeneralSettings() {\n  return (\n    \u003cdiv className={styles.generalSettings}\u003e\n      \u003cSettingsGroup title=\"Vault Location\"\u003e\n        \u003cVaultLocationSetting /\u003e\n      \u003c/SettingsGroup\u003e\n      \n      \u003cSettingsGroup title=\"Version\"\u003e\n        \u003cVersionSetting /\u003e\n      \u003c/SettingsGroup\u003e\n      \n      \u003cSettingsGroup title=\"Theme\"\u003e\n        \u003cThemeSetting /\u003e\n      \u003c/SettingsGroup\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### SettingsGroup Helper\n```tsx\n// SettingsGroup - reusable container for each setting\ninterface SettingsGroupProps {\n  title: string;\n  description?: string;\n  children: ReactNode;\n}\n\nfunction SettingsGroup({ title, description, children }: SettingsGroupProps) {\n  return (\n    \u003csection className={styles.settingsGroup}\u003e\n      \u003cdiv className={styles.settingsGroupHeader}\u003e\n        \u003cText variant=\"label\" className={styles.settingsGroupTitle}\u003e{title}\u003c/Text\u003e\n        {description \u0026\u0026 (\n          \u003cText variant=\"body\" color=\"muted\"\u003e{description}\u003c/Text\u003e\n        )}\n      \u003c/div\u003e\n      \u003cdiv className={styles.settingsGroupContent}\u003e\n        {children}\n      \u003c/div\u003e\n    \u003c/section\u003e\n  );\n}\n```\n\n### Layout Pattern\n```\nVault Location\n------------------------------------------------\n/Users/erik/Scribe/vault\n[Change]  [Create New]\n\nVersion\n------------------------------------------------\nv1.2.3\n[Check for Updates]\n\nTheme\n------------------------------------------------\n[Dark | Light | System]\n```\n\n### Styling\n```typescript\n// GeneralSettings.css.ts\nexport const generalSettings = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[8],  // Large gap between groups\n});\n\nexport const settingsGroup = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[3],\n});\n\nexport const settingsGroupHeader = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[1],\n  borderBottom: `1px solid ${vars.color.border}`,\n  paddingBottom: vars.spacing[2],\n});\n\nexport const settingsGroupContent = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[2],\n});\n```\n\n### Placeholder Content (Initial)\nInitially, each setting can be a placeholder:\n```tsx\nfunction VaultLocationSetting() {\n  return (\n    \u003cdiv\u003e\n      \u003cText variant=\"body\" color=\"muted\"\u003eLoading vault path...\u003c/Text\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## BLOCKED BY\n- scribe-roo.5 (SettingsPage shell) - Needs to render inside SettingsPage\n\n## UNBLOCKS\n- scribe-roo.10 (Theme setting)\n- scribe-roo.11 (Version/Update setting)\n- scribe-roo.13 (Vault display)\n\n## Files\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.tsx (NEW)\n- apps/desktop/renderer/src/components/Settings/GeneralSettings.css.ts (NEW)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-23T14:56:10.374812-06:00","updated_at":"2025-12-23T19:32:55.880182-06:00","closed_at":"2025-12-23T19:32:55.880182-06:00","dependencies":[{"issue_id":"scribe-roo.8","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.376172-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.8","depends_on_id":"scribe-roo.5","type":"blocks","created_at":"2025-12-23T15:00:59.679146-06:00","created_by":"daemon","metadata":"{}"}]}
{"id":"scribe-roo.9","title":"Create ChangelogSettings placeholder section","description":"# Create ChangelogSettings Placeholder Section\n\n## What\nCreate a placeholder Changelog section that displays \"Coming soon\" or similar placeholder content.\n\n## Why\n- **Spec Requirement**: The spec explicitly includes Changelog as a section (placeholder for now)\n- **UI Completeness**: Users can see the section exists even if not functional\n- **Future Foundation**: Easy to implement actual changelog later\n\n## Technical Approach\n\n### Simple Placeholder\n```tsx\n// ChangelogSettings.tsx\nimport { Text } from '@scribe/design-system';\nimport * as styles from './ChangelogSettings.css';\n\nexport function ChangelogSettings() {\n  return (\n    \u003cdiv className={styles.changelogSettings}\u003e\n      \u003cText variant=\"heading3\"\u003eChangelog\u003c/Text\u003e\n      \u003cText variant=\"body\" color=\"muted\"\u003e\n        Release notes and version history will appear here in a future update.\n      \u003c/Text\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Alternative: Fetch from CHANGELOG.md\nFor a more useful placeholder, could display the CHANGELOG.md content:\n```tsx\nexport function ChangelogSettings() {\n  // Could fetch CHANGELOG.md content and render as markdown\n  // For now, just placeholder\n  return (\n    \u003cdiv className={styles.changelogSettings}\u003e\n      \u003cText variant=\"heading3\"\u003eWhat's New\u003c/Text\u003e\n      \u003cdiv className={styles.placeholder}\u003e\n        \u003cText variant=\"body\" color=\"muted\"\u003e\n          Changelog coming soon. For now, see release notes on GitHub.\n        \u003c/Text\u003e\n        \u003cButton \n          variant=\"secondary\" \n          onClick={() =\u003e window.scribe.shell.openExternal('https://github.com/scribe/releases')}\n        \u003e\n          View on GitHub\n        \u003c/Button\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n### Styling\n```typescript\n// ChangelogSettings.css.ts\nexport const changelogSettings = style({\n  display: 'flex',\n  flexDirection: 'column',\n  gap: vars.spacing[4],\n});\n\nexport const placeholder = style({\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'flex-start',\n  gap: vars.spacing[3],\n  padding: vars.spacing[6],\n  backgroundColor: vars.color.backgroundAlt,\n  borderRadius: vars.radius.md,\n});\n```\n\n## Low Priority\nThis is P3 as it's just a placeholder. Can be implemented quickly after the main settings structure is in place.\n\n## BLOCKED BY\n- scribe-roo.5 (SettingsPage shell) - Needs to render inside SettingsPage\n\n## Files\n- apps/desktop/renderer/src/components/Settings/ChangelogSettings.tsx (NEW)\n- apps/desktop/renderer/src/components/Settings/ChangelogSettings.css.ts (NEW, optional)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T14:56:10.443953-06:00","updated_at":"2025-12-23T15:12:08.006803-06:00","closed_at":"2025-12-23T15:12:08.006803-06:00","dependencies":[{"issue_id":"scribe-roo.9","depends_on_id":"scribe-roo","type":"parent-child","created_at":"2025-12-23T14:56:10.444505-06:00","created_by":"daemon","metadata":"{}"},{"issue_id":"scribe-roo.9","depends_on_id":"scribe-roo.5","type":"blocks","created_at":"2025-12-23T15:00:59.723951-06:00","created_by":"daemon","metadata":"{}"}]}
